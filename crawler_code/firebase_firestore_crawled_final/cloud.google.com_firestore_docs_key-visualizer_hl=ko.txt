Source URL: https://cloud.google.com/firestore/docs/key-visualizer?hl=ko
Title: Key Visualizer 개요

이 페이지는 Cloud Translation API [https://cloud.google.com/translate/?hl=ko]를 통해 번역되었습니다.

의견 보내기

컬렉션을 사용해 정리하기

내 환경설정을 기준으로 콘텐츠를 저장하고 분류하세요.

Key Visualizer 개요

이 페이지에서는 Firestore의 Key Visualizer 진단 도구에 대해 간략하게 설명합니다.

Key Visualizer란 무엇인가?

Key Visualizer는 Firestore 사용 패턴을 분석하는 데 도움이 되는 도구입니다. 액세스하는 문서 또는 문서가 수정될 때 기록되거나 삭제되는 항목에 따라 사용량을 세분화하는 시각적 보고서를 생성합니다.

Key Visualizer는 대규모 사용 패턴에 대한 통계를 제공합니다.
Key Visualizer 용도는 다음과 같습니다.

성능 문제를 해결합니다. Key Visualizer는 연속 문서나 색인 키의 핫스팟 또는 갑작스러운 트래픽 증가로 인해 발생하는 데이터베이스 성능 문제를 식별하는 데 도움이 됩니다.
사용자가 Firestore에 저장된 데이터에 어떻게 액세스하는지 자세히 파악할 수 있습니다.
데이터 모델을 반복적으로 설계하거나 기존 데이터 모델의 설계를 개선합니다. 각 반복에서 Key Visualizer를 확인하여 데이터 모델의 문제를 찾을 수 있습니다.

위 목표를 달성하기 위해 Key Visualizer를 통해 다음 태스크를 수행할 수 있습니다.

읽기 또는 쓰기가 특정 문서 범위에 핫스팟을 만드는지 확인합니다.
트래픽 급증이 지연 시간에 어떤 영향을 미치는지 확인합니다.
데이터베이스 전반에서 액세스 패턴이 균형을 이루고 있는지 확인합니다.
색인 키 구조를 확인하여 색인 로드 문제의 원인이 되는 색인 정의를 식별합니다.
색인 키 시각화를 사용하여 워크로드 패턴 예측을 개선합니다.

주요 용어: 문서 키

Key Visualizer에서 문서 키 용어는 문서의 고유 식별자를 나타냅니다. 특정 문서의 전체 경로(문서 이름이라고도 함)와 동일합니다. 예를 들어 다음 문서 이름도 문서 키입니다.

projects/PROJECT_ID/databases/(default)/documents/cities/SF
projects/PROJECT_ID/databases/(default)/documents/companies/my_company/employees/007RGlCzsx59bakkuTGz

주요 용어: 색인 키

Key Visualizer에서 색인 키 용어는 색인의 고유 식별자를 나타냅니다. 단일 필드 색인이나 복합 색인일 수 있습니다. 예를 들어 다음 색인은 Key Visualizer 도구에서 볼 수 있는 색인 키의 몇 가지 예시입니다.

COLLECTION:
projects/PROJECT_ID/databases/default/documents/Users
PROPERTIES: (timestamp: ASC) VALUES: (1686162996397845) DOCUMENT:
projects/PROJECT_ID/databases/default/documents/Users/QstCrsaGuq9ybj81dNse
COLLECTION:
projects/PROJECT_ID/databases/default/documents/Users
PROPERTIES: (Timestamp: ASC, Name: ASC,Country: ARRAY) VALUES:
(16500000000000001L, 'Alice', 'USA') DOCUMENT:
(projects/PROJECT_ID/databases/default/documents/Users/5000000000000001)

검사 요건

각 Key Visualizer 검사는 2시간의 활동을 다룹니다. 특정 기간의 검사는 해당 기간 중 1분 동안 3,000개 문서 작업을 초과하는 트래픽을 가진 데이터베이스에 사용할 수 있습니다.

스캔 요건은 데이터베이스 활동에 따라 다릅니다. 이는 데이터베이스의 데이터 양 또는 데이터 유형에 따라 달라지지 않습니다.

Key Visualizer 검사

다음 이미지는 Key Visualizer 검사를 보여줍니다. 각 스캔에는 시간 경과에 따른 문서 키나 색인 키의 그룹에 대한 액세스 패턴 또는 성능 측정항목을 보여주는 히트맵이 포함됩니다.

검사 URL 공유

Key Visualizer 검사의 URL을 공유하거나 북마크할 수 있습니다. URL에서 동일한 Key Visualizer 검사를 열고 동일한 측정항목을 선택합니다. 이 URL은 검사 데이터 기간 [https://cloud.google.com/firestore/native/docs/key-visualizer?hl=ko#data-duration]이 만료될 때까지 유효합니다.

히트맵

Key Visualizer 검사의 핵심은 히트맵입니다. 히트맵에는 시간 경과에 따른 측정항목 값이 연속된 키 버킷 [https://cloud.google.com/firestore/native/docs/key-visualizer?hl=ko#key-buckets] 최대 1,000개까지 세분화되어 표시됩니다.

문서 키 히트맵의 경우 히트맵의 x축은 시간을, y축은 문서 키를 나타냅니다. 반면 색인 키 히트맵의 경우 히트맵의 x축은 시간을, y축은 색인 키를 나타냅니다.

Firestore의 각 Key Visualizer 검사는 2시간 활동을 10초 세그먼트로 나눕니다.

측정항목 값이 낮으면 '콜드'로 간주되며 어두운 색으로 표시됩니다.
높은 값은 '핫' 상태이며 밝은 색으로 표시됩니다. 가장 높은 값은 흰색으로 표시됩니다.

사용 유형이 달라지면 히트맵의 시각적 패턴이 달라지므로 한눈에 문제를 진단할 수 있습니다. 공통 패턴의 예시는 문서 키의 히트맵 패턴 [https://cloud.google.com/firestore/native/docs/keyvis-patterns?hl=ko] 또는 색인 키의 히트맵 패턴 [https://cloud.google.com/firestore/native/docs/keyvis-patterns-index?hl=ko]을 참조하세요.

Key Visualizer에서는 각 검사의 데이터를 이해하는 데 도움이 되는 도구를 제공합니다.
Key Visualizer 시작하기 [https://cloud.google.com/firestore/native/docs/keyvis-getting-started?hl=ko] 및 히트맵 탐색 [https://cloud.google.com/firestore/native/docs/keyvis-exploring-heatmaps?hl=ko]을 참조하세요.

키 버킷

Key Visualizer는 데이터베이스의 모든 키를 연속 범위 1,000개로 나누므로 각 범위의 키 및 초당 작업 수가 거의 동일합니다. 이러한 범위를 키 버킷이라고 합니다.

Key Visualizer는 데이터베이스의 총 초당 작업 수를 사용하여 키 버킷을 나누므로 각 버킷은 키 버킷당 의도된 최소 크기인 초당 작업 50개로 거의 동일한 초당 작업 수를 캡처합니다. 총 초당 작업 수가 더 높은 데이터베이스의 경우 키 버킷은 각각 초당 작업 수를 50개 넘게 캡처할 수 있습니다.
초당 작업 수가 50개 미만인 데이터베이스는 단일 키 버킷으로 스캔됩니다.

Key Visualizer는 대부분의 측정항목을 각 키 버킷의 평균 또는 각 키 버킷 내 최댓값으로 보고합니다.

측정항목

Key Visualizer 스캔의 문서 키에 다음 측정항목을 사용할 수 있습니다.

| 측정항목 | 설명 |
| --- | --- |
| 활동 측정항목 |  |
| 작업/초 | 초당 평균 문서 작업 수입니다. 쓰기, 조회, 초당 쿼리 수의 합계와 거의 같습니다. 이 측정항목은 키가 핫 키임을 나타냅니다. |
| 쓰기 작업/초 | 쓰기 및 삭제에 대한 초당 평균 문서 작업 수입니다. |
| 조회 작업/초 | 조회에 대한 초당 평균 문서 작업 수입니다. |
| 쿼리 작업/초 | 쿼리에 대한 초당 평균 문서 작업 수입니다. |
| 성능 통계 |  |
| 평균 쓰기 지연 시간 | 버킷에서 처리된 데이터 내의 쓰기 및 삭제 평균 지연 시간입니다. |
| 평균 조회 지연 시간 | 버킷에서 처리된 데이터 내의 조회 평균 지연 시간입니다. |
| 평균 쿼리 지연 시간 | 버킷에서 처리된 데이터 내의 쿼리 평균 지연 시간입니다. |
| 쓰기 꼬리 지연 시간 | 버킷에서 처리된 데이터 내의 관찰된 최대 쓰기 또는 삭제 지연 시간입니다. |
| 조회 꼬리 지연 시간 | 버킷에서 처리된 데이터 내의 관찰된 최대 조회 지연 시간입니다. |
| 쿼리 꼬리 지연 시간 | 버킷에서 처리된 데이터 내의 관찰된 최대 쿼리 지연 시간입니다. |

Key Visualizer 스캔에서 색인 키에 다음 측정항목을 사용할 수 있습니다.

| 측정항목 | 설명 |
| --- | --- |
| 색인 쓰기 작업/초 | 초당 평균 색인 쓰기 수입니다. |

성능 평균

평균 지연 시간 측정항목에서는 키 버킷의 키 평균을 사용합니다.
이 측정은 스토리지 레이어에서 수행되므로 여기에 보고된 지연 시간은 API 호출에서 발생하는 총 지연 시간보다 짧을 수 있습니다.

한도

Key Visualizer는 다양한 측정항목을 표시하지만 Firestore의 성능에 영향을 줄 수 있는 모든 측정항목을 표시하지는 않습니다. 예를 들면 다음과 같습니다.

애플리케이션과 Google Cloud 간의 네트워크 문제가 표시되지 않을 수 있습니다. 이 키는 Key Visualizer의 모든 키에서 수직 밴드로 표시되어 문제가 발생한 시점에 대한 힌트만 제공합니다.

데이터 기간

Firestore용 Key Visualizer에서 수집한 데이터는 14일 후에 삭제됩니다.

Key Visualizer에서는 지난 14일간의 데이터를 이용할 수 있습니다. 예를 들어 12월 19일 오후 12시 45분에 Key Visualizer를 실행한 경우 2시간 범위에 선택할 수 있는 가장 빠른 시작 시간은 12월 5일 오후 1시입니다.

또한 이 한도는 Key Visualizer 검사의 URL을 북마크하거나 공유할 경우 URL의 최대 수명이 14일이라는 의미입니다.

다음 단계

Key Visualizer를 시작 [https://cloud.google.com/firestore/native/docs/keyvis-getting-started?hl=ko]하는 방법 알아보기
Key Visualizer 히트맵에 표시될 수 있는 문서 키 패턴 [https://cloud.google.com/firestore/native/docs/keyvis-patterns?hl=ko] 또는 색인 키 패턴 [https://cloud.google.com/firestore/native/docs/keyvis-patterns-index?hl=ko] 이해
히트맵을 세부적으로 탐색 [https://cloud.google.com/firestore/native/docs/keyvis-exploring-heatmaps?hl=ko]하는 방법 알아보기

의견 보내기