Source URL: https://firebase.google.com/docs/firestore/enterprise/query-insights?hl=ko
Title: 쿼리 성능 통계 분석

이제 MongoDB 호환성을 갖춘 Cloud Firestore Enterprise 버전을 사용할 수 있습니다. 자세히 알아보기 [https://firebase.google.com/docs/firestore/enterprise/mongodb-compatibility-overview?hl=ko]

의견 보내기

쿼리 성능 통계 분석

컬렉션을 사용해 정리하기

내 환경설정을 기준으로 콘텐츠를 저장하고 분류하세요.

| Cloud Firestore Enterprise 버전에만 해당합니다. |
| --- |

이 페이지에서는 쿼리 통계 대시보드를 사용하여 쿼리 성능을 감지하고 분석하는 방법을 설명합니다.

쿼리 통계 개요

쿼리 통계 대시보드를 사용하여 측정항목 관련 쿼리를 모니터링합니다.
측정항목을 기반으로 가장 자주 사용되는 쿼리와 최적화가 필요할 수 있는 지연 시간이 긴 쿼리를 식별할 수 있습니다. 쿼리 통계 대시보드를 사용하여 다음 작업을 수행할 수 있습니다.

쿼리 성능 최적화: 지연 시간이 길고 최적화가 필요할 수 있는 쿼리를 식별합니다.
쿼리 비용 관리: 비용이 많이 드는 쿼리를 찾아 비용을 줄이도록 최적화합니다.
쿼리 통계 모니터링: 시간 경과에 따른 쿼리 통계를 추적합니다.

쿼리 통계 데이터

쿼리 통계에는 다음 API 메서드의 데이터가 포함됩니다.

find
aggregate

특정 프로젝트, 데이터베이스, 10분~30일의 기간에 대해 이러한 메서드를 사용하는 쿼리에 관한 데이터를 볼 수 있습니다. 구조가 동일한 쿼리의 데이터는 하나의 정규화된 쿼리 아래에 캡처됩니다.

쿼리 통계는 쿼리에 관한 다음 정보를 반환합니다.

| 정규화된 쿼리 텍스트 | 텍스트로 표현된 쿼리 구조입니다. |
| --- | --- |
| 실행 횟수 | 선택한 기간의 실행 횟수입니다. |
| 오류 수 | 선택한 기간의 오류 수입니다. |
| 평균 실행 시간(밀리초) | 데이터베이스가 쿼리를 처리하는 데 걸린 평균 시간(밀리초)입니다. |
| 반환된 평균 결과 수 | 쿼리에서 반환된 결과 수입니다. 결과에는 문서, 컬렉션 ID, 집계된 버킷이 포함됩니다. |
| 스캔된 평균 문서 수 | 쿼리에서 스캔된 문서 수입니다. |
| 스캔된 색인 항목의 평균 수 | 쿼리를 실행하기 위해 검사한 색인 항목 수입니다. |
| 평균 시간별 부하 | 평균 지연 시간을 기준으로 상위 쿼리를 필터링하는 데 도움이 되는 데이터입니다. |
| 총 (청구 가능) 읽기 작업 수별 부하 | 총 청구 가능한 읽기 작업을 기준으로 상위 쿼리를 필터링하는 데 도움이 되는 데이터입니다. |

데이터 세부사항 및 보관

데이터 세부사항은 지정된 기간에 따라 다릅니다.

최대 4일 전 간격의 경우 10분 단위
최대 30일 전 간격의 경우 1시간 단위

쿼리 통계의 최대 데이터 보관은 30일입니다.
10분 데이터는 4일 동안 저장되고 시간별 데이터는 30일 동안 저장됩니다.

제한사항

쿼리 통계 데이터는 1~2시간 지연됩니다.

가격 책정

쿼리 통계는 추가 비용 없이 사용할 수 있습니다.

필요한 역할

쿼리 통계 대시보드를 보는 데 필요한 권한을 얻으려면 관리자에게 프로젝트에 대한 Datastore 뷰어 [https://cloud.google.com/iam/docs/roles-permissions/firestore?hl=ko#datastore.viewer](roles/datastore.viewer) IAM 역할을 부여해 달라고 요청하세요.

이 사전 정의된 역할에는 쿼리 통계 대시보드를 보는 데 필요한 datastore.insights.get 권한이 포함되어 있습니다.

커스텀 역할 [https://cloud.google.com/iam/docs/creating-custom-roles?hl=ko]이나 다른 사전 정의된 역할 [https://cloud.google.com/iam/docs/roles-overview?hl=ko#predefined]을 사용하여 이 권한을 부여받을 수도 있습니다.쿼리 통계 보기

MongoDB 호환성을 갖춘 Cloud Firestore 데이터베이스의 쿼리 통계를 보려면 Google Cloud 콘솔에서 데이터베이스 쿼리 통계 창을 엽니다.

Google Cloud 콘솔에서 데이터베이스 페이지로 이동합니다.

데이터베이스로 이동 [https://console.cloud.google.com/firestore/databases?hl=ko]
데이터베이스 목록에서 데이터베이스를 선택합니다.
탐색 메뉴에서 쿼리 통계를 클릭합니다.

로드 유형 드롭다운을 사용하여 지연 시간 또는 읽기 작업 수별로 상위 쿼리를 찾습니다.

다음 단계

사용량 모니터링 [https://firebase.google.com/docs/firestore/enterprise/use-monitoring-dashboard?hl=ko]
Cloud Audit Logs 사용 [https://firebase.google.com/docs/firestore/enterprise/audit-logging?hl=ko]

의견 보내기