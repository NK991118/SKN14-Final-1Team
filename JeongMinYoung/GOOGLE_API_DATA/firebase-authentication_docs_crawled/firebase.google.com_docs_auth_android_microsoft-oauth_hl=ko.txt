Source URL: https://firebase.google.com/docs/auth/android/microsoft-oauth?hl=ko
Title: Android에서 Microsoft를 통해 인증
bookmark_border

의견 보내기

Android에서 Microsoft를 통해 인증

bookmark_borderbookmark

컬렉션을 사용해 정리하기

내 환경설정을 기준으로 콘텐츠를 저장하고 분류하세요.

이 페이지의 내용시작하기 전에 [https://firebase.google.com/docs/auth/android/microsoft-oauth?hl=ko#before_you_begin]Firebase SDK로 로그인 과정 처리 [https://firebase.google.com/docs/auth/android/microsoft-oauth?hl=ko#handle_the_sign-in_flow_with_the_firebase_sdk]고급: 수동으로 로그인 과정 처리 [https://firebase.google.com/docs/auth/android/microsoft-oauth?hl=ko#advanced:-handle-the-sign-in-flow-manually]다음 단계 [https://firebase.google.com/docs/auth/android/microsoft-oauth?hl=ko#next_steps]

Firebase SDK를 통해 엔드 투 엔드 로그인 과정을 실행하는 앱에 웹 기반의 일반 OAuth 로그인을 통합하여 사용자가 Microsoft Azure Active Directory와 같은 OAuth 제공업체를 통해 Firebase에 인증하도록 할 수 있습니다.

시작하기 전에

사용자가 Microsoft 계정(Azure Active Directory 및 개인 Microsoft 계정)을 통해 로그인하도록 하려면 우선 Firebase 프로젝트에서 Microsoft를 로그인 제공업체로 사용 설정해야 합니다.

Android 프로젝트에 Firebase를 추가합니다 [https://firebase.google.com/docs/android/setup?hl=ko].
Firebase Console [https://console.firebase.google.com/?hl=ko]에서 인증 섹션을 엽니다.
로그인 방법 탭에서 Microsoft 제공업체를 사용 설정합니다.
해당 제공업체의 개발자 콘솔에서 제공되는 클라이언트 ID 및 클라이언트 보안 비밀번호를 제공업체 구성에 추가합니다.

Microsoft OAuth 클라이언트를 등록하려면 빠른 시작: Azure Active Directory v2.0 엔드포인트를 사용하여 앱 등록 [https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-v2-register-an-app]의 안내를 따릅니다.
이 엔드포인트는 Microsoft 개인 계정과 Azure Active Directory 계정을 사용하는 로그인을 지원합니다.
Azure Active Directory v2.0 자세히 알아보기 [https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-overview]
이러한 제공업체에 앱을 등록할 때 프로젝트의 *.firebaseapp.com 도메인을 앱의 리디렉션 도메인으로 등록해야 합니다.

저장을 클릭합니다.
아직 앱의 SHA-1 디지털 지문을 지정하지 않았다면 Firebase Console의 설정 페이지 [https://console.firebase.google.com/project/_/settings/general/?hl=ko]에서 지정합니다. 앱의 SHA-256 디지털 지문을 얻는 방법에 대한 자세한 내용은 클라이언트 인증 [https://developers.google.com/android/guides/client-auth?hl=ko]을 참조하세요.

Firebase SDK로 로그인 과정 처리

Android 앱을 개발하는 경우 Firebase Android SDK로 전체 로그인 과정을 처리하면 가장 손쉽게 Microsoft 계정을 통해 Firebase로 사용자를 인증할 수 있습니다.

Firebase Android SDK로 로그인 과정을 처리하려면 다음 단계를 따릅니다.

제공업체 ID microsoft.com을 사용하여 빌더로 OAuthProvider의 인스턴스를 생성합니다.
--- 탭: Kotlin [https://firebase.google.com/docs/auth/android/microsoft-oauth?hl=ko#kotlin-android] ---
val provider = OAuthProvider.newBuilder("microsoft.com")GenericIdpActivity.kt [https://github.com/firebase/snippets-android/blob/b281ca0e5ab26296ae1a981f3dc850c57e693c75/auth/app/src/main/java/com/google/firebase/quickstart/auth/kotlin/GenericIdpActivity.kt#L52-L52]

--- 탭: Java [https://firebase.google.com/docs/auth/android/microsoft-oauth?hl=ko#java-android] ---
OAuthProvider.Builder provider = OAuthProvider.newBuilder("microsoft.com");GenericIdpActivity.java [https://github.com/firebase/snippets-android/blob/b281ca0e5ab26296ae1a981f3dc850c57e693c75/auth/app/src/main/java/com/google/firebase/quickstart/auth/GenericIdpActivity.java#L58-L58]
선택사항: OAuth 요청과 함께 전송하고자 하는 커스텀 OAuth 매개변수를 추가로 지정합니다.
--- 탭: Kotlin [https://firebase.google.com/docs/auth/android/microsoft-oauth?hl=ko#kotlin-android] ---

Firebase에서 요구하는 매개변수는 setCustomParameters()와 함께 전달할 수 없습니다. 이러한 매개변수에는 client_id, response_type, redirect_uri, state, scope, response_mode가 있습니다.

특정 Azure AD 테넌트의 사용자만 애플리케이션에 로그인하도록 허용하려면 Azure AD 테넌트의 도메인 이름 또는 테넌트의 GUID 식별자를 사용하면 됩니다. 이렇게 하려면 커스텀 매개변수 객체의 '테넌트' 필드를 지정합니다.
--- 탭: Kotlin [https://firebase.google.com/docs/auth/android/microsoft-oauth?hl=ko#kotlin-android] ---
List<String> scopes =
new ArrayList<String>() {
add("mail.read");
add("calendars.read");
if (pendingResultTask != null) {
Task<AuthResult> pendingResultTask = firebaseAuth.getPendingAuthResult();
if (pendingResultTask != null) {
.addOnSuccessListener(
new OnSuccessListener<AuthResult>() {
@Override
public void onSuccess(AuthResult authResult) {
.startActivityForSignInWithProvider(activity, provider.build())
.startActivityForSignInWithProvider(/* activity= */ this, provider.build())
.addOnSuccessListener(
new OnSuccessListener<AuthResult>() {
@Override
public void onSuccess(AuthResult authResult) {
Azure AD 테넌트를 사용하여 로그인할 때는 oid 클레임이 정확히 일치합니다.
하지만 테넌트 외의 케이스에서는 oid 필드가 패딩됩니다. 제휴 ID 4b2eabcdefghijkl의 경우 oid에 00000000-0000-0000-4b2e-abcdefghijkl 양식이 사용됩니다.
위의 예시는 로그인 과정에 중점을 두고 있지만 startActivityForLinkWithProvider를 사용하여 Microsoft 제공업체를 기존 사용자에 연결할 수도 있습니다. 예를 들어 여러 제공업체를 동일한 사용자에 연결하여 그 중 하나로 로그인하도록 허용할 수 있습니다.
--- 탭: Kotlin [https://firebase.google.com/docs/auth/android/microsoft-oauth?hl=ko#kotlin-android] ---
firebaseUser
.startActivityForLinkWithProvider(activity, provider.build())
FirebaseUser firebaseUser = firebaseAuth.getCurrentUser();

firebaseUser
.startActivityForLinkWithProvider(/* activity= */ this, provider.build())
.addOnSuccessListener(
new OnSuccessListener<AuthResult>() {
@Override
public void onSuccess(AuthResult authResult) {
--- 탭: Kotlin [https://firebase.google.com/docs/auth/android/microsoft-oauth?hl=ko#kotlin-android] ---
firebaseUser
.startActivityForReauthenticateWithProvider(activity, provider.build())
FirebaseUser firebaseUser = firebaseAuth.getCurrentUser();

firebaseUser
.startActivityForReauthenticateWithProvider(/* activity= */ this, provider.build())
.addOnSuccessListener(
new OnSuccessListener<AuthResult>() {
@Override
public void onSuccess(AuthResult authResult) {