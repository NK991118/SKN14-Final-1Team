Source URL: https://cloud.google.com/bigquery/docs/facebook-ads-transfer

BigQuery [https://cloud.google.com/bigquery?hl=ko]
Documentation [https://cloud.google.com/bigquery/docs?hl=ko]
가이드 [https://cloud.google.com/bigquery/docs/introduction?hl=ko]
도움이 되었나요?
의견 보내기
이 페이지의 내용
지원되는 보고서 [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko#supported_reports]
제한사항 [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko#limitations]
Facebook Ads 전송에서 데이터 수집 [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko#data-ingestion]
시작하기 전에 [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko#before_you_begin]
Facebook Ads 기본 요건 [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko#fb_ads_prereqs]
BigQuery에 Facebook Ads 데이터 로드
bookmark_border
프리뷰
이 기능에는 서비스별 약관 [https://cloud.google.com/terms/service-terms?hl=ko#1]의 일반 서비스 약관 섹션에 있는 'GA 이전 제공 서비스 약관'이 적용됩니다. GA 이전 기능은 '있는 그대로' 제공되며 지원이 제한될 수 있습니다. 자세한 내용은 출시 단계 설명 [https://cloud.google.com/products?hl=ko#product-launch-stages]을 참조하세요.
참고: 이 기능에 대한 지원을 받거나 의견을 제출하려면 dts-preview-support@google.com [mailto:dts-preview-support@google.com]으로 문의하세요.
Facebook Ads용 BigQuery Data Transfer Service 커넥터를 사용하여 Facebook Ads에서 BigQuery로 데이터를 로드할 수 있습니다. BigQuery Data Transfer Service를 사용하면 Facebook Ads의 최신 데이터를 BigQuery에 추가하는 반복 전송 작업을 예약할 수 있습니다.
지원되는 보고서
Facebook Ads용 BigQuery Data Transfer Service는 다음 Facebook Ads 보고서의 전송을 지원합니다.
Ads
AdInsights
AdInsightsActions
Facebook Ads 보고서가 BigQuery 테이블 및 뷰로 변환되는 방식에 대한 자세한 내용은 Facebook Ads 데이터 변환 [https://cloud.google.com/bigquery/docs/facebook-ads-transformation?hl=ko]을 참고하세요.
보고 옵션 지원
반복 빈도
매일, 데이터 전송이 처음 만들어진 시간(기본값)
시간을 구성할 수 있습니다.
새로고침 기간
지난 30일
최대 30일까지 구성 가능
제한사항
Facebook Ads 데이터 전송에는 다음 제한사항이 적용됩니다.
반복 Facebook Ads 데이터 전송 사이의 최소 간격은 24시간입니다. 반복 데이터 전송의 기본 간격은 24시간입니다.
Facebook Ads용 BigQuery Data Transfer Service는 고정된 테이블 집합만 지원합니다. 맞춤 보고서는 지원되지 않습니다.
Facebook Ads 데이터 전송은 최대 6시간 동안 지속됩니다. 이 최대 기간보다 오래 걸리면 전송이 실패합니다.
AdInsights 및 AdInsightsActions 테이블에는 증분 전송이 지원되지 않습니다. AdInsights 및 AdInsightsActions 테이블이 포함된 데이터 전송을 만들고 일정 옵션에서 날짜를 지정한 경우 해당 날짜에 사용 가능한 모든 데이터가 전송됩니다.
BigQuery Data Transfer Service는 AdInsights 및 AdInsightsActions 테이블에 대해 1일의 새로고침 기간을 지원합니다. 새로고침 기간은 데이터 전송이 소스 데이터를 검색할 일 수를 나타냅니다. 데이터 전송을 처음 실행하면 데이터 전송이 새로고침 기간 내에 사용 가능한 모든 소스 데이터를 검색합니다.
Facebook Ads 전송에 필요한 장기 사용자 액세스 토큰은 60일 후에 만료됩니다.
장기 사용자 액세스 토큰이 만료된 경우 데이터 전송 세부정보로 이동하고 수정을 클릭하여 새 액세스 토큰을 받을 수 있습니다. 전송 수정 페이지에서 Facebook Ads 기본 요건 [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko#fb_ads_prereqs]의 동일한 단계에 따라 새 장기 사용자 액세스 토큰을 생성합니다.
구성된 네트워크 연결과 가상 머신(VM) 인스턴스가 서로 다른 리전에 있는 경우 Facebook Ads에서 데이터를 전송할 때 리전 간 데이터 이동이 발생할 수 있습니다.
Facebook Ads 전송에서 데이터 수집
Facebook Ads에서 BigQuery로 데이터를 전송할 때는 데이터가 날짜별로 파티션을 나눈 BigQuery 테이블에 로드됩니다. 데이터가 로드되는 테이블 파티션은 데이터 소스의 날짜에 해당합니다. 동일한 날짜에 여러 전송을 예약하면 BigQuery Data Transfer Service가 해당 날짜의 파티션을 최신 데이터로 덮어씁니다. 동일한 일자에 전송이 여러 개 있거나 백필을 실행해도 데이터가 중복되지 않으며 다른 일자의 파티션에 영향을 주지 않습니다.
AdInsights 및 AdInsightsAction 테이블의 경우 데이터가 로드되는 테이블 파티션은 데이터 소스의 날짜에 해당합니다.
AdAccounts 테이블의 경우 스냅샷은 하루에 한 번 생성되며 최근 전송 실행 날짜의 파티션에 저장됩니다. AdAccounts 테이블에는 새로고침 기간이 적용되지 않습니다.
시작하기 전에
다음 섹션에서는 Facebook Ads 데이터 전송을 만들기 전에 취해야 할 조치를 설명합니다.
Facebook Ads 기본 요건
Facebook Ads 데이터 전송을 만들 때 다음 Facebook Ads 정보가 있는지 확인합니다.
Facebook Ads 매개변수 설명
clientID OAuth 2.0 클라이언트의 앱 ID 이름입니다.
clientSecret OAuth 2.0 클라이언트의 앱 비밀번호입니다.
refreshToken 갱신 토큰이라고도 하는 장기 사용자 액세스 토큰입니다.
clientID 및 clientSecret을 받으려면 다음 단계를 수행하세요.
앱 유형이 Business인 Facebook 개발자 앱을 만듭니다 [https://developers.facebook.com/docs/development/create-an-app/other-app-types].
Facebook App 대시보드 [https://developers.facebook.com/apps]에서 앱 설정 > 기본을 클릭하고 앱에 해당하는 앱 ID와 앱 보안 비밀을 찾습니다.
갱신 토큰이라고도 하는 장기 사용자 액세스 토큰을 받으려면 다음 단계를 수행하세요.
Google Cloud 콘솔에서 Facebook Ads 전송을 생성 [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko#fb_ads_transfer_setup]하는 단계를 진행합니다.
데이터 소스 세부정보 섹션에서 갱신 토큰 필드 뒤에 나와 있는 리디렉션 URI를 복사합니다.
Facebook 앱 대시보드 [https://developers.facebook.com/apps]를 클릭한 다음 비즈니스용 Facebook 로그인 섹션에서 설정을 클릭합니다.
설정 페이지에서 유효한 OAuth 리디렉션 URI 필드에 리디렉션 URL을 입력하고 저장을 클릭합니다.
Google Cloud 콘솔로 돌아갑니다. 데이터 소스 세부정보 섹션에서 승인을 클릭합니다. Facebook 인증 페이지로 리디렉션됩니다.
Facebook 개발자 앱을 선택하여 BigQuery Data Transfer Service에 연결된 계정을 승인합니다.
완료되면 확인을 클릭하여 Google Cloud 콘솔로 돌아갑니다. 이제 장기 사용자 액세스 토큰이 전송 구성에 채워집니다.
장기 사용자 액세스 토큰은 60일 후에 만료됩니다. 새 장기 사용자 액세스 토큰을 가져오는 방법에 대한 자세한 내용은 제한사항 [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko#limitations]을 참조하세요.
갱신 토큰 대안
또는 다음 방법 중 하나를 사용하여 갱신 토큰을 받은 경우 데이터 전송을 만들 [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko#fb_ads_transfer_setup] 때 갱신 토큰을 제공할 수 있습니다.
Graph API를 사용하여 장기 사용자 액세스 토큰을 생성합니다 [https://developers.facebook.com/docs/facebook-login/guides/access-tokens/get-long-lived]. 데이터 전송에 유효한 토큰에는 ads_management, ads_read, business_management 권한이 필요합니다.
시스템 사용자 토큰을 생성합니다 [https://www.facebook.com/business/help/503306463479099?id=2190812977867143]. 시스템 사용자 토큰을 사용하면 데이터 전송에 포함할 광고 계정과 같은 애셋을 수동으로 추가할 수 있습니다. 시스템 사용자 토큰이 만료된 경우 새 사용자 인증 정보로 전송 구성을 수동으로 업데이트해야 합니다. 시스템 사용자 토큰을 만들 때 만료되지 않는 토큰을 만들 수도 있습니다. 자세한 내용은 지원되는 액세스 토큰 [https://developers.facebook.com/docs/facebook-login/facebook-login-for-business#supported-access-tokens]을 참조하세요.
BigQuery 기본 요건
BigQuery Data Transfer Service 사용 설정 [https://cloud.google.com/bigquery/docs/enable-transfer-service?hl=ko]에 필요한 모든 작업을 완료했는지 확인합니다.
데이터를 저장할 BigQuery 데이터세트를 만듭니다 [https://cloud.google.com/bigquery/docs/datasets?hl=ko].
Pub/Sub의 전송 실행 알림을 설정하려면 pubsub.topics.setIamPolicy Identity and Access Management(IAM) 권한이 있는지 확인합니다. 이메일 알림만 설정하는 경우에는 Pub/Sub 권한이 필요하지 않습니다. 자세한 내용은 BigQuery Data Transfer Service 실행 알림 [https://cloud.google.com/bigquery/docs/transfer-run-notifications?hl=ko]을 참조하세요.
필요한 BigQuery 역할
전송을 만드는 데 필요한 권한을 얻으려면 관리자에게 BigQuery 관리자 [https://cloud.google.com/iam/docs/roles-permissions/bigquery?hl=ko#bigquery.admin](roles/bigquery.admin) IAM 역할을 부여해 달라고 요청하세요. 역할 부여에 대한 자세한 내용은 프로젝트, 폴더, 조직에 대한 액세스 관리 [https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=ko]를 참조하세요.
이 사전 정의된 역할에는 전송을 만드는 데 필요한 권한이 포함되어 있습니다. 필요한 정확한 권한을 보려면 필수 권한 섹션을 펼치세요.
필수 권한
커스텀 역할 [https://cloud.google.com/iam/docs/creating-custom-roles?hl=ko]이나 다른 사전 정의된 역할 [https://cloud.google.com/iam/docs/roles-overview?hl=ko#predefined]을 사용하여 이 권한을 부여받을 수도 있습니다.
Facebook Ads 데이터 전송 만들기
다음 옵션 중 하나를 선택합니다.
--- 탭: 콘솔 [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko#%EC%BD%98%EC%86%94] ---
Google Cloud 콘솔에서 데이터 전송 페이지로 이동합니다.

데이터 전송으로 이동 [https://console.cloud.google.com/bigquery/transfers?hl=ko] 
add 전송 만들기를 클릭합니다.
소스 유형 섹션의 소스에 대해 Facebook Ads를 선택합니다.
데이터 소스 세부정보 섹션에서 다음을 수행합니다.


클라이언트 ID에 앱 ID를 입력합니다.
클라이언트 보안 비밀번호에 앱 보안 비밀을 입력합니다.
갱신 토큰에서 승인을 클릭하여 장기 사용자 액세스 토큰 ID를 입력합니다. 또는 이미 갱신 토큰이나 시스템 사용자 토큰이 있으면 [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko#refresh_token_alternatives] 이 필드에 갱신 토큰을 직접 입력할 수 있습니다. 장기 사용자 액세스 토큰 검색에 대한 자세한 내용은 Facebook Ads 기본 요건 [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko#fb_ads_prereqs]을 참조하세요.

대상 설정 섹션의 데이터 세트에서 데이터를 저장하기 위해 만든 데이터 세트를 선택합니다.
전송 구성 이름 섹션의 표시 이름에 데이터 전송 이름을 입력합니다.
일정 옵션 섹션에서 다음을 수행합니다.


반복 빈도 목록에서 이 데이터 전송 실행 빈도를 지정하는 옵션을 선택합니다. 커스텀 반복 빈도를 지정하려면 커스텀을 선택합니다. 주문형을 선택한 경우 수동으로 전송을 트리거 [https://cloud.google.com/bigquery/docs/working-with-transfers?hl=ko#manually_trigger_a_transfer]하면 이 전송이 실행됩니다.
해당하는 경우 지금 시작 또는 설정 시간에 시작을 선택하고 시작 날짜와 실행 시간을 입력합니다.

선택사항: 알림 옵션 섹션에서 다음을 수행합니다.


이메일 알림을 사용 설정하려면 이메일 알림 전환 버튼을 클릭합니다. 이 옵션을 사용 설정하면 전송 실행이 실패할 때 전송 관리자에게 이메일 알림이 발송됩니다.
이 데이터 전송에 Pub/Sub 전송 실행 알림 [https://cloud.google.com/bigquery/docs/transfer-run-notifications?hl=ko]을 사용 설정하려면 Pub/Sub 알림 전환 버튼을 클릭합니다. 주제 [https://cloud.google.com/pubsub/docs/overview?hl=ko#types] 이름을 선택하거나 주제 만들기를 클릭하여 주제를 만들 수 있습니다.

저장을 클릭합니다.


이 데이터 전송이 실행되면 BigQuery Data Transfer Service는 다음 테이블을 자동으로 채웁니다.



  테이블 이름
  설명


  AdAccounts
  사용자가 사용할 수 있는 광고 계정입니다.


  AdInsights
  모든 광고 계정에 대한 광고 통계 보고서입니다.


  AdInsightsActions
  모든 광고 계정에 대한 광고 통계 작업 보고서입니다.

--- 탭: bq [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko#bq] ---
bq mk 명령어 [https://cloud.google.com/bigquery/docs/reference/bq-cli-reference?hl=ko#bq_mk]를 입력하고 전송 생성 플래그 --transfer_config를 지정합니다.

bq mk
    --transfer_config
    --project_id=PROJECT_ID
    --data_source=DATA_SOURCE
    --display_name=DISPLAY_NAME
    --target_dataset=DATASET
    --params='PARAMETERS'

각 항목의 의미는 다음과 같습니다.


PROJECT_ID(선택사항): Google Cloud 프로젝트 ID.
특정 프로젝트를 지정하는 --project_id가 입력되지 않으면 기본 프로젝트가 사용됩니다.
DATA_SOURCE: 데이터 소스(예: facebook-ads).
DISPLAY_NAME: 데이터 전송 구성의 표시 이름입니다. 전송 이름은 나중에 수정해야 할 경우를 대비해 간편하게 전송을 식별할 수 있는 값이면 됩니다.
DATASET. 데이터 전송 구성의 대상 데이터 세트입니다.
PARAMETERS: JSON 형식으로 생성된 데이터 전송 구성의 파라미터입니다. 예를 들면 --params='{"param":"param_value"}'입니다. 다음은 Facebook Ads 전송을 위한 매개변수입니다.

connector.authentication.oauth.clientId: OAuth 2.0 클라이언트의 앱 ID 이름입니다.
connector.authentication.oauth.clientSecret: OAuth 2.0 클라이언트의 앱 비밀번호입니다.
connector.authentication.oauth.refreshToken: 장기 토큰 ID입니다.



예를 들어 다음 명령어는 모든 필수 파라미터로 기본 프로젝트에 Facebook Ads 데이터 전송을 만듭니다.

bq mk
--transfer_config
--target_dataset=mydataset
--data_source=facebook_ads
--display_name='My Transfer'
--params='{"connector.authentication.oauth.clientId": "1650000000",
    "connector.authentication.oauth.clientSecret":"TBA99550",
    "connector.authentication.oauth.refreshToken":"abcdef"}'

--- 탭: API [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko#api] ---
projects.locations.transferConfigs.create [https://cloud.google.com/bigquery-transfer/docs/reference/datatransfer/rest/v1/projects.locations.transferConfigs/create?hl=ko] 메서드를 사용하고 TransferConfig [https://cloud.google.com/bigquery-transfer/docs/reference/datatransfer/rest/v1/projects.locations.transferConfigs?hl=ko#TransferConfig] 리소스의 인스턴스를 지정합니다.
전송 구성 문제 해결
Facebook Ads 데이터 전송을 설정하는 데 문제가 있는 경우 다음 문제 해결 단계를 시도해 보세요.
Facebook Access Token Debugger [https://developers.facebook.com/tools/debug/accesstoken/]를 사용하여 사용자 액세스 토큰이 만료되었는지 확인합니다. 장기 사용자 액세스 토큰은 60일 후에 만료됩니다. 장기 사용자 액세스 토큰이 만료된 경우 전송 세부정보로 이동한 다음 수정을 클릭하여 전송 구성을 수정합니다. 전송 수정 페이지에서 Facebook Ads 기본 요건 [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko#fb_ads_prereqs]의 동일한 단계에 따라 새 장기 사용자 액세스 토큰을 생성합니다.
ads_management, ads_read, business_management의 필수 권한으로 장기 사용자 액세스 토큰이 생성되었는지 확인합니다. 그렇지 않은 경우 Facebook Ads 기본 요건 [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko#fb_ads_prereqs]의 단계에 따라 새 장기 사용자 액세스 토큰을 생성합니다.
Facebook 앱 대시보드 [https://developers.facebook.com/apps]의 필수 작업 탭에서 주의가 필요한 항목이 있는지 확인하세요.
Meta API 비율 제한 오류와 관련하여 다음과 같은 오류 메시지가 표시될 수 있습니다.
오류: There have been too many calls from this ad-account. Wait a bit and try again.
해결 방법: 동일한 앱 또는 사용자 인증 정보를 사용하는 병렬 워크플로가 없는지 확인합니다. 이러한 오류가 지속되면 권한을 고급 액세스로 업그레이드하여 비율 제한 할당량을 늘려보세요. 자세한 내용은 Marketing API 비율 제한 [https://developers.facebook.com/docs/marketing-apis/rate-limiting/]을 참조하세요.
일반적인 모니터링 측정항목 메시지
BigQuery Data Transfer Service 모니터링 측정항목 [https://cloud.google.com/bigquery/docs/dts-monitor?hl=ko#monitor]을 확인하여 데이터 전송 실패의 원인을 파악할 수도 있습니다. 다음 표에는 Facebook Ads 데이터 전송에 대한 몇 가지 일반적인 ERROR_CODE 메시지가 나와 있습니다.
오류 설명
INVALID_ARGUMENT 제공된 구성이 잘못되었습니다.
PERMISSION_DENIED 사용자 인증 정보가 잘못되었습니다.
UNAUTHENTICATED 인증이 필요합니다.
SERVICE_UNAVAILABLE 서비스에서 일시적으로 이 데이터 전송을 처리할 수 없습니다.
DEADLINE_EXCEEDED 최대 기간인 6시간 내에 데이터 전송이 완료되지 않았습니다.
NOT_FOUND 요청한 리소스를 찾을 수 없습니다.
INTERNAL 다른 문제로 인해 커넥터가 작동하지 않습니다.
RESOURCE_EXHAUSTED 데이터 소스 할당량 또는 한도가 소진되었습니다.
가격 책정
이 기능이 미리보기 [https://cloud.google.com/products?hl=ko#product-launch-stages] 상태인 동안에는 Facebook Ads 데이터를 BigQuery로 전송하는 데 비용이 들지 않습니다.
다음 단계
BigQuery Data Transfer Service [https://cloud.google.com/bigquery/docs/dts-introduction?hl=ko] 자세히 알아보기
구성 및 실행 기록 보기 등 전송 작업 [https://cloud.google.com/bigquery/docs/working-with-transfers?hl=ko]에 대해 자세히 알아보세요.
교차 클라우드 작업으로 데이터를 로드 [https://cloud.google.com/bigquery/docs/load-data-using-cross-cloud-transfer?hl=ko]하는 방법을 알아보세요.
도움이 되었나요?
의견 보내기