Source URL: https://cloud.google.com/bigquery/docs/managing-models-vertex

BigQuery [https://cloud.google.com/bigquery?hl=ko]
Documentation [https://cloud.google.com/bigquery/docs?hl=ko]
가이드 [https://cloud.google.com/bigquery/docs/introduction?hl=ko]
의견 보내기
이 페이지의 내용
기본 요건 [https://cloud.google.com/bigquery/docs/managing-models-vertex?hl=ko#prerequisites]
Vertex AI API 사용 설정 [https://cloud.google.com/bigquery/docs/managing-models-vertex?hl=ko#enable-api]
IAM 권한 부여 [https://cloud.google.com/bigquery/docs/managing-models-vertex?hl=ko#permissions]
모델 등록 [https://cloud.google.com/bigquery/docs/managing-models-vertex?hl=ko#register_models]
Vertex AI 모델 ID 지정 [https://cloud.google.com/bigquery/docs/managing-models-vertex?hl=ko#add-model-id]
Vertex AI 모델 별칭 지정 [https://cloud.google.com/bigquery/docs/managing-models-vertex?hl=ko#add-model-alias]
여러 버전의 BigQuery ML 모델 등록 [https://cloud.google.com/bigquery/docs/managing-models-vertex?hl=ko#register-new-bqml-model-version]
Model Registry에 기존 BigQuery ML 모델 등록 [https://cloud.google.com/bigquery/docs/managing-models-vertex?hl=ko#add-existing]
Vertex AI에서 BigQuery ML 모델 관리
bookmark_border
Vertex AI Model Registry에 BigQuery ML 모델을 등록하면 모델을 내보낼 필요 없이 Vertex AI 모델과 함께 관리할 수 있습니다. 모델을 Model Registry와 함께 등록하면 서빙 컨테이너가 없어도 단일 인터페이스를 사용하여 온라인 예측용 모델을 버전 관리, 평가, 배포할 수 있습니다. Vertex AI에 익숙하지 않고 BigQuery ML과 통합하는 방법에 대해 자세히 알아보려면 BigQuery 사용자를 위한 Vertex AI [https://cloud.google.com/vertex-ai/docs/beginner/bqml?hl=ko]를 참조하세요.
Vertex AI 예측에 대한 자세한 내용은 Vertex AI 예측 수행 개요 [https://cloud.google.com/vertex-ai/docs/predictions/overview?hl=ko]를 참조하세요.
참고: 모든 모델 유형을 등록할 수 있지만 배포 제한은 특정 모델 유형에도 적용됩니다. 자세한 내용은 모델 배포 [https://cloud.google.com/bigquery/docs/exporting-models?hl=ko#model-deployment]를 참조하세요.
Vertex AI Model Registry에서 BigQuery ML 모델을 관리하는 방법을 알아보려면 Vertex AI Model Registry 소개 [https://cloud.google.com/vertex-ai/docs/model-registry/introduction?hl=ko]를 참조하세요.
기본 요건
BigQuery ML 모델을 Model Registry에 등록하려면 몇 가지 기본 요건을 충족해야 합니다.
Vertex AI API 사용 설정
BigQuery ML 모델을 Model Registry에 등록하기 전에 프로젝트에서 Vertex AI API를 사용 설정해야 합니다. Google Cloud 콘솔의 API 및 서비스 페이지를 사용하거나 다음 Google Cloud CLI 명령어를 실행하면 됩니다.
gcloud --project PROJECT_ID services enable aiplatform.googleapis.com
IAM 권한 부여
BigQuery ML 모델을 Model Registry에 등록하는 데 사용하는 서비스 계정 또는 사용자 계정에 Vertex AI 관리자(roles/aiplatform.admin) [https://cloud.google.com/vertex-ai/docs/general/access-control?hl=ko#aiplatform.admin] 역할을 부여해야 합니다. Vertex AI 역할 및 권한에 대한 자세한 내용은 IAM으로 액세스 제어 [https://cloud.google.com/vertex-ai/docs/general/access-control?hl=ko]를 참조하세요.
다음 명령어를 사용하여 서비스 계정에 Vertex AI 관리자 역할을 부여합니다.
gcloud projects add-iam-policy-binding PROJECT_ID --member=serviceAccount:SERVICE_ACCOUNT_EMAIL --role=roles/aiplatform.admin --condition=None
다음 명령어를 사용하여 사용자 계정에 Vertex AI 관리자 역할을 부여합니다.
gcloud projects add-iam-policy-binding PROJECT_ID --member=user:USER_ACCOUNT --role=roles/aiplatform.admin --condition=None
모델 등록
BigQuery ML 모델을 만들 때 CREATE MODEL 문 [https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-create?hl=ko]의 MODEL_REGISTRY 옵션을 사용하여 모델을 Model Registry에 등록할 수 있습니다. CREATE MODEL 문에는 모델 ID를 지정하는 VERTEX_AI_MODEL_ID 옵션과 하나 이상의 모델 버전 별칭을 지정하는 VERTEX_AI_MODEL_VERSION_ALIASES 옵션도 포함되어 있습니다. 이러한 옵션을 사용하여 배포를 간소화하고 모델을 관리하고 모델에서 Vertex Explainable AI [https://cloud.google.com/vertex-ai/docs/explainable-ai/overview?hl=ko]를 사용 설정할 수 있습니다.
모델을 만들 때 MODEL_REGISTRY 옵션을 설정하면 BigQuery ML에서 학습을 완료하면 모델이 Model Registry에 자동으로 표시됩니다. Google Cloud 콘솔의 Model Registry 페이지에 있는 소스 열을 사용하여 모델의 소스 위치를 확인할 수 있습니다.
BigQuery ML 모델이 등록되면 모델에서 Model Registry 기능을 사용할 수 있습니다. 엔드포인트에 모델 배포, 모델 버전 비교, 예측, 모델 모니터링, 모델 평가 보기 등을 수행할 수 있습니다. 또한 예측에 영향을 주는 특성에 대해 알아보려면 Vertex Explainable AI를 사용하여 모델에 대한 특성 기반 설명을 획득할 수 있습니다.
BigQuery ML을 사용하여 생성된 모든 모델은 Model Registry 등록 여부에 관계없이 BigQuery 사용자 인터페이스에 계속 표시됩니다.
Vertex AI 모델 ID 지정
모델을 더 쉽게 관리하려면 모델을 만들 때 VERTEX_AI_MODEL_ID 옵션을 사용하여 Vertex AI 모델 ID를 지정하세요. 모델 ID는 BigQuery ML 모델과 연결되며 Model Registry에서 확인할 수 있습니다.
Vertex AI 모델 ID는 대문자를 허용하지 않습니다. Vertex AI 모델 ID를 지정하지 않으면 BigQuery ML 모델 ID가 사용됩니다. 이 경우 BigQuery ML 모델 ID도 소문자여야 합니다. 모델 ID 요구사항의 전체 목록을 확인하려면 업로드 참고 문서 [https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.models/upload?hl=ko]의 사양을 참조하세요.
Vertex AI 모델 ID를 업데이트하려면 모델을 삭제하고 올바른 새 Vertex AI 모델 ID로 다시 만들어야 합니다. ALTER MODEL 명령어를 사용하여 Vertex AI 모델 ID를 업데이트할 수는 없습니다.
Vertex AI 모델 별칭 지정
모델 별칭을 지정하려면 모델을 만들 때 VERTEX_AI_MODEL_VERSION_ALIASES 옵션을 지정합니다. 모델 별칭은 특정 버전의 ID를 파악할 필요 없이 참조로 특정 모델 버전을 가져오거나 배포할 수 있어서 유용합니다. 이러한 점에서 모델 별칭은 Git의 Docker 태그 또는 브랜치 참조와 비슷하게 작동합니다.
Model Registry 별칭의 작동 방식에 대한 자세한 내용은 모델 버전 별칭 사용 방법 [https://cloud.google.com/vertex-ai/docs/model-registry/model-alias?hl=ko]을 참조하세요.
여러 버전의 BigQuery ML 모델 등록
기존 BigQuery ML 모델의 새 버전을 만들어 Model Registry에 있는 다른 버전과 비교하려면 모델을 만들 때 다른 BigQuery ML 모델 ID를 지정한 후 이를 원본 Model Registry 모델 ID에 등록해야 합니다.
BigQuery ML 모델을 만들거나 교체할 때 이미 Model Registry의 모델과 연결된 BigQuery ML 모델 ID를 사용하는 경우 기존 Model Registry 모델 버전이 삭제되고 새 모델로 교체됩니다.
Model Registry에 기존 BigQuery ML 모델 등록
BigQuery ML 모델은 Model Registry에 자동으로 추가되지 않습니다. ALTER MODEL 문 [https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-alter-model?hl=ko]은 모델 ID를 추가하고 모델을 Model Registry에 등록할 뿐만 아니라 모델 설명 및 라벨과 같은 메타데이터를 업데이트하는 데 사용할 수 있습니다.
BigQuery ML에서 모델 메타데이터를 업데이트하는 방법에 관한 자세한 내용은 모델 메타데이터 업데이트 [https://cloud.google.com/bigquery/docs/updating-model-metadata?hl=ko]를 참조하세요.
기존 모델을 등록하려면 다음 안내를 따르세요.
SQL [https://cloud.google.com/bigquery/docs/managing-models-vertex?hl=ko#sql]
bq [https://cloud.google.com/bigquery/docs/managing-models-vertex?hl=ko#bq]
API [https://cloud.google.com/bigquery/docs/managing-models-vertex?hl=ko#api]
ALTER MODEL [IF EXISTS] <model_name> SET OPTIONS (vertex_ai_model_id="VERTEX_AI_MODEL_ID");
모델을 등록할 때 새 모델 ID를 지정하면 BigQuery ML 모델이 Model Registry에 모델 버전 1로 표시됩니다. 모델을 기존 모델의 새 버전으로 추가하려면 기존 모델의 ID를 지정합니다. 이렇게 하면 새 모델이 기존 모델의 최신 버전으로 자동 등록됩니다.
등록된 BigQuery ML 모델의 모델 ID 변경
BigQuery ML 모델이 Model Registry에 등록되면 VERTEX_AI_MODEL_ID 값을 변경할 수 없습니다. 새 VERTEX_AI_MODEL_ID에 모델을 등록하려면 다음 옵션 중 하나를 사용합니다.
재학습 비용이 허용되는 경우 모델을 삭제 [https://cloud.google.com/bigquery/docs/deleting-models?hl=ko#delete_a_model]하고 다시 만듭니다.
모델을 복사 [https://cloud.google.com/bigquery/docs/managing-models?hl=ko#copy_a_model]한 다음 ALTER MODEL 문을 사용하여 새 모델을 새 VERTEX_AI_MODEL_ID 값으로 등록합니다.
위치 고려사항
멀티 리전 BigQuery ML 모델을 Model Registry에 등록하면 Vertex AI에서 모델이 리전 모델로 변환됩니다. BigQuery ML US 멀티 리전 모델은 Vertex AI(us-central1)에 동기화되고 BigQuery ML 멀티 리전 EU 모델은 Vertex AI(europe-west4)에 동기화됩니다. 단일 리전 모델의 경우 변경사항이 없습니다.
모델 위치를 업데이트하는 방법은 위치 선택 [https://cloud.google.com/vertex-ai/docs/general/locations?hl=ko#choosing_your_location]을 참조하세요.
Model Registry에서 BigQuery ML 모델 삭제
Model Registry에서 BigQuery ML 모델을 삭제하려면 BigQuery ML에서 모델을 삭제합니다. 모델이 Model Registry에서 자동으로 삭제됩니다.
BigQuery ML 모델을 삭제하는 방법에는 여러 가지가 있습니다. 자세한 내용은 모델 삭제 [https://cloud.google.com/bigquery/docs/deleting-models?hl=ko]를 참조하세요.
Model Registry에 등록되고 엔드포인트에 배포된 BigQuery ML의 모델을 삭제하려면 먼저 Model Registry를 사용하여 모델 배포를 취소해야 합니다. 그런 다음 BigQuery ML로 돌아가서 모델을 삭제할 수 있습니다. 모델 배포를 취소하는 방법은 엔드포인트 삭제 [https://cloud.google.com/vertex-ai/docs/samples/aiplatform-delete-endpoint-sample?hl=ko]를 참조하세요.
다음 단계
BigQuery ML을 사용한 온라인 예측 [https://github.com/GoogleCloudPlatform/vertex-ai-samples/blob/main/notebooks/community/bigquery_ml/bqml-online-prediction.ipynb] 노트북에 따라 BigQuery ML을 사용하여 모델을 학습시키고, 모델을 Model Registry에 등록하고, 실시간 예측을 위해 엔드포인트에 배포합니다.
의견 보내기