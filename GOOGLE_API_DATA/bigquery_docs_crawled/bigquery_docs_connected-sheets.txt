Source URL: https://cloud.google.com/bigquery/docs/connected-sheets

BigQuery [https://cloud.google.com/bigquery?hl=ko]
Documentation [https://cloud.google.com/bigquery/docs?hl=ko]
가이드 [https://cloud.google.com/bigquery/docs/introduction?hl=ko]
도움이 되었나요?
의견 보내기
이 페이지의 내용
사용 사례 [https://cloud.google.com/bigquery/docs/connected-sheets?hl=ko#use_cases]
액세스 제어 [https://cloud.google.com/bigquery/docs/connected-sheets?hl=ko#access_control]
VPC 서비스 제어 [https://cloud.google.com/bigquery/docs/connected-sheets?hl=ko#vpc-service-controls]
시작하기 전에 [https://cloud.google.com/bigquery/docs/connected-sheets?hl=ko#before_you_begin]
연결된 시트에서 BigQuery 데이터 세트 열기 [https://cloud.google.com/bigquery/docs/connected-sheets?hl=ko#use]
연결된 시트에서 테이블 열기 [https://cloud.google.com/bigquery/docs/connected-sheets?hl=ko#open-tables-sheets]
삭제 [https://cloud.google.com/bigquery/docs/connected-sheets?hl=ko#clean-up]
다음 단계 [https://cloud.google.com/bigquery/docs/connected-sheets?hl=ko#whats_next]
연결된 시트 사용
bookmark_border
연결된 시트를 사용하면 Google Sheets 스프레드시트에서 수십억 개의 BigQuery 데이터의 행을 액세스, 분석, 시각화, 공유할 수 있습니다.
다음 작업을 수행할 수도 있습니다.
익숙한 스프레드시트 인터페이스에서 파트너, 분석가 또는 다른 이해관계자와 공동작업합니다.
추가적인 스프레드시트 내보내기 없이 데이터 분석의 단일 정보 출처를 확인합니다.
보고 및 대시보드 워크플로를 간소화할 수 있습니다.
연결형 시트는 요청 또는 정의된 일정에 따라 사용자 대신 BigQuery 쿼리를 실행합니다. 이러한 쿼리 결과는 분석 및 공유를 위해 스프레드시트에 저장됩니다.
사용 사례
다음은 SQL을 알 필요 없이 연결된 시트를 사용하여 시트 내에서 대량의 데이터를 분석하는 방법을 보여주는 몇 가지 사용 사례입니다.
비즈니스 계획: 데이터 세트를 빌드하고 준비한 다음 다른 사람들이 데이터에서 유용한 정보를 찾을 수 있도록 합니다. 예를 들어 판매 데이터를 분석하여 여러 위치에서 더 많이 판매되는 제품을 확인합니다.
고객 서비스: 고객 10,000명당 불만사항이 가장 많이 제기된 매장이 어느 곳인지 확인합니다.
영업: 내부 재무 및 영업 보고서를 만들고 영업 담당자와 수익 보고서를 공유합니다.
액세스 제어
BigQuery 데이터 세트 및 테이블에 대한 직접 액세스는 여전히 BigQuery 내에서 제어됩니다. 사용자에게 Google Sheets 액세스 권한만 부여하려면 스프레드시트를 공유하고 BigQuery 액세스 권한을 부여하지 않습니다.
Google Sheets 전용 액세스 권한이 있는 사용자는 시트에서 분석을 수행하고 다른 Google Sheets 기능을 사용할 수 있지만, 사용자는 다음 작업을 수행할 수 없습니다.
시트에서 BigQuery 데이터를 수동으로 새로고침합니다.
시트에서 데이터 새로고침을 예약합니다.
연결된 시트에서 데이터를 필터링하면 선택한 프로젝트에 대해 BigQuery로 전송하는 쿼리가 새로고침됩니다. 관련 프로젝트에서 다음 로그 필터를 사용하여 실행된 쿼리를 볼 수 있습니다.
resource.type="bigquery_resource"
protoPayload.metadata.firstPartyAppMetadata.sheetsMetadata.docId != NULL_VALUE
VPC 서비스 제어
VPC 서비스 제어 [https://cloud.google.com/vpc-service-controls?hl=ko]를 사용하여 Google Cloud 리소스에 대한 액세스를 제한할 수 있습니다. VPC 서비스 제어 기능을 사용하면 Sheets가 지원되지 않으므로 VPC 서비스 제어에서 보호하는 BigQuery 데이터에 액세스하지 못할 수 있습니다. 필요한 허용 권한이 있고 VPC 서비스 제어 액세스 제한사항을 충족하는 경우 연결된 시트를 통해 실행된 쿼리를 허용하도록 VPC 서비스 제어 경계를 구성할 수 있습니다. 이렇게 하려면 다음을 사용하여 경계를 구성해야 합니다.
경계 외부의 신뢰할 수 있는 IP 주소, ID, 신뢰할 수 있는 클라이언트 기기의 요청을 허용하는 액세스 수준 또는 인그레스 규칙
쿼리 결과를 사용자의 스프레드시트에 복사할 수 있는 이그레스 규칙
규칙 [https://cloud.google.com/vpc-service-controls/docs/ingress-egress-rules?hl=ko]을 올바르게 구성하려면 인그레스 및 이그레스 정책 구성 [https://cloud.google.com/vpc-service-controls/docs/configuring-ingress-egress-policies?hl=ko], 액세스 수준 구성 [https://cloud.google.com/vpc-service-controls/docs/use-access-levels?hl=ko]을 알아보세요. 필요한 데이터 복사를 허용하도록 경계를 구성하려면 다음 YAML 파일을 사용합니다.
# Allows egress to Sheets through the Connected Sheets feature
- egressTo:
    operations:
    - serviceName: 'bigquery.googleapis.com'
      methodSelectors:
      - permission: 'bigquery.vpcsc.importData'
    resources:
    - projects/628550087766 # Sheets-owned Google Cloud project
  egressFrom:
    identityType: ANY_USER_ACCOUNT
참고: 연결된 시트의 정기 새로고침은 IP 주소 또는 기기 정보와 같은 최종 사용자 컨텍스트를 전파하지 않습니다. 최종 사용자 컨텍스트를 사용하여 액세스를 제한하는 VPC 서비스 제어 경계로 인해 정기 새로고침이 실패합니다.
시작하기 전에
먼저 Google Workspace 주제 Google 스프레드시트에서 BigQuery 데이터 시작하기 [https://support.google.com/docs/answer/9702507?hl=ko]의 '필요한 항목' 섹션에 설명된 대로 스프레드시트의 BigQuery 데이터에 액세스하기 위한 요구사항을 충족하는지 확인합니다.
아직 결제가 설정된 Google Cloud 프로젝트가 없으면 다음 단계를 따르세요.
Sign in to your Google Cloud account. If you're new to Google Cloud, create an account [https://console.cloud.google.com/freetrial?hl=ko] to evaluate how our products perform in real-world scenarios. New customers also get $300 in free credits to run, test, and deploy workloads.
In the Google Cloud console, on the project selector page, select or create a Google Cloud project.
Note: If you don't plan to keep the resources that you create in this procedure, create a project instead of selecting an existing project. After you finish these steps, you can delete the project, removing all resources associated with the project.
Go to project selector [https://console.cloud.google.com/projectselector2/home/dashboard?hl=ko]
Verify that billing is enabled for your Google Cloud project [https://cloud.google.com/billing/docs/how-to/verify-billing-enabled?hl=ko#confirm_billing_is_enabled_on_a_project].
BigQuery는 새 프로젝트에서 자동으로 사용 설정됩니다. 기존 프로젝트에서 BigQuery를 활성화하려면 다음으로 이동합니다.
Enable the BigQuery API.
Enable the API [https://console.cloud.google.com/flows/enableapi?apiid=bigquery&hl=ko]
이 주제를 마치면 만든 리소스를 삭제하여 비용이 계속 청구되지 않도록 할 수 있습니다. 자세한 내용은 삭제 [https://cloud.google.com/bigquery/docs/connected-sheets?hl=ko#clean-up]를 참조하세요.
연결된 시트에서 BigQuery 데이터 세트 열기
다음 예시에서는 공개 데이터 세트를 사용하여 Google Sheets에서 BigQuery에 연결하는 방법을 보여줍니다.
Google Sheets 스프레드시트를 만들거나 엽니다.
데이터를 클릭하고 데이터 커넥터를 클릭한 후 BigQuery에 연결을 클릭합니다.
참고: 데이터 커넥터 옵션이 표시되지 않으면 시작하기 전에 [https://cloud.google.com/bigquery/docs/connected-sheets?hl=ko#before_you_begin]를 참조하세요.
연결하기를 클릭합니다.
결제가 사용 설정된 Google Cloud 프로젝트를 선택합니다.
공개 데이터 세트를 클릭합니다.
검색창에 chicago를 입력한 다음 chicago_taxi_trips 데이터 세트를 선택합니다.
taxi_trips 테이블을 선택한 다음 연결을 클릭합니다.
스프레드시트는 다음과 유사하게 표시됩니다.
스프레드시트 사용을 시작합니다. 익숙한 Google Sheets 기술을 사용하여 피벗 테이블, 수식, 차트를 만들 수 있습니다.
스프레드시트에는 미리보기 행이 500개만 표시되지만 모든 피벗 테이블, 수식, 차트에 전체 데이터 세트가 사용됩니다. 피벗 테이블에 반환되는 결과의 최대 행 수는 50,000개입니다. 데이터를 시트에 추출할 수도 있습니다. 데이터 추출에 반환되는 결과의 최대 행 수는 50,000개입니다. 자세한 내용은 연결된 시트 튜토리얼 [https://www.youtube.com/watch?v=rkimIhnLKGI&hl=ko]을 참조하세요.
연결된 시트에서 테이블 열기
Google Cloud 콘솔의 연결된 시트에서 테이블을 열려면 다음 방법 중 하나를 사용합니다.
탐색기 창을 사용합니다.
탐색기 창에서 Google Sheets에서 열려는 테이블이 포함된 데이터 세트를 펼칩니다.
테이블 이름 옆에 있는 more_vert 작업 보기를 클릭한 후 연결 프로그램 > 연결된 시트를 선택합니다.
테이블 툴바를 사용합니다.
탐색기 창에서 Google Sheets에서 열려는 테이블을 클릭합니다.
테이블 툴바에서 내보내기를 클릭한 후 Sheets로 탐색을 클릭합니다.
삭제
이 튜토리얼에서 사용한 리소스 비용이 Google Cloud 계정에 청구되지 않도록 하려면 다음 안내를 따르세요.
주의: 프로젝트를 삭제하면 다음과 같은 효과가 발생합니다.
프로젝트의 모든 항목이 삭제됩니다. 이 문서의 태스크에 기존 프로젝트를 사용한 경우 프로젝트를 삭제하면 프로젝트에서 수행한 다른 작업도 삭제됩니다.
커스텀 프로젝트 ID가 손실됩니다. 이 프로젝트를 만들 때 앞으로 사용할 커스텀 프로젝트 ID를 만들었을 수 있습니다. appspot.com URL과 같이 프로젝트 ID를 사용하는 URL을 보존하려면 전체 프로젝트를 삭제하는 대신 프로젝트 내에서 선택한 리소스만 삭제합니다.
여러 아키텍처, 튜토리얼, 빠른 시작을 살펴보려는 경우 프로젝트를 재사용하면 프로젝트 할당량 한도 초과를 방지할 수 있습니다.
In the Google Cloud console, go to the Manage resources page.
Go to Manage resources [https://console.cloud.google.com/iam-admin/projects?hl=ko]
In the project list, select the project that you want to delete, and then click Delete.
In the dialog, type the project ID, and then click Shut down to delete the project.
다음 단계
Google Workspace Google 스프레드시트에서 BigQuery 데이터 시작하기 [https://support.google.com/docs/answer/9702507?hl=ko] 주제에서 자세한 정보 얻기
YouTube에서 연결된 시트 재생목록 사용 [https://www.youtube.com/playlist?list=PLU8ezI8GYqs74i8hy_qln3FvkAuSpE-r1&hl=ko]의 동영상 보기
도움이 되었나요?
의견 보내기