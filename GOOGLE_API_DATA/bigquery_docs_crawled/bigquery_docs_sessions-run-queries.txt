Source URL: https://cloud.google.com/bigquery/docs/sessions-run-queries

이 페이지는 Cloud Translation API [https://cloud.google.com/translate/?hl=ko]를 통해 번역되었습니다.
Switch to English
BigQuery [https://cloud.google.com/bigquery?hl=ko]
Documentation [https://cloud.google.com/bigquery/docs?hl=ko]
가이드 [https://cloud.google.com/bigquery/docs/introduction?hl=ko]
도움이 되었나요?
의견 보내기
이 페이지의 내용
세션에서 쿼리 실행 [https://cloud.google.com/bigquery/docs/sessions-run-queries?hl=ko#run_a_query_in_a_session]
다음 단계 [https://cloud.google.com/bigquery/docs/sessions-run-queries?hl=ko#whats_next]
세션에서 쿼리 실행
bookmark_border
이 문서에서는 BigQuery 세션에서 쿼리를 실행하는 방법을 설명합니다. 이 문서는 세션 [https://cloud.google.com/bigquery/docs/sessions-intro?hl=ko]을 대체적으로 이해하고 있고, 이미 세션을 만들었고 [https://cloud.google.com/bigquery/docs/sessions-create?hl=ko], 사용할 세션의 ID [https://cloud.google.com/bigquery/docs/sessions-get-ids?hl=ko]를 알고 있는 사용자를 대상으로 합니다.
이 단계를 완료하기 전에 세션을 만드는 데 필요한 권한 [https://cloud.google.com/bigquery/docs/sessions-intro?hl=ko#roles_and_permissions]이 있는지 확인합니다.
세션에서 쿼리 실행
세션 만들기 [https://cloud.google.com/bigquery/docs/sessions-create?hl=ko]가 완료되면 세션에 쿼리를 추가하고 실행할 수 있습니다. 이를 위한 몇 가지 방법이 있습니다.
--- 탭: 콘솔 [https://cloud.google.com/bigquery/docs/sessions-run-queries?hl=ko#%EC%BD%98%EC%86%94] ---
Google Cloud 콘솔에서 BigQuery 페이지로 이동합니다.

BigQuery로 이동 [https://console.cloud.google.com/bigquery?hl=ko] 
세션이 포함된 편집기 탭을 클릭합니다.
세션에 쿼리를 추가하고 실행을 클릭합니다.


세션 테스트

 Google Cloud 콘솔에서 만든 세션 [https://cloud.google.com/bigquery/docs/sessions-create?hl=ko]이 포함된 편집기 탭을 열고 다음 SQL 문을 실행합니다.
CREATE TEMP TABLE Temperature(degrees INT64)  AS SELECT * FROM UNNEST([30,0,3,14,55]) AS a;

탭에서 콘텐츠를 삭제하거나 주석 처리하고 다음 SQL 문을 실행합니다.
SELECT * FROM Temperature;

다음과 비슷한 결과가 표시되는지 확인합니다.
+---------+
| degrees |
+---------+
|      55 |
|      14 |
|       3 |
|       0 |
|      30 |
+---------+

--- 탭: bq [https://cloud.google.com/bigquery/docs/sessions-run-queries?hl=ko#bq] ---
Cloud Shell [https://console.cloud.google.com/bigquery?cloudshell=true&hl=ko]을 열고 다음 bq query [https://cloud.google.com/bigquery/docs/reference/bq-cli-reference?hl=ko#bq_query] 명령어를 입력합니다.

bq query \
--nouse_legacy_sql \
--session_id=SESSION_ID \
'SQL_STATEMENT'

각 항목의 의미는 다음과 같습니다.


SESSION_ID: 이를 작업하려는 세션 ID [https://cloud.google.com/bigquery/docs/sessions-get-ids?hl=ko]로 바꿉니다.
SQL_STATEMENT: 세션에서 실행할 SQL 문입니다.


세션 테스트

생성한 세션 [https://cloud.google.com/bigquery/docs/sessions-create?hl=ko]에 Temperature라는 임시 테이블을 만듭니다. 세션 ID를 원하는 값으로 바꿉니다.
bq query \
  --nouse_legacy_sql \
  --session_id=CgwKCmZhbGl1LXRlc3QQARokMDAzYjI0OWQtZ \
  'CREATE TEMP TABLE Temperature(degrees INT64)  AS SELECT * FROM UNNEST([30,0,3,14,55]) AS a;'

Temperature 테이블의 모든 값 목록을 가져옵니다. 세션 ID를 원하는 값으로 바꿉니다.
bq query \
  --nouse_legacy_sql \
  --session_id=CgwKCmZhbGl1LXRlc3QQARokMDAzYjI0OWQtZ \
  'SELECT * FROM Temperature;'

다음과 비슷한 결과가 표시되는지 확인합니다.
+-------+
| total |
+-------+
|    30 |
|     0 |
|     3 |
|    14 |
|    55 |
+-------+

In session: CgwKCmZhbGl1LXRlc3QQARokMDAzYjI0OWQtZ

.bigqueryrc에 세션을 추가하여 시간 절약하기

Cloud Shell에서 쿼리를 많이 실행하려는 경우 .bigqueryrc [https://cloud.google.com/bigquery/docs/bq-command-line-tool?hl=ko#adding_flags_to_bigqueryrc]에서 [query]에 세션 ID를 추가하면 각 명령어에 세션 ID를 복사하여 붙여넣을 필요가 없습니다.

.bigqueryrc의 세션 ID는 다음과 같습니다.
[query]
--session_id=CgwKCmZhbGl1LXRlc3QQARokMDAzYjI0OWQtZ

세션 ID를 .bigqueryrc에 추가한 후에는 이 명령어를 대신 사용할 수 있습니다.
bq query \
  --nouse_legacy_sql \
  'SELECT * FROM Temperature;'

다른 세션을 사용하려는 경우 또는 세션이 종료된 경우 .bigqueryrc를 업데이트해야 합니다.

--- 탭: API [https://cloud.google.com/bigquery/docs/sessions-run-queries?hl=ko#api] ---
정의된 작업 리소스 [https://cloud.google.com/bigquery/docs/reference/rest/v2/jobs?hl=ko]를 사용하여 jobs.insert 메서드 또는 jobs.query 메서드를 호출합니다.

jobs.insert [https://cloud.google.com/bigquery/docs/sessions-run-queries?hl=ko#jobs.insert]jobs.query [https://cloud.google.com/bigquery/docs/sessions-run-queries?hl=ko#jobs.query]
          더보기
          
          
        다음 매개변수를 사용하여 jobs.insert [https://cloud.google.com/bigquery/docs/reference/rest/v2/jobs/insert?hl=ko] 메서드를 호출합니다.

{
  "jobReference": {
    "projectId": "PROJECT_ID",
    "jobId": "JOB_ID"
  },
  "configuration": {
    "query": {
      "query": "SQL_STATEMENT",
      "connectionProperties": [{
        "key": "session_id",
        "value": "SESSION_ID"
      }]
    }
  }
}

각 항목의 의미는 다음과 같습니다.


PROJECT_ID: 세션을 만들 프로젝트
JOB_ID: 세션을 만들 작업입니다.
SQL_STATEMENT: 세션의 첫 번째 SQL 문입니다.
SESSION_ID: 세션의 ID [https://cloud.google.com/bigquery/docs/sessions-get-ids?hl=ko]입니다.


세션 테스트

다음 요청 본문을 입력하여 생성한 세션 [https://cloud.google.com/bigquery/docs/sessions-create?hl=ko]에 Temperature라는 임시 테이블을 만듭니다.
프로젝트 ID, 작업 ID, 세션 ID를 원하는 값으로 바꿉니다.
{
  "jobReference": {
    "projectId": "myProject",
    "jobId": "job_123"
  },
  "configuration": {
    "query": {
      "query": "CREATE TEMP TABLE Temperature(degrees INT64) AS SELECT * FROM UNNEST([30,0,3,14,55]) AS a;",
      "connectionProperties": [{
        "key": "session_id",
        "value": "CgwKCmZhbGl1LXRlc3QQARokMDAzYjI0OWQtZ"
      }]
    }
  }
}

다음 요청 본문을 입력하여 세션의 Temperature 테이블에 있는 모든 값의 목록을 가져옵니다. 프로젝트 ID, 작업 ID, 세션 ID를 원하는 값으로 바꿉니다.
{
  "jobReference": {
    "projectId": "myProject",
    "jobId": "job_123"
  },
  "configuration": {
    "query": {
      "query": "SELECT * FROM Temperature;",
      "connectionProperties": [{
        "key": "session_id",
        "value": "CgwKCmZhbGl1LXRlc3QQARokMDAzYjI0OWQtZ"
      }]
    }
  }
}

두 요청의 응답 본문이 다음과 유사한지 확인합니다.
{
  "jobReference": {
    "projectId": "myProject",
    "jobId": "job_123"
  },
  "statistics": {
    "sessionInfo": {
      "sessionId": "CgwKCmZhbGl1LXRlc3QQARokMDAzYjI0OWQtZ"
    }
  }
}

다음 매개변수를 사용하여 jobs.query [https://cloud.google.com/bigquery/docs/reference/rest/v2/jobs/query?hl=ko] 메서드를 호출합니다.

{
  "query": "SQL_STATEMENT",
  "connectionProperties": [{
    "key": "session_id",
    "value": "SESSION_ID"
  }]
}

각 항목의 의미는 다음과 같습니다.


SQL_STATEMENT: 세션의 첫 번째 SQL 문입니다.
SESSION_ID: 세션의 ID [https://cloud.google.com/bigquery/docs/sessions-get-ids?hl=ko]입니다.


세션 테스트

다음 요청 본문을 입력하여 생성한 세션 [https://cloud.google.com/bigquery/docs/sessions-create?hl=ko]에 Temperature라는 임시 테이블을 만듭니다.
프로젝트 ID, 작업 ID, 세션 ID를 원하는 값으로 바꿉니다.
{
  "query": "CREATE TEMP TABLE Temperature(degrees INT64) AS SELECT * FROM UNNEST([30,0,3,14,55]) AS a;",
  "connectionProperties": [{
    "key": "session_id",
    "value": "CgwKCmZhbGl1LXRlc3QQARokMDAzYjI0OWQtZ"
  }]
}

다음 요청 본문을 입력하여 세션의 Temperature 테이블에 있는 모든 값의 목록을 가져옵니다. 프로젝트 ID, 작업 ID, 세션 ID를 원하는 값으로 바꿉니다.
{
  "query": "SELECT * FROM Temperature;",
  "connectionProperties": [{
    "key": "session_id",
    "value": "CgwKCmZhbGl1LXRlc3QQARokMDAzYjI0OWQtZ"
  }]
}

두 요청의 응답 본문이 다음과 유사한지 확인합니다.
{
  "jobReference": {
    "projectId": "myProject",
    "jobId": "job_123"
  },
  "statistics": {
    "sessionInfo": {
      "sessionId": "CgwKCmZhbGl1LXRlc3QQARokMDAzYjI0OWQtZ"
    }
  }
}

--- 탭: jobs.insert [https://cloud.google.com/bigquery/docs/sessions-run-queries?hl=ko#jobs.insert] ---
다음 매개변수를 사용하여 jobs.insert [https://cloud.google.com/bigquery/docs/reference/rest/v2/jobs/insert?hl=ko] 메서드를 호출합니다.

{
  "jobReference": {
    "projectId": "PROJECT_ID",
    "jobId": "JOB_ID"
  },
  "configuration": {
    "query": {
      "query": "SQL_STATEMENT",
      "connectionProperties": [{
        "key": "session_id",
        "value": "SESSION_ID"
      }]
    }
  }
}

각 항목의 의미는 다음과 같습니다.


PROJECT_ID: 세션을 만들 프로젝트
JOB_ID: 세션을 만들 작업입니다.
SQL_STATEMENT: 세션의 첫 번째 SQL 문입니다.
SESSION_ID: 세션의 ID [https://cloud.google.com/bigquery/docs/sessions-get-ids?hl=ko]입니다.


세션 테스트

다음 요청 본문을 입력하여 생성한 세션 [https://cloud.google.com/bigquery/docs/sessions-create?hl=ko]에 Temperature라는 임시 테이블을 만듭니다.
프로젝트 ID, 작업 ID, 세션 ID를 원하는 값으로 바꿉니다.
{
  "jobReference": {
    "projectId": "myProject",
    "jobId": "job_123"
  },
  "configuration": {
    "query": {
      "query": "CREATE TEMP TABLE Temperature(degrees INT64) AS SELECT * FROM UNNEST([30,0,3,14,55]) AS a;",
      "connectionProperties": [{
        "key": "session_id",
        "value": "CgwKCmZhbGl1LXRlc3QQARokMDAzYjI0OWQtZ"
      }]
    }
  }
}

다음 요청 본문을 입력하여 세션의 Temperature 테이블에 있는 모든 값의 목록을 가져옵니다. 프로젝트 ID, 작업 ID, 세션 ID를 원하는 값으로 바꿉니다.
{
  "jobReference": {
    "projectId": "myProject",
    "jobId": "job_123"
  },
  "configuration": {
    "query": {
      "query": "SELECT * FROM Temperature;",
      "connectionProperties": [{
        "key": "session_id",
        "value": "CgwKCmZhbGl1LXRlc3QQARokMDAzYjI0OWQtZ"
      }]
    }
  }
}

두 요청의 응답 본문이 다음과 유사한지 확인합니다.
{
  "jobReference": {
    "projectId": "myProject",
    "jobId": "job_123"
  },
  "statistics": {
    "sessionInfo": {
      "sessionId": "CgwKCmZhbGl1LXRlc3QQARokMDAzYjI0OWQtZ"
    }
  }
}

--- 탭: jobs.query [https://cloud.google.com/bigquery/docs/sessions-run-queries?hl=ko#jobs.query] ---
다음 매개변수를 사용하여 jobs.query [https://cloud.google.com/bigquery/docs/reference/rest/v2/jobs/query?hl=ko] 메서드를 호출합니다.

{
  "query": "SQL_STATEMENT",
  "connectionProperties": [{
    "key": "session_id",
    "value": "SESSION_ID"
  }]
}

각 항목의 의미는 다음과 같습니다.


SQL_STATEMENT: 세션의 첫 번째 SQL 문입니다.
SESSION_ID: 세션의 ID [https://cloud.google.com/bigquery/docs/sessions-get-ids?hl=ko]입니다.


세션 테스트

다음 요청 본문을 입력하여 생성한 세션 [https://cloud.google.com/bigquery/docs/sessions-create?hl=ko]에 Temperature라는 임시 테이블을 만듭니다.
프로젝트 ID, 작업 ID, 세션 ID를 원하는 값으로 바꿉니다.
{
  "query": "CREATE TEMP TABLE Temperature(degrees INT64) AS SELECT * FROM UNNEST([30,0,3,14,55]) AS a;",
  "connectionProperties": [{
    "key": "session_id",
    "value": "CgwKCmZhbGl1LXRlc3QQARokMDAzYjI0OWQtZ"
  }]
}

다음 요청 본문을 입력하여 세션의 Temperature 테이블에 있는 모든 값의 목록을 가져옵니다. 프로젝트 ID, 작업 ID, 세션 ID를 원하는 값으로 바꿉니다.
{
  "query": "SELECT * FROM Temperature;",
  "connectionProperties": [{
    "key": "session_id",
    "value": "CgwKCmZhbGl1LXRlc3QQARokMDAzYjI0OWQtZ"
  }]
}

두 요청의 응답 본문이 다음과 유사한지 확인합니다.
{
  "jobReference": {
    "projectId": "myProject",
    "jobId": "job_123"
  },
  "statistics": {
    "sessionInfo": {
      "sessionId": "CgwKCmZhbGl1LXRlc3QQARokMDAzYjI0OWQtZ"
    }
  }
}
다음 단계
세션에서 쿼리 작성 [https://cloud.google.com/bigquery/docs/sessions-write-queries?hl=ko]
세션 종료 [https://cloud.google.com/bigquery/docs/sessions-terminating?hl=ko]
도움이 되었나요?
의견 보내기