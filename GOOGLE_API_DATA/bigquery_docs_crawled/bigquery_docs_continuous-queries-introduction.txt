Source URL: https://cloud.google.com/bigquery/docs/continuous-queries-introduction

BigQuery [https://cloud.google.com/bigquery?hl=ko]
Documentation [https://cloud.google.com/bigquery/docs?hl=ko]
가이드 [https://cloud.google.com/bigquery/docs/introduction?hl=ko]
도움이 되었나요?
의견 보내기
이 페이지의 내용
사용 사례 [https://cloud.google.com/bigquery/docs/continuous-queries-introduction?hl=ko#use_cases]
지원되는 작업 [https://cloud.google.com/bigquery/docs/continuous-queries-introduction?hl=ko#supported_operations]
승인 [https://cloud.google.com/bigquery/docs/continuous-queries-introduction?hl=ko#authorization]
위치 [https://cloud.google.com/bigquery/docs/continuous-queries-introduction?hl=ko#locations]
제한사항 [https://cloud.google.com/bigquery/docs/continuous-queries-introduction?hl=ko#limitations]
연속 쿼리 소개
bookmark_border
이 문서에서는 BigQuery 연속 쿼리를 설명합니다.
BigQuery 연속 쿼리는 지속적으로 실행되는 SQL 문입니다. 연속 쿼리를 사용하면 BigQuery에서 수신 데이터를 실시간으로 분석할 수 있습니다. 연속 쿼리에서 생성된 출력 행을 BigQuery 테이블에 삽입하거나 Pub/Sub, Bigtable 또는 Spanner로 내보낼 수 있습니다. 연속 쿼리는 다음 방법 중 하나를 사용하여 표준 BigQuery 테이블 [https://cloud.google.com/bigquery/docs/tables-intro?hl=ko#standard_tables]에 기록된 데이터를 처리할 수 있습니다.
BigQuery Storage Write API [https://cloud.google.com/bigquery/docs/write-api?hl=ko]
tabledata.insertAll 메서드 [https://cloud.google.com/bigquery/docs/reference/rest/v2/tabledata/insertAll?hl=ko]
일괄 로드 [https://cloud.google.com/bigquery/docs/batch-loading-data?hl=ko]
INSERT DML 문 [https://cloud.google.com/bigquery/docs/reference/standard-sql/dml-syntax?hl=ko#insert_statement]
연속 쿼리를 사용하여 통계를 만들어 즉시 조치, 실시간 머신러닝(ML) 추론 적용, 다른 플랫폼에 데이터 복제 등 시간에 민감한 작업을 수행할 수 있습니다. 이를 통해 애플리케이션 결정 로직을 위한 이벤트 기반 데이터 처리 엔진으로 BigQuery를 사용할 수 있습니다.
다음 다이어그램은 일반적인 연속 쿼리 워크플로를 보여줍니다.
사용 사례
연속 쿼리를 사용할 수 있는 일반적인 사용 사례는 다음과 같습니다.
맞춤설정된 고객 상호작용 서비스: 생성형 AI를 사용하여 각 고객 상호작용에 맞춤설정된 메시지를 만듭니다.
이상 감지: 복잡한 데이터에 대해 실시간으로 이상 및 위협 감지를 수행할 수 있는 솔루션을 빌드하여 문제에 보다 신속하게 대응할 수 있습니다.
맞춤설정 가능한 이벤트 기반 파이프라인: Pub/Sub와의 연속 쿼리 통합을 사용해서 수신 데이터를 기반으로 다운스트림 애플리케이션을 트리거합니다.
데이터 보강 및 항목 추출: 연속 쿼리를 사용하여 SQL 함수 및 ML 모델을 사용하여 실시간 데이터 보강 및 변환을 수행합니다.
역방향 추출, 변환, 로드(ETL): 지연 시간이 짧은 애플리케이션 제공에 더 적합한 다른 스토리지 시스템으로 실시간 역방향 ETL을 수행합니다. 예를 들어 BigQuery에 쓰여진 이벤트 데이터를 분석하거나 개선한 후 애플리케이션 서빙을 위해 Bigtable 또는 Spanner로 스트리밍합니다.
지원되는 작업
연속 쿼리에서 지원되는 작업은 다음과 같습니다.
INSERT 문 [https://cloud.google.com/bigquery/docs/reference/standard-sql/dml-syntax?hl=ko#insert_statement]을 실행하여 연속 쿼리의 데이터를 BigQuery 테이블에 씁니다.
EXPORT DATA 문 [https://cloud.google.com/bigquery/docs/reference/standard-sql/export-statements?hl=ko]을 실행하여 Pub/Sub 주제에 연속 쿼리 출력을 게시 [https://cloud.google.com/pubsub/docs/publish-message-overview?hl=ko]합니다. 자세한 내용은 Pub/Sub로 데이터 내보내기 [https://cloud.google.com/bigquery/docs/export-to-pubsub?hl=ko]를 참조하세요.
Pub/Sub 주제에서 Dataflow를 사용하여 스트리밍 분석을 수행하거나 애플리케이션 통합 워크플로에서 데이터를 사용하는 등 다른 서비스에서 데이터를 사용할 수 있습니다.
EXPORT DATA 문을 실행하여 BigQuery에서 Bigtable 테이블 [https://cloud.google.com/bigtable/docs/managing-tables?hl=ko]로 데이터를 내보냅니다. 자세한 내용은 Bigtable에 데이터 내보내기 [https://cloud.google.com/bigquery/docs/export-to-bigtable?hl=ko]를 참조하세요.
EXPORT DATA 문을 실행하여 BigQuery에서 Spanner 테이블로 데이터를 내보냅니다. 자세한 내용은 Spanner로 데이터 내보내기(역방향 ETL) [https://cloud.google.com/bigquery/docs/export-to-spanner?hl=ko]를 참고하세요.
다음 생성형 AI 함수를 호출합니다.
ML.GENERATE_TEXT [https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-generate-text?hl=ko]
이 함수를 사용하려면 Vertex AI 모델 [https://cloud.google.com/vertex-ai/generative-ai/docs/learn/models?hl=ko]을 기반으로 한 BigQuery ML 원격 모델 [https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-create-remote-model?hl=ko]이 있어야 합니다.
다음 AI 함수 호출:
ML.UNDERSTAND_TEXT [https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-understand-text?hl=ko]
ML.TRANSLATE [https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-translate?hl=ko]
이러한 함수를 사용하려면 Cloud AI API를 기반으로 한 BigQuery ML 원격 모델 [https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-create-remote-model-service?hl=ko]이 있어야 합니다.
ML.NORMALIZER 함수 [https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-normalizer?hl=ko]를 사용하여 수치 데이터를 정규화합니다.
스테이트리스(Stateless) GoogleSQL 함수(예: 변환 함수 [https://cloud.google.com/bigquery/docs/reference/standard-sql/conversion_functions?hl=ko])를 사용합니다. 스테이트리스(Stateless) 함수에서 각 행은 테이블의 다른 행과는 별개로 처리됩니다.
APPENDS [https://cloud.google.com/bigquery/docs/reference/standard-sql/time-series-functions?hl=ko#appends] 변경 내역 함수를 사용하여 특정 시점에서 연속 쿼리 처리를 시작합니다.
승인
연속 쿼리 작업을 실행할 때 사용되는 Google Cloud 액세스 토큰 [https://cloud.google.com/docs/authentication/token-types?hl=ko#access]은 사용자 계정으로 생성된 경우 2일의 TTL(수명)을 갖습니다. 따라서 이러한 작업은 2일 후에 실행이 중지됩니다. 서비스 계정에서 생성된 액세스 토큰은 더 오래 실행될 수 있지만 최대 쿼리 런타임을 준수해야 합니다. 자세한 내용은 서비스 계정을 사용하여 연속 쿼리 실행 [https://cloud.google.com/bigquery/docs/continuous-queries?hl=ko#run_a_continuous_query_by_using_a_service_account]을 참조하세요.
위치
다음 위치 [https://cloud.google.com/bigquery/docs/locations?hl=ko]에서는 연속 쿼리가 지원되지 않습니다.
리전 설명 리전 이름 세부정보
미주
미국 멀티 리전 us
Dallas us-south1 낮은 CO2 [https://cloud.google.com/sustainability/region-carbon?hl=ko#region-picker]
아이오와 us-central1 낮은 CO2 [https://cloud.google.com/sustainability/region-carbon?hl=ko#region-picker]
로스앤젤레스 us-west2
멕시코 northamerica-south1
몬트리올 northamerica-northeast1 낮은 CO2 [https://cloud.google.com/sustainability/region-carbon?hl=ko#region-picker]
북버지니아 us-east4
오리건 us-west1 낮은 CO2 [https://cloud.google.com/sustainability/region-carbon?hl=ko#region-picker]
솔트레이크시티 us-west3
상파울루 southamerica-east1 낮은 CO2 [https://cloud.google.com/sustainability/region-carbon?hl=ko#region-picker]
사우스캐롤라이나 us-east1
토론토 northamerica-northeast2 낮은 CO2 [https://cloud.google.com/sustainability/region-carbon?hl=ko#region-picker]
아시아 태평양
델리 asia-south2
홍콩 asia-east2
자카르타 asia-southeast2
멜버른 australia-southeast2
뭄바이 asia-south1
오사카 asia-northeast2
서울 asia-northeast3
싱가포르 asia-southeast1
시드니 australia-southeast1
타이완 asia-east1
도쿄 asia-northeast1
유럽
EU 멀티 리전 eu
벨기에 europe-west1 낮은 CO2 [https://cloud.google.com/sustainability/region-carbon?hl=ko#region-picker]
베를린 europe-west10 낮은 CO2 [https://cloud.google.com/sustainability/region-carbon?hl=ko#region-picker]
핀란드 europe-north1 낮은 CO2 [https://cloud.google.com/sustainability/region-carbon?hl=ko#region-picker]
프랑크푸르트 europe-west3
런던 europe-west2 낮은 CO2 [https://cloud.google.com/sustainability/region-carbon?hl=ko#region-picker]
마드리드 europe-southwest1 낮은 CO2 [https://cloud.google.com/sustainability/region-carbon?hl=ko#region-picker]
밀라노 europe-west8
네덜란드 europe-west4 낮은 CO2 [https://cloud.google.com/sustainability/region-carbon?hl=ko#region-picker]
파리 europe-west9 낮은 CO2 [https://cloud.google.com/sustainability/region-carbon?hl=ko#region-picker]
스톡홀름 europe-north2 낮은 CO2 [https://cloud.google.com/sustainability/region-carbon?hl=ko#region-picker]
토리노 europe-west12
바르샤바 europe-central2
취리히 europe-west6 낮은 CO2 [https://cloud.google.com/sustainability/region-carbon?hl=ko#region-picker]
중동
도하 me-central1
Dammam me-central2
텔아비브 me-west1
아프리카
요하네스버그 africa-south1
제한사항
연속 쿼리에는 다음과 같은 제한사항이 적용됩니다.
BigQuery 연속 쿼리는 수집된 데이터의 상태를 유지하지 않습니다. JOIN, 집계 함수, 윈도우 함수와 같이 상태에 의존하는 일반적인 작업은 지원되지 않습니다.
연속 쿼리에서는 다음 SQL 기능을 사용할 수 없습니다.
JOIN 운영 [https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax?hl=ko#join_types]
집계 함수 [https://cloud.google.com/bigquery/docs/reference/standard-sql/aggregate_functions?hl=ko]
근사치 집계 함수 [https://cloud.google.com/bigquery/docs/reference/standard-sql/approximate_aggregate_functions?hl=ko]
다음 쿼리 [https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax?hl=ko] 절:
GROUP BY [https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax?hl=ko#group_by_clause]
HAVING [https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax?hl=ko#having_clause]
ORDER BY [https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax?hl=ko#order_by_clause]
LIMIT [https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax?hl=ko#limit_and_offset_clause]
다음 쿼리 [https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax?hl=ko] 연산자:
PIVOT [https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax?hl=ko#pivot_operator]
UNPIVOT [https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax?hl=ko#unpivot_operator]
TABLESAMPLE [https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax?hl=ko#tablesample_operator]
쿼리 설정 연산자 [https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax?hl=ko#set_operators]
SELECT DISTINCT 문 [https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax?hl=ko#select_distinct]
EXISTS 또는 NOT EXISTS 서브 쿼리 [https://cloud.google.com/bigquery/docs/reference/standard-sql/subqueries?hl=ko#exists_subquery_concepts]
재귀적 CTE [https://cloud.google.com/bigquery/docs/recursive-ctes?hl=ko]
사용자 정의 함수 [https://cloud.google.com/bigquery/docs/user-defined-functions?hl=ko]
윈도우 함수 [https://cloud.google.com/bigquery/docs/reference/standard-sql/window-function-calls?hl=ko]
지원되는 작업 [https://cloud.google.com/bigquery/docs/continuous-queries-introduction?hl=ko#supported_operations]에 나열되지 않은 BigQuery ML 함수
데이터 정의 언어(DDL) 문 [https://cloud.google.com/bigquery/docs/reference/standard-sql/data-definition-language?hl=ko]
INSERT를 제외한 데이터 조작 언어(DML) 문 [https://cloud.google.com/bigquery/docs/reference/standard-sql/dml-syntax?hl=ko]
데이터 제어 언어(DCL) 문 [https://cloud.google.com/bigquery/docs/reference/standard-sql/data-control-language?hl=ko]
Bigtable, Pub/Sub 또는 Spanner를 대상으로 하지 않는 EXPORT DATA 문
절차적 언어 [https://cloud.google.com/bigquery/docs/reference/standard-sql/procedural-language?hl=ko]
디버깅 문 [https://cloud.google.com/bigquery/docs/reference/standard-sql/debugging-statements?hl=ko]
연속 쿼리는 변경 데이터 캡처(CDC) 삽입/업데이트(upsert) [https://cloud.google.com/bigquery/docs/change-data-capture?hl=ko] 데이터 처리를 지원하지 않습니다.
연속 쿼리는 데이터 소스로 와일드 카드 테이블 [https://cloud.google.com/bigquery/docs/querying-wildcard-tables?hl=ko]을 지원하지 않습니다.
연속 쿼리는 데이터 소스로 외부 테이블 [https://cloud.google.com/bigquery/docs/external-data-sources?hl=ko]을 지원하지 않습니다.
연속 쿼리는 데이터 소스로 INFORMATION_SCHEMA 뷰 [https://cloud.google.com/bigquery/docs/information-schema-intro?hl=ko]를 지원하지 않습니다.
연속 쿼리는 BigQuery의 Apache Iceberg용 BigLake 테이블 [https://cloud.google.com/bigquery/docs/iceberg-tables?hl=ko]을 지원하지 않습니다.
연속 쿼리는 다음 BigQuery 보안 기능을 지원하지 않습니다.
열 [https://cloud.google.com/bigquery/docs/column-level-security-intro?hl=ko] 및 행 수준 [https://cloud.google.com/bigquery/docs/row-level-security-intro?hl=ko] 보안
Bigtable로 데이터를 내보낼 [https://cloud.google.com/bigquery/docs/export-to-bigtable?hl=ko] 때는 쿼리 중인 테이블이 포함된 BigQuery 데이터 세트와 동일한Google Cloud 리전 경계 내에 있는 Bigtable 인스턴스만 대상으로 지정할 수 있습니다. 자세한 내용은 위치 고려사항 [https://cloud.google.com/bigquery/docs/export-to-bigtable?hl=ko#data-locations]을 참조하세요. Pub/Sub는 전역 리소스이므로 Pub/Sub로 데이터를 내보내는 경우에는 이 제한이 적용되지 않습니다.
Bigtable, Spanner 또는 Pub/Sub 위치 엔드포인트 [https://cloud.google.com/pubsub/docs/reference/service_apis_overview?hl=ko#pubsub_endpoints]로 데이터를 내보낼 때는 쿼리 중인 테이블이 포함된 BigQuery 데이터 세트와 동일한 Google Cloud리전 경계 내에 있는 Bigtable, Spanner 또는 Pub/Sub 리소스만 대상으로 지정할 수 있습니다. Pub/Sub 전역 엔드포인트로 데이터를 내보내는 경우에는 이 제한이 적용되지 않습니다.
데이터 캔버스 [https://cloud.google.com/bigquery/docs/data-canvas?hl=ko]에서는 연속 쿼리를 실행할 수 없습니다.
연속 쿼리 작업이 실행되는 동안에는 연속 쿼리에 사용되는 SQL을 수정할 수 없습니다. 자세한 내용은 연속 쿼리의 SQL 수정 [https://cloud.google.com/bigquery/docs/continuous-queries?hl=ko#modify_the_sql_of_a_continuous_query]을 참조하세요.
연속 쿼리 작업이 수신 데이터 처리가 지연되고 출력 워터마크 지연 [https://cloud.google.com/bigquery/docs/monitoring-dashboard?hl=ko#metrics]이 48시간을 초과하면 실패합니다. 쿼리를 다시 실행하고 APPENDS [https://cloud.google.com/bigquery/docs/reference/standard-sql/time-series-functions?hl=ko#appends] 변경 내역 함수를 사용하여 이전 연속 쿼리 작업을 중지한 시점부터 처리를 재개할 수 있습니다. 자세한 내용은 특정 시점부터 연속 쿼리 시작 [https://cloud.google.com/bigquery/docs/continuous-queries?hl=ko#start_a_continuous_query_from_a_particular_point_in_time]을 참조하세요.
사용자 계정으로 구성된 연속 쿼리는 최대 2일 동안 실행할 수 있습니다. 서비스 계정으로 구성된 연속 쿼리는 최대 150일 동안 실행할 수 있습니다. 최대 쿼리 런타임에 도달하면 쿼리가 실패하고 수신 데이터 처리가 중지됩니다.
연속 쿼리는 BigQuery 안정성 기능 [https://cloud.google.com/bigquery/docs/reliability-intro?hl=ko]을 사용하여 빌드되지만 일시적인 문제가 가끔 발생할 수 있습니다. 문제가 발생하면 연속 쿼리가 자동으로 일부 재처리되어 연속 쿼리 출력에 중복 데이터가 발생할 수 있습니다. 이러한 시나리오를 처리하도록 다운스트림 시스템을 설계하세요.
예약 제한사항
연속 쿼리를 실행하려면 Enterprise 버전 또는 Enterprise Plus 버전 예약 [https://cloud.google.com/bigquery/docs/reservations-intro?hl=ko]을 만들어야 합니다. 연속 쿼리는 주문형 컴퓨팅 청구 모델을 지원하지 않습니다.
CONTINUOUS 예약 할당 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko]을 만들면 연결된 예약이 최대 500슬롯으로 제한됩니다. bq-continuous-queries-feedback@google.com [mailto:bq-continuous-queries-feedback@google.com]으로 문의하여 이 한도 상향을 요청할 수 있습니다.
연속 쿼리 예약 할당은 예약이 공유하도록 구성된 경우에도 유휴 슬롯 [https://cloud.google.com/bigquery/docs/slots?hl=ko#idle_slots]을 공유하지 않습니다.
연속 쿼리 예약 할당과 동일한 예약에서 다른 작업 유형 [https://cloud.google.com/bigquery/docs/reservations-intro?hl=ko#assignments]을 사용하는 예약 할당을 만들 수 없습니다.
연속 쿼리 동시 실행은 구성할 수 없습니다. BigQuery는 CONTINUOUS 작업 유형을 사용하는 사용 가능한 예약 할당을 기반으로 동시에 실행할 수 있는 연속 쿼리 수를 자동으로 결정합니다.
동일한 예약을 사용하여 여러 개의 연속 쿼리를 실행하는 경우 BigQuery 공정성 [https://cloud.google.com/bigquery/docs/slots?hl=ko#fair_scheduling_in_bigquery]에 정의된 대로 개별 작업이 사용 가능한 리소스를 공정하게 분할하지 않을 수 있습니다.
슬롯 자동 확장
연속 쿼리는 슬롯 자동 확장 [https://cloud.google.com/bigquery/docs/slots-autoscaling-intro?hl=ko]을 사용하여 할당된 용량을 워크로드에 맞게 동적으로 확장할 수 있습니다. 연속 쿼리 워크로드가 증가하거나 감소함에 따라 BigQuery는 슬롯을 동적으로 조정합니다.
연속 쿼리가 실행되기 시작하면 슬롯 리소스를 소비하는 수신 데이터를 적극적으로 수신 대기합니다. 실행 중인 연속 쿼리가 있는 예약은 슬롯이 0으로 축소되지 않지만, 주로 수신 데이터를 수신 대기하는 유휴 연속 쿼리는 최소한의 슬롯(일반적으로 1개 슬롯)을 소비할 것으로 예상됩니다.
가격 책정
연속 쿼리에서는 슬롯 [https://cloud.google.com/bigquery/docs/slots?hl=ko]으로 측정되는 BigQuery 용량 컴퓨팅 가격 책정 [https://cloud.google.com/bigquery/pricing?hl=ko#capacity_compute_analysis_pricing]을 사용합니다. 연속 쿼리를 실행하려면 Enterprise 또는 Enterprise Plus 버전 [https://cloud.google.com/bigquery/docs/editions-intro?hl=ko]을 사용하는 예약 [https://cloud.google.com/bigquery/docs/reservations-workload-management?hl=ko] CONTINUOUS 작업 유형을 사용하는 예약 할당 [https://cloud.google.com/bigquery/docs/reservations-intro?hl=ko#assignments]이 있어야 합니다.
데이터 수집 및 스토리지 등의 기타 BigQuery 리소스 사용 요금은 BigQuery 가격 책정 [https://cloud.google.com/bigquery/pricing?hl=ko]에 표시된 요율에 따라 청구됩니다.
연속 쿼리 결과를 받거나 연속 쿼리 처리 중에 호출되는 다른 서비스를 사용하면 해당 서비스에 대해 게시된 요금이 청구됩니다. 연속 쿼리에 사용되는 기타 Google Cloud 서비스의 가격 책정은 다음 주제를 참조하세요.
Bigtable 가격 책정 [https://cloud.google.com/bigtable/pricing?hl=ko]
Pub/Sub 가격 책정 [https://cloud.google.com/pubsub/pricing?hl=ko]
Spanner 가격 책정 [https://cloud.google.com/spanner/pricing?hl=ko]
Vertex AI 가격 책정 [https://cloud.google.com/vertex-ai/pricing?hl=ko]
다음 단계
연속 쿼리 만들어 보기 [https://cloud.google.com/bigquery/docs/continuous-queries?hl=ko]
도움이 되었나요?
의견 보내기