Source URL: https://cloud.google.com/bigquery/docs/table-snapshots-restore

BigQuery [https://cloud.google.com/bigquery?hl=ko]
Documentation [https://cloud.google.com/bigquery/docs?hl=ko]
가이드 [https://cloud.google.com/bigquery/docs/introduction?hl=ko]
도움이 되었나요?
의견 보내기
이 페이지의 내용
권한 및 역할 [https://cloud.google.com/bigquery/docs/table-snapshots-restore?hl=ko#permissions_and_roles]
권한 [https://cloud.google.com/bigquery/docs/table-snapshots-restore?hl=ko#permissions]
역할 [https://cloud.google.com/bigquery/docs/table-snapshots-restore?hl=ko#roles]
테이블 스냅샷 복원 [https://cloud.google.com/bigquery/docs/table-snapshots-restore?hl=ko#restore_a_table_snapshot]
새 테이블로 복원 [https://cloud.google.com/bigquery/docs/table-snapshots-restore?hl=ko#restore_to_a_new_table]
기존 테이블 덮어쓰기 [https://cloud.google.com/bigquery/docs/table-snapshots-restore?hl=ko#overwrite_an_existing_table]
다음 단계 [https://cloud.google.com/bigquery/docs/table-snapshots-restore?hl=ko#whats_next]
테이블 스냅샷 복원
bookmark_border
이 문서에서는 Google Cloud Console, CREATE TABLE CLONE 쿼리, bq cp 명령어, jobs.insert API를 사용하여 테이블 스냅샷에서 쓰기 가능한 테이블을 복만드는 방법을 설명합니다. 이 문서는 테이블 스냅샷 [https://cloud.google.com/bigquery/docs/table-snapshots-intro?hl=ko]에 익숙한 사용자를 대상으로 합니다.
권한 및 역할
이 섹션에서는 테이블 스냅샷에서 쓰기 가능한 테이블을 만들어야 하는 Identity and Access Management(IAM) 권한 [https://cloud.google.com/bigquery/docs/access-control?hl=ko#bq-permissions]과 이러한 권한에 부여하는 사전 정의된 IAM 역할 [https://cloud.google.com/bigquery/docs/access-control?hl=ko#bigquery]을 설명합니다.
권한
테이블 스냅샷에서 쓰기 가능한 테이블을 만들려면 다음 권한이 필요합니다.
권한 리소스
다음 모든 항목:

bigquery.tables.get
bigquery.tables.getData
bigquery.tables.restoreSnapshot
쓰기 가능한 테이블에 복사할 테이블 스냅샷입니다.
bigquery.tables.create 대상 테이블이 포함된 데이터 세트입니다.
역할
필요한 권한을 제공하는 사전 정의된 BigQuery 역할은 다음과 같습니다.
역할 리소스
다음 중 하나인 경우:

bigquery.dataEditor
bigquery.dataOwner
bigquery.admin 쓰기 가능한 테이블에 복사할 테이블 스냅샷입니다.
다음 중 하나인 경우:

bigquery.dataEditor
bigquery.dataOwner
bigquery.admin 대상 테이블이 포함된 데이터 세트입니다.
테이블 스냅샷 복원
스냅샷에서 쓰기 가능한 테이블을 만들려면 복사할 테이블 스냅샷과 대상 테이블을 지정합니다. 대상 테이블은 새 테이블일 수 있습니다. 또는 기존 테이블을 테이블 스냅샷으로 덮어쓸 수 있습니다.
새 테이블로 복원
다음 옵션 중 하나를 사용하여 테이블 스냅샷을 새 테이블로 복원할 수 있습니다.
--- 탭: 콘솔 [https://cloud.google.com/bigquery/docs/table-snapshots-restore?hl=ko#%EC%BD%98%EC%86%94] ---
Google Cloud 콘솔에서 BigQuery 페이지로 이동합니다.

BigQuery로 이동 [https://console.cloud.google.com/bigquery?hl=ko] 
탐색기 창에서 복원하려는 테이블 스냅샷의 프로젝트 및 데이터 세트 노드를 펼칩니다.
테이블 스냅샷 이름을 클릭합니다.
표시된 테이블 스냅샷 창에서 복원을 클릭합니다.


표시되는 스냅샷 복원 창에 프로젝트, 데이터 세트, 새 테이블의 테이블 정보를 입력합니다.
저장을 클릭합니다.

--- 탭: SQL [https://cloud.google.com/bigquery/docs/table-snapshots-restore?hl=ko#sql] ---
CREATE TABLE CLONE DDL 문 [https://cloud.google.com/bigquery/docs/reference/standard-sql/data-definition-language?hl=ko#create_table_clone_statement]을 사용합니다.






Google Cloud 콘솔에서 BigQuery 페이지로 이동합니다.

BigQuery로 이동 [https://console.cloud.google.com/bigquery?hl=ko] 
쿼리 편집기에서 다음 문을 입력합니다.

CREATE TABLE TABLE_PROJECT_ID.TABLE_DATASET_NAME.NEW_TABLE_NAME
CLONE SNAPSHOT_PROJECT_ID.SNAPSHOT_DATASET_NAME.SNAPSHOT_NAME;


다음을 바꿉니다.

  TABLE_PROJECT_ID: 새 테이블을 만들 프로젝트의 프로젝트 ID
  TABLE_DATASET_NAME: 새 테이블을 만들 데이터 세트의 이름
  NEW_TABLE_NAME: 새 테이블 이름
  SNAPSHOT_PROJECT_ID: 복원할 스냅샷이 포함된 프로젝트의 프로젝트 ID
  SNAPSHOT_DATASET_NAME: 복원할 스냅샷이 포함된 데이터 세트의 이름.
  SNAPSHOT_NAME: 복원할 스냅샷의 이름


play_circle 실행을 클릭합니다.




쿼리를 실행하는 방법에 대한 자세한 내용은 대화형 쿼리 실행 [https://cloud.google.com/bigquery/docs/running-queries?hl=ko#queries]을 참조하세요.

--- 탭: bq [https://cloud.google.com/bigquery/docs/table-snapshots-restore?hl=ko#bq] ---
Cloud Shell에 다음 명령어를 입력합니다.

Cloud Shell로 이동 [https://console.cloud.google.com/bigquery?cloudshell=true&hl=ko]

bq cp [https://cloud.google.com/bigquery/docs/reference/bq-cli-reference?hl=ko#bq_cp] \
--restore \
--no_clobber \
SNAPSHOT_PROJECT_ID:SNAPSHOT_DATASET_NAME.SNAPSHOT_NAME \
TABLE_PROJECT_ID:TABLE_DATASET_NAME.NEW_TABLE_NAME

다음을 바꿉니다.

  SNAPSHOT_PROJECT_ID: 복원할 스냅샷이 포함된 프로젝트의 프로젝트 ID
  SNAPSHOT_DATASET_NAME: 복원할 스냅샷이 포함된 데이터 세트의 이름.
  SNAPSHOT_NAME: 복원할 스냅샷의 이름
  TABLE_PROJECT_ID: 새 테이블을 만들 프로젝트의 프로젝트 ID
  TABLE_DATASET_NAME: 새 테이블을 만들 데이터 세트의 이름
  NEW_TABLE_NAME: 새 테이블 이름


--no_clobber 플래그는 대상 테이블이 존재할 경우 명령어가 실패하도록 지시합니다.

--- 탭: API [https://cloud.google.com/bigquery/docs/table-snapshots-restore?hl=ko#api] ---
다음 매개변수를 사용하여 jobs.insert [https://cloud.google.com/bigquery/docs/reference/rest/v2/jobs/insert?hl=ko] 메서드를 호출합니다.




매개변수
값




projectId
이 작업에 대한 요금을 청구할 프로젝트의 프로젝트 ID


요청 본문
{
  "configuration": {
    "copy": {
      "sourceTables": [
        {
          "projectId": "SNAPSHOT_PROJECT_ID",
          "datasetId": "SNAPSHOT_DATASET_NAME",
          "tableId": "SNAPSHOT_NAME"
        }
      ],
      "destinationTable": {
        "projectId": "TABLE_PROJECT_ID",
        "datasetId": "TABLE_DATASET_NAME",
        "tableId": "NEW_TABLE_NAME"
      },
      "operationType": "RESTORE",
      "writeDisposition": "WRITE_EMPTY"
    }
  }
}




다음을 바꿉니다.

  SNAPSHOT_PROJECT_ID: 복원할 스냅샷이 포함된 프로젝트의 프로젝트 ID
  SNAPSHOT_DATASET_NAME: 복원할 스냅샷이 포함된 데이터 세트의 이름.
  SNAPSHOT_NAME: 복원할 스냅샷의 이름
  TABLE_PROJECT_ID: 새 테이블을 만들 프로젝트의 프로젝트 ID
  TABLE_DATASET_NAME: 새 테이블을 만들 데이터 세트의 이름
  NEW_TABLE_NAME: 새 테이블 이름


만료를 지정하지 않으면 대상 테이블은 대상 테이블이 포함된 데이터 세트의 기본 테이블 만료 시간 이후에 만료됩니다.
기존 테이블 덮어쓰기
다음 옵션 중 하나를 사용하여 기존 테이블을 테이블 스냅샷으로 덮어쓸 수 있습니다.
--- 탭: 콘솔 [https://cloud.google.com/bigquery/docs/table-snapshots-restore?hl=ko#%EC%BD%98%EC%86%94] ---
Google Cloud 콘솔에서 BigQuery 페이지로 이동합니다.

BigQuery로 이동 [https://console.cloud.google.com/bigquery?hl=ko] 
탐색기 창에서 복원하려는 테이블 스냅샷의 프로젝트 및 데이터 세트 노드를 펼칩니다.
테이블 스냅샷 이름을 클릭합니다.
표시된 테이블 스냅샷 창에서 복원을 클릭합니다.


표시되는 스냅샷 복원 창에 프로젝트, 데이터 세트, 기존 테이블의 테이블 정보를 입력합니다.
테이블 덮어쓰기(있는 경우)를 선택합니다.
저장을 클릭합니다.

--- 탭: SQL [https://cloud.google.com/bigquery/docs/table-snapshots-restore?hl=ko#sql] ---
CREATE TABLE CLONE DDL 문 [https://cloud.google.com/bigquery/docs/reference/standard-sql/data-definition-language?hl=ko#create_table_clone_statement]을 사용합니다.






Google Cloud 콘솔에서 BigQuery 페이지로 이동합니다.

BigQuery로 이동 [https://console.cloud.google.com/bigquery?hl=ko] 
쿼리 편집기에서 다음 문을 입력합니다.

CREATE OR REPLACE TABLE TABLE_PROJECT_ID.TABLE_DATASET_NAME.TABLE_NAME
CLONE SNAPSHOT_PROJECT_ID.SNAPSHOT_DATASET_NAME.SNAPSHOT_NAME;


다음을 바꿉니다.

  TABLE_PROJECT_ID: 새 테이블을 만들 프로젝트의 프로젝트 ID
  TABLE_DATASET_NAME: 덮어쓰려는 테이블이 포함된 데이터 세트의 이름
  TABLE_NAME: 덮어쓰려는 테이블의 이름
  SNAPSHOT_PROJECT_ID: 복원할 스냅샷이 포함된 프로젝트의 프로젝트 ID
  SNAPSHOT_DATASET_NAME: 복원할 스냅샷이 포함된 데이터 세트의 이름.
  SNAPSHOT_NAME: 복원할 스냅샷의 이름


play_circle 실행을 클릭합니다.




쿼리를 실행하는 방법에 대한 자세한 내용은 대화형 쿼리 실행 [https://cloud.google.com/bigquery/docs/running-queries?hl=ko#queries]을 참조하세요.

--- 탭: bq [https://cloud.google.com/bigquery/docs/table-snapshots-restore?hl=ko#bq] ---
Cloud Shell에 다음 명령어를 입력합니다.

Cloud Shell로 이동 [https://console.cloud.google.com/bigquery?cloudshell=true&hl=ko]

bq cp [https://cloud.google.com/bigquery/docs/reference/bq-cli-reference?hl=ko#bq_cp] \
--restore \
--force \
SNAPSHOT_PROJECT_ID:SNAPSHOT_DATASET_NAME.SNAPSHOT_NAME \
TABLE_PROJECT_ID:TABLE_DATASET_NAME.TABLE_NAME

다음을 바꿉니다.

  SNAPSHOT_PROJECT_ID: 복원할 스냅샷이 포함된 프로젝트의 프로젝트 ID
  SNAPSHOT_DATASET_NAME: 복원할 스냅샷이 포함된 데이터 세트의 이름.
  SNAPSHOT_NAME: 복원할 스냅샷의 이름
  TABLE_PROJECT_ID: 새 테이블을 만들 프로젝트의 프로젝트 ID
  TABLE_DATASET_NAME: 덮어쓰려는 테이블이 포함된 데이터 세트의 이름
  TABLE_NAME: 덮어쓰려는 테이블의 이름

--- 탭: API [https://cloud.google.com/bigquery/docs/table-snapshots-restore?hl=ko#api] ---
다음 매개변수를 사용하여 jobs.insert [https://cloud.google.com/bigquery/docs/reference/rest/v2/jobs/insert?hl=ko] 메서드를 호출합니다.




매개변수
값




projectId
이 작업에 대한 요금을 청구할 프로젝트의 프로젝트 ID


요청 본문
{
  "configuration": {
    "copy": {
      "sourceTables": [
        {
          "projectId": "SNAPSHOT_PROJECT_ID",
          "datasetId": "SNAPSHOT_DATASET_NAME",
          "tableId": "SNAPSHOT_NAME"
        }
      ],
      "destinationTable": {
        "projectId": "TABLE_PROJECT_ID",
        "datasetId": "TABLE_DATASET_NAME",
        "tableId": "TABLE_NAME"
      },
      "operationType": "RESTORE",
      "writeDisposition": "WRITE_TRUNCATE"
    }
  }
}




다음을 바꿉니다.

  SNAPSHOT_PROJECT_ID: 복원할 스냅샷이 포함된 프로젝트의 프로젝트 ID
  SNAPSHOT_DATASET_NAME: 복원할 스냅샷이 포함된 데이터 세트의 이름.
  SNAPSHOT_NAME: 복원할 스냅샷의 이름
  TABLE_PROJECT_ID: 새 테이블을 만들 프로젝트의 프로젝트 ID
  TABLE_DATASET_NAME: 덮어쓰려는 테이블이 포함된 데이터 세트의 이름
  TABLE_NAME: 덮어쓰려는 테이블의 이름


만료를 지정하지 않으면 대상 테이블은 대상 테이블이 포함된 데이터 세트의 기본 테이블 만료 시간 이후에 만료됩니다.
다음 단계
지정된 기본 테이블의 테이블 스냅샷 나열 [https://cloud.google.com/bigquery/docs/table-snapshots-list?hl=ko#list_the_table_snapshots_of_a_specified_base_table]
도움이 되었나요?
의견 보내기