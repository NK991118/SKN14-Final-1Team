Source URL: https://cloud.google.com/bigquery/docs/enable-transfer-service

BigQuery [https://cloud.google.com/bigquery?hl=ko]
Documentation [https://cloud.google.com/bigquery/docs?hl=ko]
가이드 [https://cloud.google.com/bigquery/docs/introduction?hl=ko]
도움이 되었나요?
의견 보내기
이 페이지의 내용
프로젝트 만들기 및 BigQuery API 사용 설정 [https://cloud.google.com/bigquery/docs/enable-transfer-service?hl=ko#enable-api]
BigQuery Data Transfer Service 사용 설정 [https://cloud.google.com/bigquery/docs/enable-transfer-service?hl=ko#enable-dts]
서비스 에이전트 [https://cloud.google.com/bigquery/docs/enable-transfer-service?hl=ko#service_agent]
프로젝트 간 서비스 계정 승인 [https://cloud.google.com/bigquery/docs/enable-transfer-service?hl=ko#cross-project_service_account_authorization]
수동 서비스 에이전트 만들기 [https://cloud.google.com/bigquery/docs/enable-transfer-service?hl=ko#manual_service_agent_creation]
bigquery.admin 액세스 권한 부여 [https://cloud.google.com/bigquery/docs/enable-transfer-service?hl=ko#grant_bigqueryadmin_access]
다음 단계 [https://cloud.google.com/bigquery/docs/enable-transfer-service?hl=ko#whats_next]
BigQuery Data Transfer Service 사용 설정
bookmark_border
BigQuery Data Transfer Service를 이용하려면 프로젝트 소유자 [https://cloud.google.com/iam/docs/understanding-roles?hl=ko#basic]로서 다음 단계를 완료해야 합니다.
프로젝트 만들기 및 BigQuery API 사용 설정
BigQuery Data Transfer Service를 사용하도록 설정합니다.
Identity and Access Management(IAM) 역할에 대한 자세한 내용은 IAM 문서의 역할 이해 [https://cloud.google.com/iam/docs/understanding-roles?hl=ko]를 참조하세요.
참고: BigQuery Data Transfer Service를 프로그래매틱 방식으로 사용 설정 직후 BigQuery Data Transfer Service API를 호출하는 경우 연속 호출 사이에 백오프 지연을 포함하여 재시도 메커니즘을 구현해야 합니다. 이는 API 사용 설정이 비동기적이며 eventual consistency로 인한 전파 지연의 영향을 받기 때문입니다.
프로젝트 만들기 및 BigQuery API 사용 설정
BigQuery Data Transfer Service를 이용하려면 프로젝트를 만들어야 하며, 대부분의 경우 결제를 사용 설정해야 합니다. 기존 프로젝트를 BigQuery Data Transfer Service와 함께 사용하거나 새 프로젝트를 만들 수 있습니다. 기존 프로젝트를 사용한다면 BigQuery API도 사용 설정해야 할 수 있습니다.
프로젝트를 만들고 BigQuery API를 사용 설정하려면 다음 안내를 따르세요.
In the Google Cloud console, go to the project selector page.
Go to project selector [https://console.cloud.google.com/projectselector2/home/dashboard?hl=ko]
Select or create a Google Cloud project.
Note: If you don't plan to keep the resources that you create in this procedure, create a project instead of selecting an existing project. After you finish these steps, you can delete the project, removing all resources associated with the project.
모든 전송의 프로젝트에서 결제를 사용 설정합니다. 무료 전송의 경우 $0가 청구됩니다.
여러 소스에서 데이터를 전송할 경우라도 프로젝트마다 한 번씩만 결제를 사용 설정하면 됩니다. 또한 데이터가 전송된 후 BigQuery에서 데이터를 쿼리할 수 있도록 결제를 사용 설정해야 합니다.
프로젝트에 결제가 사용 설정되어 있는지 확인하는 방법을 알아보세요 [https://cloud.google.com/billing/docs/how-to/modify-project?hl=ko].
BigQuery는 새 프로젝트에서 자동으로 사용 설정됩니다. 기존 프로젝트에서 BigQuery를 활성화하려면 BigQuery API를 사용 설정합니다.

BigQuery API 사용 설정 [https://console.cloud.google.com/apis/library/bigquery.googleapis.com?hl=ko]
BigQuery Data Transfer Service 사용 설정
전송을 만들려면 BigQuery Data Transfer Service를 사용 설정해야 합니다. BigQuery Data Transfer Service를 사용 설정하려면 프로젝트의 소유자 [https://cloud.google.com/iam/docs/understanding-roles?hl=ko#basic] 역할을 부여받아야 합니다.
BigQuery Data Transfer Service를 사용 설정하려면 다음 안내를 따르세요.
API 라이브러리에서 BigQuery Data Transfer API [https://console.cloud.google.com/apis/library/bigquerydatatransfer.googleapis.com?hl=ko] 페이지를 엽니다.
드롭다운 메뉴에서 적절한 프로젝트를 선택합니다.
사용 버튼을 클릭합니다.
Data Transfer API 사용 설정 [https://console.cloud.google.com/apis/library/bigquerydatatransfer.googleapis.com?hl=ko]
서비스 에이전트
BigQuery Data Transfer Service는 서비스 에이전트 [https://cloud.google.com/iam/docs/service-account-types?hl=ko#service-agents]를 사용하여 리소스에 액세스하고 관리합니다. 여기에는 다음 리소스가 포함되며 이에 국한되지 않습니다.
데이터 전송을 승인할 때 사용할 서비스 계정의 액세스 토큰을 검색합니다.
사용 설정된 경우 제공된 Pub/Sub 주제에 알림을 게시합니다.
BigQuery 작업을 시작합니다.
Cloud Storage 이벤트 기반 전송을 위해 제공된 Pub/Sub 구독에서 이벤트 가져오기
BigQuery Data Transfer Service를 사용 설정하고 API를 처음 사용하면 서비스 에이전트가 자동으로 생성됩니다. 서비스 에이전트를 만든 후 Google이 사전 정의된 서비스 에이전트 역할 [https://cloud.google.com/iam/docs/understanding-roles?hl=ko#bigquerydatatransfer.serviceAgent]을 자동으로 부여합니다.
프로젝트 간 서비스 계정 승인
BigQuery Data Transfer Service가 사용 설정된 프로젝트와 다른 프로젝트의 서비스 계정을 사용하여 데이터 전송을 승인할 경우 다음 Google Cloud CLI 명령어를 사용하여 서비스 에이전트에 roles/iam.serviceAccountTokenCreator 역할을 부여해야 합니다.
gcloud iam service-accounts add-iam-policy-binding 
service_account \
--member serviceAccount:service-
project_number@gcp-sa-bigquerydatatransfer.iam.gserviceaccount.com \
--role roles/iam.serviceAccountTokenCreator
각 항목의 의미는 다음과 같습니다.
service_account는 데이터 전송을 승인하는 데 사용되는 프로젝트 간 서비스 계정입니다.
project_number는 BigQuery Data Transfer Service가 사용 설정된 프로젝트의 프로젝트 번호입니다.
프로젝트 간 리소스 구성에 대한 자세한 내용은 Identity and Access Management 서비스 계정 가장 문서에서 다른 프로젝트의 리소스에 대한 구성 [https://cloud.google.com/iam/docs/attach-service-accounts?hl=ko#attaching-different-project]을 참조하세요.
수동 서비스 에이전트 만들기
서비스 에이전트에 추가 역할을 부여해야 할 때와 같이 API와 상호 작용하기 전 서비스 에이전트 만들기를 트리거하려면 다음 접근 방법 중 하나를 사용할 수 있습니다.
API: services.GenerateServiceIdentity [https://cloud.google.com/service-usage/docs/reference/rest/v1beta1/services/generateServiceIdentity?hl=ko]
gcloud CLI: gcloud beta services identity create [https://cloud.google.com/sdk/gcloud/reference/beta/services/identity/create?hl=ko]
Terraform 제공업체: google_project_service_identity [https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/project_service_identity]
서비스 에이전트 만들기를 수동으로 트리거하면 Google이 사전 정의된 서비스 에이전트 역할 [https://cloud.google.com/iam/docs/understanding-roles?hl=ko#bigquerydatatransfer.serviceAgent]을 자동으로 부여하지 않습니다. 다음 Google Cloud CLI 명령어를 사용하여 사전 정의된 역할을 서비스 에이전트에 수동으로 부여해야 합니다.
gcloud projects add-iam-policy-binding 
project_number \
--member serviceAccount:service-
project_number@gcp-sa-bigquerydatatransfer.iam.gserviceaccount.com \
--role roles/bigquerydatatransfer.serviceAgent
각 항목의 의미는 다음과 같습니다.
project_number는 BigQuery Data Transfer Service가 사용 설정된 프로젝트의 프로젝트 번호입니다.
경고: 서비스 에이전트에서 서비스 에이전트 역할을 취소하지 마세요. 역할을 취소하면 BigQuery Data Transfer Service가 더 이상 작동하지 않습니다.
bigquery.admin 액세스 권한 부여
BigQuery Data Transfer Service 전송을 만드는 사용자에게 사전 정의된 IAM 역할 bigquery.admin을 부여하는 것이 좋습니다. bigquery.admin 역할에는 가장 일반적인 태스크를 수행하는 데 필요한 IAM 권한이 포함되어 있습니다. bigquery.admin 역할에는 다음과 같은 BigQuery Data Transfer Service 권한이 포함됩니다.
BigQuery Data Transfer Service 권한:
bigquery.transfers.update
bigquery.transfers.get
BigQuery 권한:
bigquery.datasets.get
bigquery.datasets.update
bigquery.jobs.create
참고: 만약 bigquery.admin 역할이 특정 사용 사례에 대해 너무 광범위한 경우 필요한 권한만 보유한 커스텀 IAM 역할을 만들 [https://cloud.google.com/iam/docs/creating-custom-roles?hl=ko] 수 있습니다.
경우에 따라 데이터 소스마다 필요한 권한이 다를 수 있습니다. 각 데이터 소스 전송 가이드의 '필요한 권한' 섹션에서 구체적인 IAM 정보를 참조하세요. 예를 들어 Amazon S3 전송 권한 [https://cloud.google.com/bigquery/docs/s3-transfer?hl=ko#required_permissions] 또는 Cloud Storage 전송 권한 [https://cloud.google.com/bigquery/docs/cloud-storage-transfer?hl=ko#required_permissions]을 참조하세요.
bigquery.admin 역할 부여:
--- 탭: 콘솔 [https://cloud.google.com/bigquery/docs/enable-transfer-service?hl=ko#%EC%BD%98%EC%86%94] ---
Google Cloud 콘솔에서 IAM 페이지를 엽니다.IAM 페이지 열기 [https://console.cloud.google.com/iam-admin/iam?hl=ko] 
프로젝트 선택을 클릭합니다.
프로젝트를 선택하고 열기를 클릭합니다.
추가를 클릭해 프로젝트에 새 구성원을 추가하고 권한을 설정합니다.
구성원 추가 대화상자에서


구성원에 사용자나 그룹의 이메일 주소를 입력합니다.
역할 선택 드롭다운에서 BigQuery > BigQuery 관리자를 클릭합니다.
추가를 클릭합니다.

--- 탭: gcloud [https://cloud.google.com/bigquery/docs/enable-transfer-service?hl=ko#gcloud] ---
Google Cloud CLI를 사용하여 사용자 또는 그룹에 bigquery.admin 역할을 부여할 수 있습니다.









  참고:
  
  외부 ID 공급업체 [https://cloud.google.com/iam/docs/workforce-identity-federation?hl=ko]에서 사용자의 액세스 권한을 관리할 때는 user:kiran@example.com, group:support@example.com, domain:example.com과 같은 Google 계정 주 구성원 식별자의 인스턴스를 적절한 직원 ID 제휴 주 구성원 식별자 [https://cloud.google.com/iam/docs/principal-identifiers?hl=ko]로 바꿉니다.
 







프로젝트의 IAM 정책에 하나의 binding을 추가하려면 다음 명령어를 입력합니다. 사용자를 추가하려면 --member 플래그를 user:user@example.com 형식으로 지정합니다. 그룹을 추가하려면 --member 플래그를 group:group@example.com 형식으로 지정합니다.

gcloud projects add-iam-policy-binding project_id \
--member principal:address \
--role roles/bigquery.admin

각 항목의 의미는 다음과 같습니다.


project_id는 프로젝트 ID입니다.
principal는 group 또는 user입니다.
address는 사용자 또는 그룹의 이메일 주소입니다.


예를 들면 다음과 같습니다.
gcloud projects add-iam-policy-binding myproject \
--member group:group@example.com \
--role roles/bigquery.admin

명령어를 실행하면 업데이트된 정책이 출력됩니다.
        bindings:
    - members:
      - group:group@example.com
        role: roles/bigquery.admin
BigQuery의 IAM 역할에 대한 자세한 내용은 사전 정의된 역할 및 권한 [https://cloud.google.com/bigquery/access-control?hl=ko]을 참조하세요.
다음 단계
BigQuery Data Transfer Service를 사용 설정하고 나면 데이터 소스의 전송을 만듭니다.
Amazon S3 [https://cloud.google.com/bigquery/docs/s3-transfer?hl=ko]
Amazon Redshift [https://cloud.google.com/bigquery/docs/migration/redshift?hl=ko]
Azure Blob Storage [https://cloud.google.com/bigquery/docs/blob-storage-transfer?hl=ko]
Campaign Manager [https://cloud.google.com/bigquery/docs/doubleclick-campaign-transfer?hl=ko]
Cloud Storage [https://cloud.google.com/bigquery/docs/cloud-storage-transfer?hl=ko]
비교 쇼핑 서비스(CSS) 센터 [https://cloud.google.com/bigquery/docs/css-center-transfer-schedule-transfers?hl=ko](프리뷰 [https://cloud.google.com/products?hl=ko#product-launch-stages])
Display & Video 360 [https://cloud.google.com/bigquery/docs/display-video-transfer?hl=ko]
Facebook 광고 [https://cloud.google.com/bigquery/docs/facebook-ads-transfer?hl=ko](미리보기 [https://cloud.google.com/products?hl=ko#product-launch-stages])
Google Ad Manager [https://cloud.google.com/bigquery/docs/doubleclick-publisher-transfer?hl=ko]
Google Ads [https://cloud.google.com/bigquery/docs/google-ads-transfer?hl=ko]
Google 애널리틱스 4 [https://cloud.google.com/bigquery/docs/google-analytics-4-transfer?hl=ko](프리뷰 [https://cloud.google.com/products?hl=ko#product-launch-stages])
Google 판매자 센터 [https://cloud.google.com/bigquery/docs/merchant-center-transfer?hl=ko](미리보기 [https://cloud.google.com/products?hl=ko#product-launch-stages])
Google Play [https://cloud.google.com/bigquery/docs/play-transfer?hl=ko]
MySQL [https://cloud.google.com/bigquery/docs/mysql-transfer?hl=ko](프리뷰 [https://cloud.google.com/products?hl=ko#product-launch-stages])
Oracle [https://cloud.google.com/bigquery/docs/oracle-transfer?hl=ko](미리보기 [https://cloud.google.com/products?hl=ko#product-launch-stages])
PostgreSQL [https://cloud.google.com/bigquery/docs/postgresql-transfer?hl=ko](프리뷰 [https://cloud.google.com/products?hl=ko#product-launch-stages])
Salesforce [https://cloud.google.com/bigquery/docs/salesforce-transfer?hl=ko](미리보기 [https://cloud.google.com/products?hl=ko#product-launch-stages])
Salesforce Marketing Cloud [https://cloud.google.com/bigquery/docs/sfmc-transfer?hl=ko](미리보기 [https://cloud.google.com/products?hl=ko#product-launch-stages])
Search Ads 360 [https://cloud.google.com/bigquery/docs/search-ads-transfer?hl=ko]
ServiceNow [https://cloud.google.com/bigquery/docs/servicenow-transfer?hl=ko](미리보기 [https://cloud.google.com/products?hl=ko#product-launch-stages])
Teradata [https://cloud.google.com/bigquery/docs/migration/teradata?hl=ko]
YouTube 채널 [https://cloud.google.com/bigquery/docs/youtube-channel-transfer?hl=ko]
YouTube 콘텐츠 소유자 [https://cloud.google.com/bigquery/docs/youtube-content-owner-transfer?hl=ko]
도움이 되었나요?
의견 보내기