Source URL: https://cloud.google.com/bigquery/docs/reservations-assignments

이 페이지는 Cloud Translation API [https://cloud.google.com/translate/?hl=ko]를 통해 번역되었습니다.
Switch to English
BigQuery [https://cloud.google.com/bigquery?hl=ko]
Documentation [https://cloud.google.com/bigquery/docs?hl=ko]
가이드 [https://cloud.google.com/bigquery/docs/introduction?hl=ko]
도움이 되었나요?
의견 보내기
이 페이지의 내용
예약 할당 만들기 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#create_reservation_assignments]
필수 권한 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#required_permissions]
예약에 조직 할당 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#assign-organization]
예약에 프로젝트 또는 폴더 할당 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#assign_my_prod_project_to_prod_reservation]
none에 프로젝트 할당 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#assign-project-to-none]
쿼리에서 예약 재정의 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#reservation]
BigQuery ML 워크로드에 슬롯 할당 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#assign-ml-workload]
예약 할당 찾기 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#find_reservation_assignments]
예약 할당 작업
bookmark_border
BigQuery Reservation API를 사용하면 전용 슬롯(약정 [https://cloud.google.com/bigquery/docs/reservations-intro?hl=ko#commitments])을 구입하고, 슬롯 풀(예약 [https://cloud.google.com/bigquery/docs/reservations-intro?hl=ko#reservations])을 만들고, 이러한 예약에 프로젝트, 폴더, 조직을 할당할 수 있습니다.
예약 할당 만들기
구매한 슬롯을 사용하려면 프로젝트, 폴더 또는 조직을 슬롯 예약에 배정하는 할당을 만듭니다. 할당 수준에서 특정 수의 슬롯을 할당할 수 없습니다. 슬롯은 예약 수준에서 관리되고 할당됩니다.
프로젝트는 리소스 계층 구조에서 자신에게 적용된 가장 구체적인 단일 예약을 사용합니다. 조직 할당보다는 폴더 할당이 우선 적용되고, 폴더 할당보다는 프로젝트 할당이 우선 적용됩니다. Standard 버전 [https://cloud.google.com/bigquery/docs/editions-intro?hl=ko] 예약에서는 폴더 및 조직 할당을 사용할 수 없습니다.
예약에 할당을 만들려면 예약이 다음 기준 중 하나 이상을 충족해야 합니다.
할당된 기준 슬롯 수가 0이 아닌 값으로 구성되어야 함
0이 아닌 수의 자동 확장 슬롯으로 구성되어야 함
유휴 슬롯을 사용하도록 구성되며 프로젝트 내에 사용 가능한 유휴 슬롯이 있음
이러한 기준 중 하나 이상을 충족하지 않는 예약에 리소스를 할당하려고 시도하면 Assignment is pending, your project will be executed as on-demand. 메시지가 표시됩니다.
장애 조치 예약 [https://cloud.google.com/bigquery/docs/managed-disaster-recovery?hl=ko]에 리소스를 할당할 수 있지만 할당이 보조 위치에서 대기합니다.
필수 권한
예약 할당을 만들려면 다음 Identity and Access Management(IAM) 권한이 필요합니다.
관리 프로젝트 [https://cloud.google.com/bigquery/docs/reservations-workload-management?hl=ko#admin-project] 및 할당된 담당자에 대한 bigquery.reservationAssignments.create 권한
사전 정의된 다음의 각 IAM 역할에는 이 권한이 포함되어 있습니다.
BigQuery Admin
BigQuery Resource Admin
BigQuery Resource Editor
BigQuery에서 IAM 역할에 대한 상세 설명은 사전 정의된 역할 및 권한 [https://cloud.google.com/bigquery/docs/access-control?hl=ko]을 참조하세요.
예약에 조직 할당
--- 탭: 콘솔 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#%EC%BD%98%EC%86%94] ---
Google Cloud 콘솔에서 BigQuery 페이지로 이동합니다.

BigQuery로 이동 [https://console.cloud.google.com/bigquery?hl=ko] 
탐색 메뉴에서 용량 관리를 클릭합니다.
예약 탭을 클릭합니다.
예약 표에서 예약을 찾습니다.
more_vert
작업 옵션을 확장합니다.
할당 만들기를 클릭합니다.
할당 만들기 섹션에서 찾아보기를 클릭합니다.
조직을 찾아보거나 검색하고 선택합니다.
작업 유형 섹션에서 이 예약에 할당할 작업 유형을 선택합니다. 옵션은 다음과 같습니다.


QUERY
CONTINUOUS
PIPELINE
BACKGROUND
ML_EXTERNAL


작업 유형에 대한 자세한 내용은 예약 할당 [https://cloud.google.com/bigquery/docs/reservations-intro?hl=ko#assignments]을 참고하세요.
이 기본값은 QUERY입니다.

사용자가 Enterprise Plus 버전 할당으로 BigQuery의 Gemini를 사용할 수 있도록 허용하는 방법을 자세히 알아보려면 BigQuery의 Gemini 설정 [https://cloud.google.com/gemini/docs/bigquery/set-up-gemini?hl=ko]을 참고하세요.
만들기를 클릭합니다.

--- 탭: SQL [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#sql] ---
조직을 예약에 할당 삭제하려면 CREATE ASSIGNMENT DDL 문 [https://cloud.google.com/bigquery/docs/reference/standard-sql/data-definition-language?hl=ko#create_assignment_statement]을 사용합니다.






 Google Cloud 콘솔에서 BigQuery 페이지로 이동합니다.

BigQuery로 이동 [https://console.cloud.google.com/bigquery?hl=ko] 
쿼리 편집기에서 다음 문을 입력합니다.

CREATE ASSIGNMENT
  `ADMIN_PROJECT_ID.region-LOCATION.RESERVATION_NAME.ASSIGNMENT_ID`
OPTIONS (
  assignee = 'organizations/ORGANIZATION_ID',
  job_type = 'JOB_TYPE');


다음을 바꿉니다.

  ADMIN_PROJECT_ID: 예약 리소스를 소유하는 관리 프로젝트 [https://cloud.google.com/bigquery/docs/reservations-workload-management?hl=ko#admin-project]의 프로젝트 ID
  LOCATION: 예약 위치 [https://cloud.google.com/bigquery/docs/locations?hl=ko]
  RESERVATION_NAME: 예약 이름
  ASSIGNMENT_ID: 할당 ID.
    ID는 프로젝트 및 위치에 고유해야 하고, 소문자 또는 숫자로 시작하고 끝나야 하고, 소문자, 숫자, 대시만 포함해야 합니다.
  ORGANIZATION_ID: 조직 ID [https://cloud.google.com/resource-manager/docs/creating-managing-organization?hl=ko#retrieving_your_organization_id]
  JOB_TYPE: QUERY, CONTINUOUS, PIPELINE, BACKGROUND, ML_EXTERNAL과 같이 이 예약에 할당할 작업 유형 [https://cloud.google.com/bigquery/docs/reservations-intro?hl=ko#assignments]입니다.


play_circle 실행을 클릭합니다.




쿼리를 실행하는 방법에 대한 자세한 내용은 대화형 쿼리 실행 [https://cloud.google.com/bigquery/docs/running-queries?hl=ko#queries]을 참조하세요.

--- 탭: bq [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#bq] ---
조직의 작업을 예약에 할당하려면 bq mk 명령어를 --reservation_assignment 플래그와 함께 사용합니다.

bq mk \
    --project_id=ADMIN_PROJECT_ID \
    --location=LOCATION \
    --reservation_assignment \
    --reservation_id=RESERVATION_NAME \
    --assignee_id=ORGANIZATION_ID \
    --job_type=JOB_TYPE \
    --assignee_type=ORGANIZATION


다음을 바꿉니다.


ADMIN_PROJECT_ID: 예약 리소스를 소유하는 관리 프로젝트 [https://cloud.google.com/bigquery/docs/reservations-workload-management?hl=ko#admin-project]의 프로젝트 ID
LOCATION: 예약 위치 [https://cloud.google.com/bigquery/docs/locations?hl=ko]
RESERVATION_NAME: 예약 이름
ORGANIZATION_ID: 조직 ID [https://cloud.google.com/resource-manager/docs/creating-managing-organization?hl=ko#retrieving_your_organization_id]입니다.
JOB_TYPE: QUERY, CONTINUOUS, PIPELINE, BACKGROUND, ML_EXTERNAL과 같이 이 예약에 할당할 작업 유형 [https://cloud.google.com/bigquery/docs/reservations-intro?hl=ko#assignments]입니다.
예약 할당을 만들 때는 쿼리를 실행하기 전 최소 5분 이상 기다립니다. 그렇지 않으면 주문형 가격 책정을 사용하여 쿼리가 청구될 수 있습니다.
예약에 프로젝트 또는 폴더 할당
--- 탭: 콘솔 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#%EC%BD%98%EC%86%94] ---
Google Cloud 콘솔에서 BigQuery 페이지로 이동합니다.

BigQuery로 이동 [https://console.cloud.google.com/bigquery?hl=ko] 
탐색 메뉴에서 용량 관리를 클릭합니다.
예약 탭을 클릭합니다.
예약 표에서 예약을 찾습니다.
more_vert
작업 옵션을 확장합니다.
할당 만들기를 클릭합니다.
할당 만들기 섹션에서 찾아보기를 클릭합니다.
프로젝트 또는 폴더를 찾아보거나 검색하고 선택합니다.
작업 유형 섹션에서 이 예약에 할당할 작업 유형을 선택합니다. 옵션은 다음과 같습니다.


QUERY
CONTINUOUS
PIPELINE
BACKGROUND
ML_EXTERNAL


작업 유형에 대한 자세한 내용은 예약 할당 [https://cloud.google.com/bigquery/docs/reservations-intro?hl=ko#assignments]을 참고하세요.
이 기본값은 QUERY입니다.
만들기를 클릭합니다.

--- 탭: SQL [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#sql] ---
예약에 프로젝트를 할당하려면 CREATE ASSIGNMENT DDL 문 [https://cloud.google.com/bigquery/docs/reference/standard-sql/data-definition-language?hl=ko#create_assignment_statement]을 사용합니다.






 Google Cloud 콘솔에서 BigQuery 페이지로 이동합니다.

BigQuery로 이동 [https://console.cloud.google.com/bigquery?hl=ko] 
쿼리 편집기에서 다음 문을 입력합니다.

CREATE ASSIGNMENT
  `ADMIN_PROJECT_ID.region-LOCATION.RESERVATION_NAME.ASSIGNMENT_ID`
OPTIONS(
  assignee="projects/PROJECT_ID",
  job_type="JOB_TYPE");


다음을 바꿉니다.

  ADMIN_PROJECT_ID: 예약 리소스를 소유하는 관리 프로젝트 [https://cloud.google.com/bigquery/docs/reservations-workload-management?hl=ko#admin-project]의 프로젝트 ID
  LOCATION: 예약 위치 [https://cloud.google.com/bigquery/docs/locations?hl=ko]
  RESERVATION_NAME: 예약 이름
  ASSIGNMENT_ID: 할당 ID.
    ID는 프로젝트 및 위치에 고유해야 하고, 소문자 또는 숫자로 시작하고 끝나야 하고, 소문자, 숫자, 대시만 포함해야 합니다.
  PROJECT_ID: 예약에 할당할 프로젝트의 ID입니다.
  JOB_TYPE: QUERY, CONTINUOUS, PIPELINE, BACKGROUND, ML_EXTERNAL과 같이 이 예약에 할당할 작업 유형 [https://cloud.google.com/bigquery/docs/reservations-intro?hl=ko#assignments]입니다.


play_circle 실행을 클릭합니다.




쿼리를 실행하는 방법에 대한 자세한 내용은 대화형 쿼리 실행 [https://cloud.google.com/bigquery/docs/running-queries?hl=ko#queries]을 참조하세요.

--- 탭: bq [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#bq] ---
작업을 예약에 할당하려면 bq mk 명령어를 --reservation_assignment 플래그와 함께 사용합니다.

bq mk \
    --project_id=ADMIN_PROJECT_ID \
    --location=LOCATION \
    --reservation_assignment \
    --reservation_id=RESERVATION_NAME \
    --assignee_id=PROJECT_ID \
    --job_type=JOB_TYPE \
    --assignee_type=PROJECT


다음을 바꿉니다.


ADMIN_PROJECT_ID: 예약 리소스를 소유하는 관리 프로젝트 [https://cloud.google.com/bigquery/docs/reservations-workload-management?hl=ko#admin-project]의 프로젝트 ID
LOCATION: 예약 위치 [https://cloud.google.com/bigquery/docs/locations?hl=ko]
RESERVATION_NAME: 예약 이름
PROJECT_ID: 이 예약에 할당할 프로젝트의 ID입니다.
JOB_TYPE: QUERY, CONTINUOUS, PIPELINE, BACKGROUND, ML_EXTERNAL과 같이 이 예약에 할당할 작업 유형 [https://cloud.google.com/bigquery/docs/reservations-intro?hl=ko#assignments]입니다.

--- 탭: Terraform [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#terraform] ---
google_bigquery_reservation_assignment [https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/bigquery_reservation_assignment] 리소스를 사용합니다.
참고: Terraform을 사용해서 BigQuery 객체를 만들려면 Cloud Resource Manager API [https://cloud.google.com/resource-manager/reference/rest?hl=ko]를 사용 설정해야 합니다.
BigQuery에 인증하려면 애플리케이션 기본 사용자 인증 정보를 설정합니다. 자세한 내용은 클라이언트 라이브러리의 인증 설정 [https://cloud.google.com/bigquery/docs/authentication?hl=ko#client-libs]을 참조하세요.

다음 예에서는 my-reservation이라는 예약에 프로젝트를 할당합니다.






















  





  
    
  
  



















  




  



  


  resource "google_bigquery_reservation" "default" {
  name              = "my-reservation"
  location          = "us-central1"
  slot_capacity     = 100
  edition           = "ENTERPRISE"
  ignore_idle_slots = false # Use idle slots from other reservations
  concurrency       = 0     # Automatically adjust query concurrency based on available resources
  autoscale {
    max_slots = 200 # Allow the reservation to scale up to 300 slots (slot_capacity + max_slots) if needed
  }
}

data "google_project" "project" {}

resource "google_bigquery_reservation_assignment" "default" {
  assignee    = "projects/${data.google_project.project.project_id}"
  job_type    = "QUERY"
  reservation = google_bigquery_reservation.default.id
}





























프로젝트에 Terraform 구성을 적용하려면 Google Cloud 다음 섹션의 단계를 완료하세요.
Cloud Shell 준비

  Cloud Shell [https://shell.cloud.google.com/?hl=ko]을 실행합니다.
  
    Terraform 구성을 적용할 기본 Google Cloud 프로젝트를 설정합니다.
    이 명령어는 프로젝트당 한 번만 실행하면 되며 어떤 디렉터리에서도 실행할 수 있습니다.
    export GOOGLE_CLOUD_PROJECT=PROJECT_ID
    Terraform 구성 파일에서 명시적 값을 설정하면 환경 변수가 재정의됩니다.
  

디렉터리 준비
각 Terraform 구성 파일에는 자체 디렉터리(루트 모듈이라고도 함)가 있어야 합니다.

  
    Cloud Shell [https://shell.cloud.google.com/?hl=ko]에서 디렉터리를 만들고 해당 디렉터리 내에 새 파일을 만드세요. 파일 이름에는 .tf 확장자가 있어야 합니다(예: main.tf). 이 튜토리얼에서는 파일을 main.tf라고 합니다.
    mkdir DIRECTORY && cd DIRECTORY && touch main.tf
  
  
    튜토리얼을 따라 하는 경우 각 섹션이나 단계에서 샘플 코드를 복사할 수 있습니다.
    샘플 코드를 새로 만든 main.tf에 복사합니다.
    필요한 경우 GitHub에서 코드를 복사합니다. 이는 Terraform 스니펫이 엔드 투 엔드 솔루션의 일부인 경우에 권장됩니다.
    
  
  환경에 적용할 샘플 파라미터를 검토하고 수정합니다.
  변경사항을 저장합니다.
  
    Terraform을 초기화합니다. 이 작업은 디렉터리당 한 번만 수행하면 됩니다.
    terraform init
    원하는 경우 최신 Google 공급업체 버전을 사용하려면 -upgrade 옵션을 포함합니다.
    
    terraform init -upgrade
  

변경사항 적용

  
    구성을 검토하고 Terraform에서 만들거나 업데이트할 리소스가 예상과 일치하는지 확인합니다.
    terraform plan
    필요에 따라 구성을 수정합니다.
  
  
    다음 명령어를 실행하고 프롬프트에 yes를 입력하여 Terraform 구성을 적용합니다.
    terraform apply
    Terraform에 '적용 완료' 메시지가 표시될 때까지 기다립니다.
  
  결과를 보려면 Google Cloud 프로젝트 [https://console.cloud.google.com/?hl=ko]를 엽니다. Google Cloud 콘솔에서 UI의 리소스로 이동하여 Terraform이 리소스를 만들었거나 업데이트했는지 확인합니다.
  

참고: Terraform 샘플은 일반적으로 필요한 API가 Google Cloud 프로젝트에서 사용 설정되었다고 가정합니다.
예약 할당을 만들 때는 쿼리를 실행하기 전 최소 5분 이상 기다립니다. 그렇지 않으면 주문형 가격 책정을 사용하여 쿼리가 청구될 수 있습니다.
유휴 슬롯 [https://cloud.google.com/bigquery/docs/slots?hl=ko#idle_slots]만 사용하는 프로젝트를 만들려면 0 슬롯이 할당된 예약을 만들고 [https://cloud.google.com/bigquery/docs/reservations-tasks?hl=ko#create_reservations] 이전 단계를 따라 프로젝트를 예약에 할당합니다.
참고: 프로젝트는 단일 리전에서 최대 1개의 예약에 할당될 수 있습니다.
none에 프로젝트 할당
none 할당은 할당이 없음을 나타냅니다. none에 할당된 프로젝트는 주문형 가격 책정을 사용합니다.
참고: none 할당은 QUERY 작업에만 지원됩니다.
--- 탭: SQL [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#sql] ---
none에 프로젝트를 할당하려면 CREATE ASSIGNMENT DDL 문 [https://cloud.google.com/bigquery/docs/reference/standard-sql/data-definition-language?hl=ko#create_assignment_statement]을 사용합니다.






 Google Cloud 콘솔에서 BigQuery 페이지로 이동합니다.

BigQuery로 이동 [https://console.cloud.google.com/bigquery?hl=ko] 
쿼리 편집기에서 다음 문을 입력합니다.

CREATE ASSIGNMENT
  `ADMIN_PROJECT_ID.region-LOCATION.none.ASSIGNMENT_ID`
OPTIONS(
  assignee="projects/PROJECT_ID",
  job_type="QUERY");


다음을 바꿉니다.

  LOCATION: 주문형 가격 책정을 사용하는 작업의 위치 [https://cloud.google.com/bigquery/docs/locations?hl=ko]입니다.
  ASSIGNMENT_ID: 할당 ID.
    ID는 프로젝트 및 위치에 고유해야 하고, 소문자 또는 숫자로 시작하고 끝나야 하고, 소문자, 숫자, 대시만 포함해야 합니다.
  PROJECT_ID: 예약에 할당할 프로젝트의 ID


play_circle 실행을 클릭합니다.




쿼리를 실행하는 방법에 대한 자세한 내용은 대화형 쿼리 실행 [https://cloud.google.com/bigquery/docs/running-queries?hl=ko#queries]을 참조하세요.

--- 탭: bq [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#bq] ---
프로젝트를 none에 할당하려면 bq mk 명령어를 --reservation_assignment 플래그와 함께 사용합니다.

bq mk \
    --location=LOCATION \
    --reservation_assignment \
    --reservation_id=none \
    --job_type=QUERY \
    --assignee_id=PROJECT_ID \
    --assignee_type=PROJECT


다음을 바꿉니다.


LOCATION: 주문형 가격 책정을 사용하는 작업의 위치 [https://cloud.google.com/bigquery/docs/locations?hl=ko]
PROJECT_ID: none에 할당할 프로젝트의 ID

--- 탭: Terraform [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#terraform] ---
google_bigquery_reservation_assignment [https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/bigquery_reservation_assignment] 리소스를 사용합니다.
참고: Terraform을 사용해서 BigQuery 객체를 만들려면 Cloud Resource Manager API [https://cloud.google.com/resource-manager/reference/rest?hl=ko]를 사용 설정해야 합니다.
BigQuery에 인증하려면 애플리케이션 기본 사용자 인증 정보를 설정합니다. 자세한 내용은 클라이언트 라이브러리의 인증 설정 [https://cloud.google.com/bigquery/docs/authentication?hl=ko#client-libs]을 참조하세요.

다음 예에서는 none에 프로젝트를 할당합니다.






















  





  
    
  
  



















  




  



  


  data "google_project" "project" {}

resource "google_bigquery_reservation_assignment" "default" {
  assignee    = "projects/${data.google_project.project.project_id}"
  job_type    = "QUERY"
  reservation = "projects/${data.google_project.project.project_id}/locations/us/reservations/none"
}





























프로젝트에 Terraform 구성을 적용하려면 Google Cloud 다음 섹션의 단계를 완료하세요.
Cloud Shell 준비

  Cloud Shell [https://shell.cloud.google.com/?hl=ko]을 실행합니다.
  
    Terraform 구성을 적용할 기본 Google Cloud 프로젝트를 설정합니다.
    이 명령어는 프로젝트당 한 번만 실행하면 되며 어떤 디렉터리에서도 실행할 수 있습니다.
    export GOOGLE_CLOUD_PROJECT=PROJECT_ID
    Terraform 구성 파일에서 명시적 값을 설정하면 환경 변수가 재정의됩니다.
  

디렉터리 준비
각 Terraform 구성 파일에는 자체 디렉터리(루트 모듈이라고도 함)가 있어야 합니다.

  
    Cloud Shell [https://shell.cloud.google.com/?hl=ko]에서 디렉터리를 만들고 해당 디렉터리 내에 새 파일을 만드세요. 파일 이름에는 .tf 확장자가 있어야 합니다(예: main.tf). 이 튜토리얼에서는 파일을 main.tf라고 합니다.
    mkdir DIRECTORY && cd DIRECTORY && touch main.tf
  
  
    튜토리얼을 따라 하는 경우 각 섹션이나 단계에서 샘플 코드를 복사할 수 있습니다.
    샘플 코드를 새로 만든 main.tf에 복사합니다.
    필요한 경우 GitHub에서 코드를 복사합니다. 이는 Terraform 스니펫이 엔드 투 엔드 솔루션의 일부인 경우에 권장됩니다.
    
  
  환경에 적용할 샘플 파라미터를 검토하고 수정합니다.
  변경사항을 저장합니다.
  
    Terraform을 초기화합니다. 이 작업은 디렉터리당 한 번만 수행하면 됩니다.
    terraform init
    원하는 경우 최신 Google 공급업체 버전을 사용하려면 -upgrade 옵션을 포함합니다.
    
    terraform init -upgrade
  

변경사항 적용

  
    구성을 검토하고 Terraform에서 만들거나 업데이트할 리소스가 예상과 일치하는지 확인합니다.
    terraform plan
    필요에 따라 구성을 수정합니다.
  
  
    다음 명령어를 실행하고 프롬프트에 yes를 입력하여 Terraform 구성을 적용합니다.
    terraform apply
    Terraform에 '적용 완료' 메시지가 표시될 때까지 기다립니다.
  
  결과를 보려면 Google Cloud 프로젝트 [https://console.cloud.google.com/?hl=ko]를 엽니다. Google Cloud 콘솔에서 UI의 리소스로 이동하여 Terraform이 리소스를 만들었거나 업데이트했는지 확인합니다.
  

참고: Terraform 샘플은 일반적으로 필요한 API가 Google Cloud 프로젝트에서 사용 설정되었다고 가정합니다.
쿼리에서 예약 재정의
프리뷰
이 제품 또는 기능에는 서비스별 약관 [https://cloud.google.com/terms/service-terms?hl=ko#1]의 일반 서비스 약관 섹션에 있는 'GA 이전 제공 서비스 약관'이 적용됩니다. GA 이전 제품 및 기능은 '있는 그대로' 제공되며 지원이 제한될 수 있습니다. 자세한 내용은 출시 단계 설명 [https://cloud.google.com/products?hl=ko#product-launch-stages]을 참조하세요.
이 기능에 대한 지원을 요청하거나 의견을 제공하려면 bigquery-wlm-feedback@google.com [mailto:bigquery-wlm-feedback@google.com]으로 문의하세요.
쿼리에서 특정 예약을 사용하려면 다음 Identity and Access Management (IAM) 권한이 필요합니다.
예약 또는 관리 프로젝트 [https://cloud.google.com/bigquery/docs/reservations-workload-management?hl=ko#admin-project]에 대한 bigquery.reservations.use 권한
특정 예약에서 실행할 쿼리를 할당하려면 다음 중 하나를 수행하세요.
--- 탭: 콘솔 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#%EC%BD%98%EC%86%94] ---
BigQuery 페이지로 이동합니다.

BigQuery로 이동 [https://console.cloud.google.com/bigquery?hl=ko] 
add_box SQL 쿼리를 클릭합니다.
쿼리 편집기에서 유효한 GoogleSQL 쿼리를 입력합니다.
settings 더보기를 클릭한 다음 쿼리 설정을 클릭합니다.
자동 위치 설정 체크박스를 선택 해제한 다음 예약이 있는 리전 또는 멀티 리전을 선택합니다.
예약 목록에서 쿼리를 실행할 예약을 선택합니다.
저장을 클릭합니다.
편집기 탭에서 쿼리를 작성하고 실행합니다 [https://cloud.google.com/bigquery/docs/running-queries?hl=ko]. 쿼리가 지정한 예약에서 실행됩니다.

--- 탭: SQL [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#sql] ---
@@reservation 시스템 변수를 사용하여 쿼리가 실행되는 예약 리소스를 할당할 수 있습니다.






 Google Cloud 콘솔에서 BigQuery 페이지로 이동합니다.

BigQuery로 이동 [https://console.cloud.google.com/bigquery?hl=ko] 
쿼리 편집기에서 다음 문을 입력합니다.

SET @@reservation='RESERVATION';
SELECT QUERY;



다음을 바꿉니다.


RESERVATION: 쿼리를 실행할 예약입니다.
QUERY: 실행할 쿼리입니다.



play_circle 실행을 클릭합니다.




쿼리를 실행하는 방법에 대한 자세한 내용은 대화형 쿼리 실행 [https://cloud.google.com/bigquery/docs/running-queries?hl=ko#queries]을 참조하세요.

예를 들어 다음 쿼리는 SET [https://cloud.google.com/bigquery/docs/reference/standard-sql/procedural-language?hl=ko#set] 문을 사용하여 US 멀티 리전에서 test-reservation로 예약을 설정한 다음 기본 쿼리를 호출합니다.

SET @@reservation='projects/project1/locations/US/reservations/test-reservation';
SELECT 42;

--- 탭: bq [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#bq] ---
In the Google Cloud console, activate Cloud Shell.
    Activate Cloud Shell [https://console.cloud.google.com/?cloudshell=true&hl=ko]
    
      At the bottom of the Google Cloud console, a
      Cloud Shell [https://cloud.google.com/shell/docs/how-cloud-shell-works?hl=ko]
      session starts and displays a command-line prompt. Cloud Shell is a shell environment
      with the Google Cloud CLI
      already installed and with values already set for
      your current project. It can take a few seconds for the session to initialize.
    
    
  










Cloud Shell에서 --reservation_id 플래그와 함께 bq query 명령어 [https://cloud.google.com/bigquery/docs/reference/bq-cli-reference?hl=ko#bq_query]를 사용하여 쿼리를 실행합니다.

bq query --use_legacy_sql=false --reservation_id=RESERVATION_ID
'QUERY'

다음을 바꿉니다.


RESERVATION_ID: 쿼리를 실행할 예약입니다.
QUERY: 쿼리의 SQL 문입니다.


예를 들어 다음 쿼리는 US 멀티 리전의 test-reservation 예약에서 실행됩니다.

bq query --reservation_id=project1.US:test-reservation 'SELECT 42;'

 API API를 사용하여 예약하려면 새 작업을 삽입 [https://cloud.google.com/bigquery/docs/reference/rest/v2/jobs/insert?hl=ko]하고 query 작업 구성 속성을 채웁니다. reservation 필드에 예약 정보를 지정합니다.
주의: 쿼리는 다른 프로젝트에 선언된 예약을 사용할 수 있습니다. 하지만 쿼리와 예약은 동일한 조직 및 동일한 위치에 있어야 합니다.
BigQuery ML 워크로드에 슬롯 할당
다음 섹션에서는 BigQuery ML 모델의 예약 할당 요구사항에 대해 설명합니다. 예약에 조직 할당 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#assign-organization] 또는 예약에 프로젝트 또는 폴더 할당 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#assign_my_prod_project_to_prod_reservation]의 절차에 따라 이러한 예약 할당을 만들 수 있습니다.
외부 모델
다음 BigQuery ML 모델 유형은 외부 서비스를 사용합니다.
Autoencoder [https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-create-autoencoder?hl=ko]
AutoML [https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-create-automl?hl=ko]
부스티드 트리 [https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-create-boosted-tree?hl=ko]
심층신경망(DNN) [https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-create-dnn-models?hl=ko]
랜덤 포레스트 [https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-create-random-forest?hl=ko]
Wide-and-Deep Network [https://cloud.google.com/bigquery/docs/reference/standard-sql/bigqueryml-syntax-create-wnd-models?hl=ko]
ML_EXTERNAL 작업 유형을 사용하는 예약 할당을 만들어 이러한 서비스를 사용하는 쿼리에 예약된 슬롯을 할당할 수 있습니다. ML_EXTERNAL 작업 유형의 예약 할당이 없으면 쿼리 작업이 주문형 가격 책정 [https://cloud.google.com/bigquery/pricing?hl=ko#on_demand_pricing]을 사용하여 실행됩니다.
외부 모델 학습 작업의 경우 예약 할당의 슬롯은 사전 처리, 학습, 사후 처리 단계에 사용됩니다. 학습 중에는 슬롯을 선점할 수 없지만 전처리 및 후처리 중에는 유휴 슬롯을 사용할 수 있습니다.
행렬 분해 모델
행렬 분해 모델을 만들려면 BigQuery Enterprise 또는 Enterprise Plus 버전 [https://cloud.google.com/bigquery/docs/editions-intro?hl=ko]을 사용하는 예약을 만든 후 [https://cloud.google.com/bigquery/docs/reservations-tasks?hl=ko#create_reservations] QUERY 작업 유형을 사용하는 예약 할당을 만들어야 합니다.
기타 모델 유형
외부 모델이나 행렬 인수분해 모델이 아닌 BigQuery ML 모델의 경우 QUERY 작업 유형을 사용하는 예약 할당을 만들어 이러한 서비스를 사용하는 쿼리에 예약된 슬롯을 할당할 수 있습니다. QUERY 작업 유형의 예약 할당이 없으면 쿼리 작업이 주문형 가격 책정 [https://cloud.google.com/bigquery/pricing?hl=ko#on_demand_pricing]을 사용하여 실행됩니다.
예약 할당 찾기
필수 권한
특정 프로젝트, 폴더 또는 조직의 예약 할당을 검색하려면 다음 Identity and Access Management(IAM) 권한이 필요합니다.
관리 프로젝트에 대한 bigquery.reservationAssignments.list
사전 정의된 다음의 각 IAM 역할에는 이 권한이 포함되어 있습니다.
BigQuery Admin
BigQuery Resource Admin
BigQuery Resource Editor
BigQuery Resource Viewer
BigQuery User
BigQuery에서 IAM 역할에 대한 상세 설명은 사전 정의된 역할 및 권한 [https://cloud.google.com/bigquery/docs/access-control?hl=ko]을 참조하세요.
프로젝트의 예약 할당 찾기
다음을 수행하면 프로젝트, 폴더 또는 조직이 예약에 할당되었는지 확인할 수 있습니다.
--- 탭: 콘솔 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#%EC%BD%98%EC%86%94] ---
Google Cloud 콘솔에서 BigQuery 페이지로 이동합니다.

BigQuery로 이동 [https://console.cloud.google.com/bigquery?hl=ko] 
탐색 메뉴에서 용량 관리를 클릭합니다.
예약 탭을 클릭합니다.
예약 표에서 예약을 확장하여 해당 예약에 할당된 리소스를 확인하거나 필터 필드를 사용하여 리소스 이름으로 필터링합니다.

--- 탭: SQL [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#sql] ---
프로젝트의 쿼리 작업이 할당된 예약을 찾으려면 INFORMATION_SCHEMA.ASSIGNMENTS_BY_PROJECT 보기 [https://cloud.google.com/bigquery/docs/information-schema-reservations?hl=ko#schema]를 쿼리합니다.






 Google Cloud 콘솔에서 BigQuery 페이지로 이동합니다.

BigQuery로 이동 [https://console.cloud.google.com/bigquery?hl=ko] 
쿼리 편집기에서 다음 문을 입력합니다.

  SELECT
    assignment_id
  FROM `region-LOCATION`.INFORMATION_SCHEMA.ASSIGNMENTS_BY_PROJECT
  WHERE
    assignee_id = 'PROJECT_ID'
    AND job_type = 'JOB_TYPE';


다음을 바꿉니다.

  LOCATION: 확인할 예약의 위치 [https://cloud.google.com/bigquery/docs/locations?hl=ko]
  ADMIN_PROJECT_ID: 예약 리소스를 소유하는 관리 프로젝트 [https://cloud.google.com/bigquery/docs/reservations-workload-management?hl=ko#admin-project]의 프로젝트 ID
  PROJECT_ID: 예약에 할당할 프로젝트의 ID입니다.
  JOB_TYPE: QUERY, CONTINUOUS, PIPELINE, BACKGROUND, ML_EXTERNAL과 같이 이 예약에 할당할 작업 유형 [https://cloud.google.com/bigquery/docs/reservations-intro?hl=ko#assignments]입니다.


play_circle 실행을 클릭합니다.




쿼리를 실행하는 방법에 대한 자세한 내용은 대화형 쿼리 실행 [https://cloud.google.com/bigquery/docs/running-queries?hl=ko#queries]을 참조하세요.

--- 탭: bq [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#bq] ---
주의: 이 명령어는 Cloud Shell에서 작동하지 않습니다. 이 명령어를 사용하려면 로컬 명령줄에서 실행합니다.
프로젝트의 쿼리 작업이 할당된 예약을 찾으려면 bq show 명령어를 --reservation_assignment 플래그와 함께 사용합니다.

bq show \
    --project_id=ADMIN_PROJECT_ID \
    --location=LOCATION \
    --reservation_assignment \
    --job_type=JOB_TYPE \
    --assignee_id=PROJECT_ID \
    --assignee_type=PROJECT


다음을 바꿉니다.


ADMIN_PROJECT_ID: 예약 리소스를 소유하는 프로젝트의 ID
LOCATION: 확인할 예약의 위치 [https://cloud.google.com/bigquery/docs/locations?hl=ko]입니다.
JOB_TYPE: QUERY, CONTINUOUS, PIPELINE, BACKGROUND, ML_EXTERNAL과 같이 이 예약에 할당할 작업 유형 [https://cloud.google.com/bigquery/docs/reservations-intro?hl=ko#assignments]입니다.
PROJECT_ID: 프로젝트 ID입니다.
예약 할당 업데이트
다른 예약으로 할당 이동
한 예약에서 다른 예약으로 할당을 이동할 수 있습니다.
예약 할당을 이동하려면 관리 프로젝트 [https://cloud.google.com/bigquery/docs/reservations-workload-management?hl=ko#admin-project] 및 할당된 담당자에 대한 다음 Identity and Access Management(IAM) 권한이 필요합니다.
bigquery.reservationAssignments.create
bigquery.reservationAssignments.delete
다음과 같은 사전 정의된 IAM 역할에는 이러한 권한이 포함되어 있습니다.
BigQuery Admin
BigQuery Resource Admin
BigQuery Resource Editor
BigQuery에서 IAM 역할에 대한 상세 설명은 사전 정의된 역할 및 권한 [https://cloud.google.com/bigquery/docs/access-control?hl=ko]을 참조하세요.
할당을 이동하려면 bq update 명령어를 사용합니다.
bq update \
    --project_id=
ADMIN_PROJECT_ID \
    --location=
LOCATION \
    --reservation_assignment \
    --destination_reservation_id=
DESTINATION_RESERVATION \
    
ADMIN_PROJECT_ID:
LOCATION.
RESERVATION_NAME.
ASSIGNMENT_ID
다음을 바꿉니다.
ADMIN_PROJECT_ID: 예약 리소스를 소유하는 프로젝트의 ID
LOCATION: 새 예약의 위치 [https://cloud.google.com/bigquery/docs/locations?hl=ko]입니다.
RESERVATION_NAME: 할당을 이동할 원본 예약입니다.
DESTINATION_RESERVATION: 할당을 이동할 예약입니다.
ASSIGNMENT_ID: 할당 ID.
할당 ID를 가져오려면 프로젝트의 예약 할당 나열 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#list-assignment]을 참조하세요.
예약 할당 삭제
예약 할당을 삭제하여 예약에서 프로젝트를 삭제할 수 있습니다. 프로젝트가 어떤 예약에도 할당되지 않은 경우 상위 폴더 또는 조직에서 모든 할당을 상속하거나, 상위 할당이 없는 경우 주문형 가격 책정을 사용합니다.
예약 할당을 삭제하면 해당 예약의 슬롯으로 실행되는 작업이 완료될 때까지 계속 실행됩니다.
필수 권한
예약 할당을 삭제하려면 다음 Identity and Access Management(IAM) 권한이 필요합니다.
관리 프로젝트 [https://cloud.google.com/bigquery/docs/reservations-workload-management?hl=ko#admin-project] 및 할당된 담당자에 대한 bigquery.reservationAssignments.delete 권한
사전 정의된 다음의 각 IAM 역할에는 이 권한이 포함되어 있습니다.
BigQuery Admin
BigQuery Resource Admin
BigQuery Resource Editor
예약에서 프로젝트 삭제
프로젝트를 예약에서 삭제하려면 다음 단계를 따르세요.
--- 탭: 콘솔 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#%EC%BD%98%EC%86%94] ---
Google Cloud 콘솔에서 BigQuery 페이지로 이동합니다.

BigQuery로 이동 [https://console.cloud.google.com/bigquery?hl=ko] 
탐색 메뉴에서 용량 관리를 클릭합니다.
예약 탭을 클릭합니다.
예약 표에서 예약을 확장하여 프로젝트를 찾습니다.
more_vert
작업 옵션을 확장합니다.
삭제를 클릭합니다.

--- 탭: SQL [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#sql] ---
DROP ASSIGNMENT DDL 문 [https://cloud.google.com/bigquery/docs/reference/standard-sql/data-definition-language?hl=ko#drop_assignment_statement]을 사용합니다.






 Google Cloud 콘솔에서 BigQuery 페이지로 이동합니다.

BigQuery로 이동 [https://console.cloud.google.com/bigquery?hl=ko] 
쿼리 편집기에서 다음 문을 입력합니다.

DROP ASSIGNMENT
  `ADMIN_PROJECT_ID.region-LOCATION.RESERVATION_NAME.ASSIGNMENT_ID`;


다음을 바꿉니다.

  ADMIN_PROJECT_ID: 예약 리소스를 소유하는 관리 프로젝트 [https://cloud.google.com/bigquery/docs/reservations-workload-management?hl=ko#admin-project]의 프로젝트 ID
  LOCATION: 예약 위치 [https://cloud.google.com/bigquery/docs/locations?hl=ko]
  RESERVATION_NAME: 예약 이름
  ASSIGNMENT_ID: 할당 ID.
    할당 ID를 찾으려면 프로젝트의 예약 할당 나열 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#list-assignment]을 참조하세요.


play_circle 실행을 클릭합니다.




쿼리를 실행하는 방법에 대한 자세한 내용은 대화형 쿼리 실행 [https://cloud.google.com/bigquery/docs/running-queries?hl=ko#queries]을 참조하세요.

--- 탭: bq [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#bq] ---
예약에서 프로젝트를 삭제하려면 bq rm 명령어를 --reservation_assignment 플래그와 함께 실행합니다.

bq rm \
    --project_id=ADMIN_PROJECT_ID \
    --location=LOCATION \
    --reservation_assignment RESERVATION_NAME.ASSIGNMENT_ID


다음을 바꿉니다.


ADMIN_PROJECT_ID: 예약 리소스를 소유하는 프로젝트의 ID
LOCATION: 예약 위치 [https://cloud.google.com/bigquery/docs/locations?hl=ko]
RESERVATION_NAME: 예약 이름
ASSIGNMENT_ID: 할당 ID.

할당 ID를 가져오려면 프로젝트의 예약 할당 찾기 [https://cloud.google.com/bigquery/docs/reservations-assignments?hl=ko#list-assignment]를 참조하세요.
도움이 되었나요?
의견 보내기