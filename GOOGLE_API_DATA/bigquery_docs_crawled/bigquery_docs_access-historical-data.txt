Source URL: https://cloud.google.com/bigquery/docs/access-historical-data

이 페이지는 Cloud Translation API [https://cloud.google.com/translate/?hl=ko]를 통해 번역되었습니다.
Switch to English
BigQuery [https://cloud.google.com/bigquery?hl=ko]
Documentation [https://cloud.google.com/bigquery/docs?hl=ko]
가이드 [https://cloud.google.com/bigquery/docs/introduction?hl=ko]
의견 보내기
이 페이지의 내용
특정 시점의 데이터 쿼리 [https://cloud.google.com/bigquery/docs/access-historical-data?hl=ko#query_data_at_a_point_in_time]
특정 시점의 테이블 복원 [https://cloud.google.com/bigquery/docs/access-historical-data?hl=ko#restore-a-table]
다음 단계 [https://cloud.google.com/bigquery/docs/access-historical-data?hl=ko#whats_next]
이전 데이터 액세스
bookmark_border
BigQuery에서는 시간 이동 [https://cloud.google.com/bigquery/docs/time-travel?hl=ko] 기간 내에 변경되었거나 삭제된 BigQuery에 저장된 데이터를 쿼리하고 복원할 수 있습니다.
특정 시점의 데이터 쿼리
FOR SYSTEM_TIME AS OF [https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax?hl=ko#for_system_time_as_of] 절을 사용하여 시간 이동 기간 이내의 어느 시점에서든 테이블의 이전 데이터를 쿼리할 수 있습니다. 이 절은 상수 타임스탬프 표현식을 사용해서 해당 타임스탬프에서 현재였던 테이블 버전을 참조합니다. 테이블은 BigQuery에 저장되어야 하며, 외부 테이블일 수 없습니다. SYSTEM_TIME AS OF를 사용할 때는 테이블 크기에 제한이 없습니다.
예를 들어 다음 쿼리는 1시간 전의 이전 테이블 버전을 반환합니다.
SELECT *
FROM `mydataset.mytable`
  FOR SYSTEM_TIME AS OF TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 1 HOUR);
참고: FOR SYSTEM_TIME AS OF 절은 GoogleSQL에서 지원됩니다. legacy SQL의 경우 시간 데코레이터 [https://cloud.google.com/bigquery/docs/table-decorators?hl=ko#time_decorators]에서 동일한 기능을 제공합니다.
타임스탬프가 시간 이동 기간 이전 또는 테이블 생성 이전의 시간을 지정하는 경우 쿼리가 실패하고 다음과 비슷한 오류가 반환됩니다.
Invalid snapshot time 1601168925462 for table
myproject:mydataset.table1@1601168925462. Cannot read before 1601573410026.
CREATE OR REPLACE TABLE 문을 사용하여 기존 테이블을 대체한 후 FOR SYSTEM_TIME AS OF를 사용하여 테이블의 이전 버전을 쿼리할 수 있습니다.
테이블이 삭제된 경우 쿼리가 실패하고 다음과 비슷한 오류가 반환됩니다.
Not found: Table myproject:mydataset.table was not found in location LOCATION
특정 시점의 테이블 복원
이전 데이터를 테이블에 복사하여 이전 데이터에서 테이블을 복원할 수 있습니다. 시간 이동 기간 이내에만 테이블을 복원하면, 테이블이 삭제되었거나 만료되었더라도 이전 데이터 복사가 작동합니다.
참고: 삭제된 테이블에서 데이터를 복원하려면 해당 테이블에 대한 bigquery.admin 역할이 있어야 합니다.
테이블에서 이전 데이터를 복사하려면 다음 문법 중 하나를 사용하여 테이블 이름에 데코레이터를 추가합니다.
tableid@TIME: 여기서 TIME은 Unix epoch 이후의 밀리초 수입니다.
tableid@-TIME_OFFSET: 여기서 TIME_OFFSET은 현재 시간 기준의 상대 오프셋(밀리초)입니다.
tableid@0: 사용 가능한 가장 오래된 이전 데이터를 지정합니다.
예를 들어 다음 bq 명령줄 도구 명령어는 1시간 전의 table1이라는 테이블을 table1_restored라는 테이블에 복사합니다. 시간 -3600000은 상대 오프셋을 사용하여 밀리초 단위로 지정됩니다.
bq cp mydataset.table1@-3600000 mydataset.table1_restored
지정된 시간의 동일한 Unix epoch 시간을 가져오려면 다음 명령어를 실행합니다.
  date -d '2023-08-04 16:00:34.456789Z' +%s000
  
다음 bq 명령줄 도구 명령어는 table1이라는 테이블을 table1_restored라는 테이블에 복사합니다. 이전 명령어에서 수신한 UNIX epoch 시간 1691164834000을 바꿉니다.
bq cp mydataset.table1@1691164834000 mydataset.table1_restored
자세한 내용은 삭제된 테이블 복원 [https://cloud.google.com/bigquery/docs/restore-deleted-tables?hl=ko]을 참고하세요.
다음 단계
테이블 스냅샷 [https://cloud.google.com/bigquery/docs/table-snapshots-intro?hl=ko] 자세히 알아보기
시간 이동 및 장애 안전을 통한 데이터 보관 [https://cloud.google.com/bigquery/docs/time-travel?hl=ko]에 대해 자세히 알아보세요.
테이블 관리 [https://cloud.google.com/bigquery/docs/managing-tables?hl=ko]에 대해 자세히 알아보세요.
의견 보내기