Source URL: https://cloud.google.com/bigquery/docs/search-ads-transfer

BigQuery [https://cloud.google.com/bigquery?hl=ko]
Documentation [https://cloud.google.com/bigquery/docs?hl=ko]
가이드 [https://cloud.google.com/bigquery/docs/introduction?hl=ko]
도움이 되었나요?
의견 보내기
이 페이지의 내용
지원되는 보고서 [https://cloud.google.com/bigquery/docs/search-ads-transfer?hl=ko#supported_reports]
Search Ads 360 전송의 데이터 수집 [https://cloud.google.com/bigquery/docs/search-ads-transfer?hl=ko#data-ingestion]
새로고침 기간 [https://cloud.google.com/bigquery/docs/search-ads-transfer?hl=ko#refresh]
제한사항 [https://cloud.google.com/bigquery/docs/search-ads-transfer?hl=ko#limitations]
시작하기 전에 [https://cloud.google.com/bigquery/docs/search-ads-transfer?hl=ko#before_you_begin]
BigQuery에 Search Ads 360 데이터 로드
bookmark_border
Search Ads 360용 BigQuery Data Transfer Service 커넥터를 사용하여 Search Ads 360에서 BigQuery로 데이터를 로드할 수 있습니다. BigQuery Data Transfer Service를 사용하면 Search Ads 360의 최신 데이터를 BigQuery에 추가하는 반복 전송 작업을 예약할 수 있습니다.
지원되는 보고서
Search Ads 360용 BigQuery Data Transfer Service는 Search Ads 360 Reporting API v0을 지원합니다.
Search Ads 360 v0 보고서 [https://developers.google.com/search-ads/reporting/api/reference/fields/v0/overview?hl=ko]
Search Ads 360 보고서가 BigQuery Data Transfer Service 테이블 및 뷰로 변환되는 방식에 대한 자세한 내용은 Search Ads 360 보고서 변환 [https://cloud.google.com/bigquery/docs/search-ads-transformation?hl=ko]을 참조하세요.
보고 옵션 지원
지원되는 API 버전
v0 [https://developers.google.com/search-ads/reporting/api/reference/fields/v0/overview?hl=ko]
반복 빈도
매일, 데이터 전송이 처음 만들어진 시간(기본값)
시간을 구성할 수 있습니다.
새로고침 범위 [https://cloud.google.com/bigquery/docs/search-ads-transfer?hl=ko#refresh]
지난 7일(기본값)
최대 30일까지 구성 가능
데이터 이동 색인 [https://cloud.google.com/bigquery/docs/search-ads-transformation?hl=ko#search_ads_match_tables] 스냅샷은 하루에 한 번 생성되며 최근 실행 날짜의 파티션에 저장됩니다. 데이터 이동 색인 스냅샷은 백필 또는 새로고침 창을 사용하여 로드된 날짜에 대하여 업데이트되지 않습니다.
최대 백필 기간
제한 없음
관리자 계정당 고객 ID의 수
8,000
BigQuery Data Transfer Service는 각 Search Ads 360 관리자 계정 [https://support.google.com/sa360/answer/9158072?hl=ko]에 최대 8,000개의 고객 ID를 지원합니다.
이전 Search Ads 360 Reporting API를 사용하는 Search Ads 360 전송 가이드를 보려면 Search Ads 360 전송(지원 중단됨) [https://cloud.google.com/bigquery/docs/sa360-transfer?hl=ko]을 참조하세요.
Search Ads 360 전송의 데이터 수집
Search Ads 360에서 BigQuery로 데이터를 전송하면 데이터가 날짜별로 파티션을 나눈 BigQuery 테이블에 로드됩니다. 데이터가 로드되는 테이블 파티션은 데이터 소스의 날짜에 해당합니다. 동일한 날짜에 여러 전송을 예약하면 BigQuery Data Transfer Service가 해당 날짜의 파티션을 최신 데이터로 덮어씁니다. 동일한 일자에 전송이 여러 개 있거나 백필을 실행해도 데이터가 중복되지 않으며 다른 일자의 파티션에 영향을 주지 않습니다.
새로고침 기간
새로고침 기간은 데이터 전송이 발생할 때 데이터 전송이 데이터를 검색하는 일 수입니다. 예를 들어 새로고침 기간이 3일이고 일일 전송이 발생하는 경우 BigQuery Data Transfer Service는 소스 테이블에서 지난 3일 동안의 모든 데이터를 검색합니다. 이 예시에서 일일 전송이 발생하면 BigQuery Data Transfer Service는 현재 날짜의 소스 테이블 데이터 사본이 포함된 새 BigQuery 대상 테이블 파티션을 만든 다음 백필 실행을 자동으로 트리거하여 BigQuery 대상 테이블 파티션을 지난 2일 동안의 소스 테이블 데이터로 업데이트합니다. 자동으로 트리거된 백필 실행은 BigQuery Data Transfer Service 커넥터에서 증분 업데이트가 지원되는지 여부에 따라 BigQuery 대상 테이블을 덮어쓰거나 증분 업데이트합니다.
데이터 전송을 처음 실행하면 데이터 전송에서 새로고침 기간 내에 사용 가능한 모든 소스 데이터를 검색합니다. 예를 들어 새로고침 기간이 3일이고 데이터 전송을 처음 실행하면 BigQuery Data Transfer Service에서 3일 이내에 모든 소스 데이터를 검색합니다.
새로고침 기간은 TransferConfig.data_refresh_window_days API 필드 [https://cloud.google.com/bigquery/docs/reference/datatransfer/rest/v1/projects.locations.transferConfigs?hl=ko#TransferConfig.FIELDS.data_refresh_window_days]에 매핑됩니다.
새로고침 기간 외의 데이터(예: 이전 데이터)를 검색하거나 전송 중단 또는 불일치 문제를 해결하려면 백필 실행 [https://cloud.google.com/bigquery/docs/working-with-transfers?hl=ko#manually_trigger_a_transfer]을 시작하거나 예약하면 됩니다.
제한사항
Search Ads 360 데이터 전송을 구성할 수 있는 최대 빈도는 24시간마다 한 번입니다. 기본적으로 전송은 사용자가 전송을 만드는 시간에 시작됩니다. 하지만 전송을 만들 [https://cloud.google.com/bigquery/docs/search-ads-transfer?hl=ko#setup-data-transfer] 때 데이터 전송 시작 시간을 구성할 수 있습니다.
BigQuery Data Transfer Service는 Search Ads 360 전송 중에 증분 데이터 전송을 지원하지 않습니다. 데이터 전송에 대해 날짜를 지정하면 해당 날짜에 사용 가능한 모든 데이터가 전송됩니다.
시작하기 전에
Search Ads 360 데이터 전송을 만들기 전에 다음을 수행하세요.
BigQuery Data Transfer Service 사용 설정 [https://cloud.google.com/bigquery/docs/enable-transfer-service?hl=ko]에 필요한 모든 작업을 완료했는지 확인합니다.
Search Ads 360 보고 데이터를 저장하기 위한 BigQuery Data Transfer Service 데이터 세트를 만듭니다 [https://cloud.google.com/bigquery/docs/datasets?hl=ko].
Pub/Sub의 전송 실행 알림을 설정하려면 pubsub.topics.setIamPolicy 권한이 있어야 합니다. 이메일 알림만 설정한다면 Pub/Sub 권한이 필요하지 않습니다. 자세한 내용은 BigQuery Data Transfer Service 실행 알림 [https://cloud.google.com/bigquery/docs/transfer-run-notifications?hl=ko]을 참조하세요.
프로젝트에서 Search Ads 360 Reporting API에 대해 액세스를 사용 설정 [https://console.developers.google.com/apis/api/searchads360.googleapis.com/?hl=ko]합니다.
필수 권한
데이터 전송을 만드는 사용자에게 다음과 같은 필수 권한이 있는지 확인합니다.
BigQuery Data Transfer Service:
데이터 전송을 만드는 bigquery.transfers.update 권한
대상 데이터 세트에 대한 bigquery.datasets.get 및 bigquery.datasets.update 권한
사전 정의된 IAM 역할 bigquery.admin에는 bigquery.transfers.update, bigquery.datasets.update, bigquery.datasets.get 권한이 있습니다. BigQuery Data Transfer Service의 IAM 역할에 대한 자세한 내용은 액세스 제어 [https://cloud.google.com/bigquery/docs/access-control?hl=ko]를 참조하세요.
Google Cloud:
프로젝트에 대한 Search Ads 360에서 데이터를 다운로드할 수 있는 serviceusage.services.use 권한
사전 정의된 IAM 역할 editor, owner, serviceusage.serviceUsageConsumer에는 serviceusage.services.use 권한이 포함되어 있습니다. 서비스 사용량의 IAM 역할에 대한 자세한 내용은 액세스 제어 참조 [https://cloud.google.com/service-usage/docs/access-control?hl=ko]를 확인하세요.
Search Ads 360:
전송 구성에 사용된 Search Ads 360 고객 ID 또는 관리자 계정 [https://support.google.com/sa360/answer/9158072?hl=ko]에 대한 읽기 액세스 권한 서비스 계정의 읽기 액세스를 구성하려면 Search Ads 360 지원팀에 문의 [https://support.google.com/sa360/gethelp?hl=ko]하여 도움을 받으세요.
Search Ads 360 데이터 전송 만들기
Search Ads 360 보고를 위한 데이터 전송을 만들려면 Search Ads 360 고객 ID 또는 관리자 계정 [https://support.google.com/sa360/answer/9158072?hl=ko]이 필요합니다. 다음 옵션 중 하나를 선택합니다.
--- 탭: 콘솔 [https://cloud.google.com/bigquery/docs/search-ads-transfer?hl=ko#%EC%BD%98%EC%86%94] ---
Google Cloud 콘솔에서 데이터 전송 페이지로 이동합니다.

데이터 전송으로 이동 [https://console.cloud.google.com/bigquery/transfers?hl=ko] 
add 전송 만들기를 클릭합니다.
소스 유형 섹션의 소스에서 Search Ads 360를 선택합니다.
전송 구성 이름 섹션의 표시 이름에 데이터 전송 이름(예: My Transfer)을 입력합니다. 전송 이름은 나중에 수정해야 할 경우를 대비해 전송을 식별할 수 있는 값이면 됩니다.
일정 옵션 섹션에서 다음을 수행합니다.


반복 빈도에 대해 데이터 전송을 실행하려는 빈도 옵션을 선택합니다. 일을 선택한 경우 UTC로 유효한 시간을 제공합니다.
해당하는 경우 지금 시작 또는 설정 시간에 시작을 선택하고 시작 날짜와 실행 시간을 입력합니다.

대상 설정 섹션의 데이터 세트에서 데이터를 저장하기 위해 만든 데이터 세트를 선택합니다.
데이터 소스 세부정보 섹션에서 다음을 수행합니다.


고객 ID에 Search Ads 360 고객 ID를 입력합니다.
선택사항: 대행사 ID 및 광고주 ID를 모두 입력하여 ID 매핑 테이블 [https://cloud.google.com/bigquery/docs/search-ads-transfer?hl=ko#id-mapping]을 검색합니다.
선택사항: 커스텀 플러드라이트 변수에 데이터 전송에 포함할 커스텀 플러드라이트 변수 [https://support.google.com/sa360/answer/13567857?hl=ko]를 입력합니다. 커스텀 플러드라이트 변수는 전송 구성에서 고객 ID로 지정된 Search Ads 360 계정이 소유해야 합니다. 이 파라미터는 JSON 배열 형식의 문자열 입력을 사용하며 여러 커스텀 플러드라이트 변수를 지원할 수 있습니다. JSON 배열의 각 항목에는 다음 매개변수가 필요합니다.


id: 커스텀 플러드라이트 변수의 숫자 ID입니다. 이 ID는 Search Ads 360에서 맞춤 플러드라이트 변수가 생성 [https://support.google.com/sa360/answer/14316155?hl=ko]될 때 할당됩니다.
id를 지정한 경우 name은 필수가 아닙니다.
name: Search Ads 360의 맞춤 플러드라이트 변수의 사용자 정의 이름입니다. name을 지정한 경우 id는 필수가 아닙니다.
cfv_field_name: 사용 사례를 기반으로 한 정확한 맞춤 플러드라이트 변수 필드 이름입니다. 지원되는 값은 conversion_custom_metrics, conversion_custom_dimensions, raw_event_conversion_metrics, raw_event_conversion_dimensions입니다.
destination_table_name: 맞춤 플러드라이트 변수를 포함할 BigQuery 테이블의 목록입니다. BigQuery Data Transfer Service가 이러한 테이블의 데이터를 검색하면 전송의 쿼리에 맞춤 플러드라이트 변수가 포함됩니다.
bigquery_column_name_suffix: 사용자 정의된 친화적인 열 이름입니다. BigQuery Data Transfer Service는 표준 필드 이름 다음에 서픽스를 추가하여 여러 맞춤 플러드라이트 변수를 구분합니다. 사용 사례에 따라 BigQuery Data Transfer Service는 다음과 같이 BigQuery 열 이름을 생성합니다.



  
    
    맞춤 플러드라이트 변수를 측정항목 및 세그먼트로 생성
    맞춤 플러드라이트 변수를 전환 리소스의 원시 이벤트 속성으로 생성
  
  
    metrics
    metrics_conversion_custom_metrics_bigquery_column_name_suffix
    metrics_raw_event_conversion_metrics_bigquery_column_name_suffix
  
  
    dimension
    segments_conversion_custom_dimensions_bigquery_column_name_suffix
    segments_raw_event_conversion_dimensions_bigquery_column_name_suffix
  


다음은 2개의 커스텀 플러드라이트 변수를 지정하는 커스텀 플러드라이트 변수 항목의 예시입니다.

[{
"id": "1234",
"cfv_field_name": "raw_event_conversion_metrics",
"destination_table_name": ["Conversion"],
"bigquery_column_name_suffix": "suffix1"
},{
"name": "example name",
"cfv_field_name": "conversion_custom_metrics",
"destination_table_name": ["AdGroupConversionActionAndDeviceStats","CampaignConversionActionAndDeviceStats"],
"bigquery_column_name_suffix": "suffix2"
}]
(선택사항) 커스텀 열 필드에 데이터 전송에 포함할 커스텀 열 [https://developers.google.com/search-ads/reporting/concepts/custom-columns?hl=ko]을 입력합니다. 커스텀 열은 전송 구성에서 고객 ID로 지정된 Search Ads 360 계정이 소유해야 합니다. 이 필드는 JSON 배열 형식의 문자열 입력을 사용하며 여러 열을 지원할 수 있습니다. JSON 배열의 각 항목에는 다음 파라미터가 필요합니다.


id: 맞춤 열의 숫자 ID입니다. 이 ID는 맞춤 열이 생성 [https://support.google.com/sa360/answer/9633916?amp%3Bref_topic=14138984&%3Bsjid=5858325799664893372-NC&hl=ko]될 때 할당됩니다.
id를 지정한 경우 name은 필수가 아닙니다.
name: Search Ads 360 맞춤 열의 사용자 정의 이름입니다. name을 지정한 경우 id는 필수가 아닙니다.
destination_table_name: 맞춤 열을 포함할 BigQuery 테이블 목록입니다. BigQuery Data Transfer Service가 이러한 테이블의 데이터를 검색하면 전송의 쿼리에 맞춤 열 필드가 포함됩니다.
bigquery_column_name: 사용자 정의된 친화적인 열 이름입니다.
destination_table_name에 지정된 대상 테이블에 있는 맞춤 열의 필드 이름입니다. 열 이름은 BigQuery 열 이름 형식 요구사항을 따라야 [https://cloud.google.com/bigquery/docs/schemas?hl=ko#column_names] 하며 테이블의 표준 스키마 [https://cloud.google.com/bigquery/docs/search-ads-transformation?hl=ko] 또는 다른 맞춤 열에 있는 다른 필드에서 고유해야 합니다.


다음은 2개의 맞춤 열을 지정하는 맞춤 열 항목의 예시입니다.

[{
  "id": "1234",
  "destination_table_name": ["Conversion"],
  "bigquery_column_name": "column1"
},{
  "name": "example name",
  "destination_table_name": ["AdGroupStats","CampaignStats"],
  "bigquery_column_name": "column2"
}]
선택사항: 테이블 필터 필드에 포함할 테이블 목록을 쉼표로 구분해서 입력합니다(예: Campaign, AdGroup). 특정 테이블을 제외하려면 이 목록 앞에 - 문자를 추가합니다(예: -Campaign, AdGroup). 기본적으로 모든 테이블이 포함됩니다.
선택사항: 새로고침 기간에 1~30 사이의 값을 입력합니다. 설정하지 않으면 새로고침 기간이 기본적으로 7일로 설정됩니다.

서비스 계정 메뉴에서 Google Cloud 프로젝트와 연결된 서비스 계정의 서비스 계정 [https://cloud.google.com/iam/docs/service-account-overview?hl=ko]을 선택합니다. 사용자 인증 정보를 사용하는 대신 서비스 계정을 전송에 연결할 수 있습니다. 데이터 전송에서 서비스 계정을 사용하는 방법에 관한 자세한 내용은 서비스 계정 사용 [https://cloud.google.com/bigquery/docs/use-service-accounts?hl=ko]을 참조하세요.

제휴 ID [https://cloud.google.com/iam/docs/workforce-identity-federation?hl=ko]로 로그인한 경우 전송을 만들려면 서비스 계정이 필요합니다. Google 계정 [https://cloud.google.com/iam/docs/principals-overview?hl=ko#google-account]으로 로그인한 경우 전송에 사용되는 서비스 계정은 선택사항입니다. 서비스 계정에는 필수 권한 [https://cloud.google.com/bigquery/docs/search-ads-transfer?hl=ko#required_permissions]이 있어야 합니다.
선택사항: 알림 옵션 섹션에서 다음을 수행합니다.


전환을 클릭해서 이메일 알림을 사용 설정합니다. 이 옵션을 사용 설정하면 전송 실행이 실패할 때 전송 관리자에게 이메일 알림이 발송됩니다.
전환을 클릭하여 Pub/Sub 알림을 사용 설정합니다. Cloud Pub/Sub 주제 선택에서 주제 [https://cloud.google.com/pubsub/docs/overview?hl=ko#types] 이름을 선택하거나 주제 만들기를 클릭합니다. 이 옵션은 전송에 대한 Pub/Sub 실행 알림 [https://cloud.google.com/bigquery/docs/transfer-run-notifications?hl=ko]을 구성합니다.

저장을 클릭합니다.

--- 탭: bq [https://cloud.google.com/bigquery/docs/search-ads-transfer?hl=ko#bq] ---
bq mk 명령어를 입력하고 전송 생성 플래그 --transfer_config를 지정합니다. 다음 플래그도 필요합니다.


--data_source
--target_dataset
--display_name
--params


다음 플래그는 선택사항입니다.


--project_id: 사용할 프로젝트를 지정합니다. 플래그를 지정하지 않으면 기본 프로젝트가 사용됩니다.
--service_account_name: 사용자 계정 대신 Search Ads 360 전송 인증에 사용할 서비스 계정을 지정합니다.


bq mk \
--transfer_config \
--project_id=PROJECT_ID \
--target_dataset=DATASET \
--display_name=NAME \
--data_source=DATA_SOURCE \
--service_account_name=SERVICE_ACCOUNT_NAME \
--params='{PARAMETERS,"custom_columns":"[{\"id\": \"CC_ID\",\"destination_table_name\": [\"CC_DESTINATION_TABLE\"],\"bigquery_column_name\": \"CC_COLUMN\"}]","custom_floodlight_variables":"[{\"id\": \"CFV_ID\",\"cfv_field_name\": [\"CFV_FIELD_NAME\"],\"destination_table_name\": [\"CFV_DESTINATION_TABLE\"],\"bigquery_column_name_suffix\": \"CFV_COLUMN_SUFFIX\"}]"}'

각 항목의 의미는 다음과 같습니다.


PROJECT_ID(선택사항): 사용할 프로젝트를 지정합니다. 플래그를 지정하지 않으면 기본 프로젝트가 사용됩니다.
DATASET. 전송 구성의 대상 데이터 세트입니다.
NAME: 전송 구성의 표시 이름입니다. 데이터 전송 이름은 나중에 수정해야 할 경우를 대비해 간편하게 전송을 식별할 수 있는 값이면 됩니다.
DATA_SOURCE: 데이터 소스 — search_ads입니다.
SERVICE_ACCOUNT_NAME(선택사항): 데이터 전송을 인증하는 데 사용되는 서비스 계정 이름입니다. 서비스 계정은 전송을 만드는 데 사용한 것과 동일한 project_id가 소유해야 하며 모든 필수 권한 [https://cloud.google.com/bigquery/docs/search-ads-transfer?hl=ko#required_permissions]이 있어야 합니다.
PARAMETERS: JSON 형식으로 생성된 전송 구성의 매개변수입니다. 예를 들면 --params='{"param":"param_value"}'입니다. customer_id 매개변수를 제공해야 합니다.


table_filter: 데이터 전송에 포함할 테이블을 지정합니다. 플래그를 지정하지 않으면 모든 테이블이 포함됩니다. 특정 테이블만 포함하려면 쉼표로 구분된 값 목록을 사용하세요(예: Ad, Campaign, AdGroup). 특정 테이블을 제외하려면 하이픈(-)으로 값에 프리픽스를 사용하세요(예를 들어 -Ad, Campaign, AdGroup을 사용하면 3개 값이 모두 제외됨).
custom_columns: 보고서에 커스텀 열을 지정합니다. 이 매개변수는 JSON 배열 형식의 문자열 입력을 사용하며 여러 열을 지원할 수 있습니다. JSON 배열의 각 항목에는 다음 매개변수가 필요합니다.

CC_ID: 커스텀 열의 숫자 ID입니다. 이 ID는 커스텀 열이 생성 [https://support.google.com/sa360/answer/9633916?amp%3Bref_topic=14138984&%3Bsjid=5858325799664893372-NC&hl=ko]될 때 할당됩니다.
CC_DESTINATION_TABLE: 커스텀 열을 포함할 BigQuery 테이블 목록입니다. BigQuery Data Transfer Service가 이러한 테이블의 데이터를 검색하면 데이터 전송의 쿼리에 커스텀 열 필드가 포함됩니다.
CC_COLUMN: 사용자 정의된 친화적인 열 이름입니다. destination_table_name에 지정된 대상 테이블에 있는 커스텀 열의 필드 이름입니다. 열 이름은 BigQuery 열 이름 형식 요구사항을 따라야 하며 [https://cloud.google.com/bigquery/docs/schemas?hl=ko#column_names] 테이블의 표준 스키마 [https://cloud.google.com/bigquery/docs/search-ads-transformation?hl=ko] 또는 다른 맞춤 열에 있는 다른 필드에서 고유해야 합니다.

custom_floodlight_variables: 전송에서 커스텀 플러드라이트 변수 [https://support.google.com/campaignmanager/answer/2823222?sjid=11547437748727448706-NA&hl=ko]를 지정합니다. 이 매개변수는 JSON 배열 형식의 문자열 입력을 사용하며 여러 커스텀 플러드라이트 변수를 지원할 수 있습니다. JSON 배열의 각 항목에는 다음 매개변수가 필요합니다.

CFV_ID: 커스텀 플러드라이트 변수의 숫자 ID입니다. 이 ID는 Search Ads 360에서 커스텀 플러드라이트 변수가 생성 [https://support.google.com/searchads/answer/6024747?hl=ko#set-up]될 때 할당됩니다.
CFV_FIELD_NAME: 사용 사례를 기반으로 한 정확한 커스텀 플러드라이트 변수 필드 이름입니다. 지원되는 값은 conversion_custom_metrics, conversion_custom_dimensions, raw_event_conversion_metrics, raw_event_conversion_dimensions입니다.
자세한 내용은 커스텀 플러드라이트 측정항목 [https://developers.google.com/search-ads/reporting/concepts/custom-floodlight-variables?hl=ko]을 참고하세요.
CFV_DESTINATION_TABLE: 커스텀 플러드라이트 변수를 포함할 BigQuery 테이블의 목록입니다. BigQuery Data Transfer Service가 이러한 테이블의 데이터를 검색하면 데이터 전송의 쿼리에 커스텀 플러드라이트 변수가 포함됩니다.
CFV_COLUMN_SUFFIX: 사용자 정의된 친화적인 열 이름입니다. BigQuery Data Transfer Service는 표준 필드 이름 다음에 서픽스를 추가하여 여러 커스텀 플러드라이트 변수를 구분합니다. 사용 사례에 따라 BigQuery Data Transfer Service는 다음과 같이 BigQuery 열 이름을 생성합니다.





  
  커스텀 플러드라이트 변수를 측정항목 및 세그먼트로 생성
  커스텀 플러드라이트 변수를 전환 리소스의 원시 이벤트 속성으로 생성


  metrics
  metrics_conversion_custom_metrics_bigquery_column_name_suffix
  metrics_raw_event_conversion_metrics_bigquery_column_name_suffix


  dimension
  segments_conversion_custom_dimensions_bigquery_column_name_suffix
  segments_raw_event_conversion_dimensions_bigquery_column_name_suffix



주의: 명령줄 도구를 사용하여 알림을 구성할 수 없습니다.
예를 들어 다음 명령어는 고객 ID 6828088731 및 대상 데이터 세트 mydataset를 사용하여 이름이 My Transfer인 Search Ads 360 데이터 전송을 만듭니다. 전송에서는 커스텀 플러드라이트 변수도 지정합니다. 기본 프로젝트에 데이터 전송이 생성됩니다.

bq mk \
--transfer_config \
--target_dataset=mydataset \
--display_name='My Transfer' \
--data_source=search_ads \
--params='{"customer_id":"6828088731", "custom_floodlight_variables":"[{\"id\": \"9876\", \"cfv_field_name\": \"raw_event_conversion_metrics\", \"destination_table_name\": [\"Conversion\"],\"bigquery_column_name_suffix\": \"suffix1\" }]"}'

명령어를 처음 실행할 때 다음과 같은 메시지를 받게 됩니다.

[URL omitted] Please copy and paste the above URL into your web browser and
follow the instructions to retrieve an authentication code.

메시지 안내를 따라 명령줄에 인증 코드를 붙여넣습니다.주의: 명령줄 도구를 사용하여 Search Ads 360 데이터 전송을 만들면 전송 구성은 일정(생성 시점부터 24시간마다) 및 새로고침 기간(0 - 새로고침 기본 기간인 7일 구성)의 기본값을 사용하여 설정됩니다.

--- 탭: API [https://cloud.google.com/bigquery/docs/search-ads-transfer?hl=ko#api] ---
projects.locations.transferConfigs.create [https://cloud.google.com/bigquery/docs/reference/datatransfer/rest/v1/projects.locations.transferConfigs/create?hl=ko] 메서드를 사용하고 TransferConfig [https://cloud.google.com/bigquery/docs/reference/datatransfer/rest/v1/projects.locations.transferConfigs?hl=ko#TransferConfig] 리소스의 인스턴스를 지정합니다.
Search Ads 360 전송 수동 트리거
Search Ads 360에서 전송을 수동으로 트리거 [https://cloud.google.com/bigquery/docs/working-with-transfers?hl=ko#manually_trigger_a_transfer]하면 데이터 이동 색인 스냅샷이 하루에 한 번 생성되며 최근 실행 날짜의 파티션에 저장됩니다. 수동 전송을 트리거하면 다음 테이블에 대한 데이터 이동 색인 스냅샷이 업데이트되지 않습니다.
계정
광고
AdGroup
AdGroupCriterion
모든 ID 매핑 테이블 [https://cloud.google.com/bigquery/docs/search-ads-transfer?hl=ko#id-mapping]
확장 소재
BidStrategy
캠페인
CampaignCriterion
ConversionAction
키워드
NegativeAdGroupKeyword
NegativeAdGroupCriterion
NegativeCampaignKeyword
NegativeCampaignCriterion
ProductGroup
실적 최대화 캠페인(PMax)
Search Ads 360 커넥터를 사용하면 PMax 캠페인 [https://support.google.com/google-ads/answer/10724817?hl=ko] 데이터를 내보낼 수 있습니다. 기본적으로 PMax 데이터는 내보내기가 수행되지 않으므로 데이터 전송을 만들 [https://cloud.google.com/bigquery/docs/search-ads-transfer?hl=ko#setup-data-transfer] 때 PMax 캠페인 데이터 포함 체크박스를 선택해야 합니다.
PMax 데이터를 포함하면 특정 테이블의 ad_group 필드가 삭제되고 새 테이블이 포함됩니다. Search Ads 360 API가 PMax 데이터를 필터링하기 때문에 ad_group 필드를 포함할 수 없습니다.
다음 테이블은 PMax 캠페인 테이블 포함 체크박스가 선택된 경우 ad_group 관련 열을 제외합니다.
CartDataSalesStats
ProductAdvertised
ProductAdvertisedDeviceStats
ProductAdvertisedConversionActionAndDeviceStats
Search Ads 360 관리자 계정 지원
Search Ads 360 관리자 계정을 사용하면 개별 고객 ID를 사용하는 경우에 비해 몇 가지 이점을 얻을 수 있습니다.
여러 고객 ID를 보고하기 위해 데이터 전송 여러 개를 관리할 필요가 없습니다.
모든 고객 ID가 동일한 테이블에 저장되므로 고객 간 쿼리를 더욱 간단하게 작성할 수 있습니다.
관리자 계정을 사용하면 여러 고객 ID가 동일한 작업에 로드되므로 BigQuery Data Transfer Service 로드 할당량 문제가 완화됩니다.
여러 개의 고객 ID별 Search Ads 360 데이터 전송이 있는 기존 고객의 경우 대신 Search Ads 360 관리자 계정으로 전환하는 것이 좋습니다. 이렇게 하려면 다음 단계를 따르세요.
관리자 또는 하위 관리자 계정 수준에서 단일 Search Ads 360 데이터 전송을 설정합니다.
백필을 예약합니다. [https://cloud.google.com/bigquery/docs/working-with-transfers?hl=ko#manually_trigger_a_transfer]
개별 고객 ID별 Search Ads 360 전송을 사용 중지 [https://cloud.google.com/bigquery/docs/working-with-transfers?hl=ko#disable_a_transfer]합니다.
Search Ads 360 관리자 계정에 대한 자세한 내용은 새 Search Ads 360의 관리자 계정 정보 [https://support.google.com/sa360/answer/9158072?hl=ko] 및 계정이 관리자 계정에 연결되는 방법 보기 [https://support.google.com/sa360/answer/9227233?hl=ko]를 참조하세요.
참고:: BigQuery Data Transfer Service는 나열된 모든 고객 ID의 보고서를 가져오지만 요청된 날짜에 고객 ID가 활동을 보고하지 않은 경우 보고서에 고객 ID가 나타나지 않을 수 있습니다.
예
다음 목록은 특정 Search Ads 360 관리자 계정에 연결된 고객 ID를 보여줍니다.
1234567890 — 루트 관리자 계정
1234 — 하위 관리 계정
1111 — 고객 ID
2222 — 고객 ID
3333 — 고객 ID
4444 — 고객 ID
567 — 하위 관리 계정
5555 — 고객 ID
6666 — 고객 ID
7777 — 고객 ID
89 — 하위 관리 계정
8888 — 고객 ID
9999 — 고객 ID
0000 — 고객 ID
관리자 계정에 연결된 각 고객 ID가 각 보고서에 표시됩니다. BigQuery Data Transfer Service의 Search Ads 360 보고 구조에 대한 자세한 내용은 Search Ads 360 보고서 변환 [https://cloud.google.com/bigquery/docs/search-ads-transformation?hl=ko]을 참조하세요.
고객 ID 1234567890의 전송 구성
루트 관리자 계정(고객 ID 1234567890)의 전송 구성은 다음 고객 ID를 포함한 데이터 전송 실행을 생성합니다.
1111(하위 관리 계정 1234 사용)
2222(하위 관리 계정 1234 사용)
3333(하위 관리 계정 1234 사용)
4444(하위 관리 계정 1234 사용)
5555(하위 관리 계정 567 및 하위 관리 계정 1234 사용)
6666(하위 관리 계정 567 및 하위 관리 계정 1234 사용)
7777(하위 관리 계정 567 및 하위 관리 계정 1234 사용)
8888(하위 관리 계정 89 사용)
9999(하위 관리 계정 89 사용)
0000(개별 고객 ID)
고객 ID 1234의 전송 구성
하위 관리 계정 123(고객 ID 1234)의 전송 구성은 다음 고객 ID를 포함한 데이터 전송 실행을 생성합니다.
1111
2222
3333
4444
5555(하위 관리 계정 567 사용)
6666(하위 관리 계정 567 사용)
7777(하위 관리 계정 567 사용)
고객 ID 567의 전송 구성
하위 관리 계정 567(고객 ID 567)의 전송 구성은 다음 고객 ID를 포함한 데이터 전송 실행을 생성합니다.
5555
6666
7777
고객 ID 89의 전송 구성
하위 관리 계정 89(고객 ID 89)의 전송 구성은 다음 고객 ID를 포함한 데이터 전송 실행을 생성합니다.
8888
9999
고객 ID 0000의 전송 구성
고객 ID 0000의 전송 구성은 개별 고객 ID만 포함한 데이터 전송 실행을 생성합니다.
0000
데이터 쿼리
데이터가 BigQuery Data Transfer Service에 전송될 때 데이터는 수집 시간으로 파티션을 나눈 테이블에 기록됩니다. 자세한 내용은 파티션을 나눈 테이블 소개 [https://cloud.google.com/bigquery/docs/partitioned-tables?hl=ko]를 참조하세요.
자동 생성된 뷰를 사용하지 않고 직접 테이블을 쿼리하는 경우에는 쿼리에서 _PARTITIONTIME 유사 열을 사용해야 합니다. 자세한 내용은 파티션을 나눈 테이블 쿼리 [https://cloud.google.com/bigquery/docs/querying-partitioned-tables?hl=ko]를 참조하세요.
Search Ads 360 샘플 쿼리
다음 Search Ads 360 샘플 쿼리를 사용하여 전송된 데이터를 분석할 수 있습니다. Looker Studio [https://cloud.google.com/looker-studio?hl=ko]와 같은 시각화 도구에서 쿼리를 볼 수도 있습니다.
다음 쿼리는 BigQuery Data Transfer Service로 Search Ads 360 데이터 쿼리를 시작하는 예시입니다. 이 보고서로 할 수 있는 작업에 대해 추가 문의 사항이 있는 경우 Search Ads 360 기술 담당자에게 문의하세요.
자동 생성된 뷰를 사용하지 않고 직접 테이블을 쿼리하는 경우에는 쿼리에서 _PARTITIONTIME 유사 열을 사용해야 합니다. 자세한 내용은 파티션을 나눈 테이블 쿼리 [https://cloud.google.com/bigquery/docs/querying-partitioned-tables?hl=ko]를 참조하세요.
캠페인 실적
다음 샘플 쿼리는 지난 30일 동안의 Search Ads 360 캠페인 실적을 분석합니다.
SELECT
  c.customer_id,
  c.campaign_name,
  c.campaign_status,
  SUM(cs.metrics_clicks) AS Clicks,
  (SUM(cs.metrics_cost_micros) / 1000000) AS Cost,
  SUM(cs.metrics_impressions) AS Impressions
FROM
  `
DATASET.sa_Campaign_
CUSTOMER_ID` c
LEFT JOIN
  `
DATASET.sa_CampaignStats_
CUSTOMER_ID` cs
ON
  (c.campaign_id = cs.campaign_id
  AND cs._DATA_DATE BETWEEN
  DATE_ADD(CURRENT_DATE(), INTERVAL -31 DAY) AND DATE_ADD(CURRENT_DATE(), INTERVAL -1 DAY))
WHERE
  c._DATA_DATE = c._LATEST_DATE
GROUP BY
  1, 2, 3
ORDER BY
  Impressions DESC
다음을 바꿉니다.
DATASET: 데이터 세트의 이름
CUSTOMER_ID: Search Ads 360 고객 ID
키워드 수
다음 샘플 쿼리는 캠페인, 광고그룹, 키워드 상태별로 키워드를 분석합니다.
  SELECT
    c.campaign_status AS CampaignStatus,
    a.ad_group_status AS AdGroupStatus,
    k.ad_group_criterion_status AS KeywordStatus,
    k.ad_group_criterion_keyword_match_type AS KeywordMatchType,
    COUNT(*) AS count
  FROM
    `
DATASET.sa_Keyword_
CUSTOMER_ID` k
    JOIN
    `
DATASET.sa_Campaign_
CUSTOMER_ID` c
  ON
    (k.campaign_id = c.campaign_id AND k._DATA_DATE = c._DATA_DATE)
  JOIN
    `
DATASET.sa_AdGroup_
CUSTOMER_ID` a
  ON
    (k.ad_group_id = a.ad_group_id AND k._DATA_DATE = a._DATA_DATE)
  WHERE
    k._DATA_DATE = k._LATEST_DATE
  GROUP BY
    1, 2, 3, 4
다음을 바꿉니다.
DATASET: 데이터 세트의 이름
CUSTOMER_ID: Search Ads 360 고객 ID
ID 매핑 테이블
고객, 캠페인, 광고 그룹 등 새 Search Ads 360의 항목은 이전 Search Ads 360과 ID 공간 [https://developers.google.com/search-ads/v2/how-tos/reporting/id-mapping?hl=ko]이 다릅니다. 기존 Search Ads 360의 데이터를 새 Search Ads 360 API와 결합하려는 기존 Search Ads 360 전송 사용자의 경우 전송 구성에 유효한 대행사 ID와 광고주 ID를 입력하면 BigQuery Data Transfer Service를 사용하여 ID 매핑 테이블을 전송할 수 있습니다.
지원되는 항목 [https://developers.google.com/search-ads/v2/how-tos/reporting/id-mapping?hl=ko]에는 Search Ads 360의 이전 버전과 새 버전에 있는 항목의 ID 매핑을 각각 지정하는 legacy_id 및 new_id 열 두 개가 포함됩니다. AD, CAMPAIGN_CRITERION, CRITERION 항목의 경우 이러한 항목에는 새 Search Ads 360에서 전역적으로 고유한 ID가 없으므로 [https://developers.google.com/search-ads/v2/how-tos/reporting/id-mapping?hl=ko#object-id-uniqueness] new_secondary_id도 제공됩니다. 다음은 ID 매핑 테이블 목록입니다.
IdMapping_AD
IdMapping_AD_GROUP
IdMapping_CAMPAIGN
IdMapping_CAMPAIGN_CRITERION
IdMapping_CAMPAIGN_GROUP
IdMapping_CAMPAIGN_GROUP_PERFORMANCE_TARGET
IdMapping_CRITERION
IdMapping_CUSTOMER
IdMapping_FEED_ITEM
IdMapping_FEED_TABLE
참고: 데이터 이동 색인과 마찬가지로 ID 매핑 테이블의 스냅샷은 하루에 한 번 생성되며 최근 실행 날짜의 파티션에 저장됩니다. ID 매핑 테이블 스냅샷은 백필 또는 새로고침 창을 사용하여 로드된 날짜에 대하여 업데이트되지 않습니다.
쿼리 예
다음 쿼리는 ID 매핑 테이블을 사용하여 새 ID 공간에서 이전 Search Ads 360 전송과 새 Search Ads 360 데이터 전송의 테이블 간에 캠페인별 측정항목을 집계합니다.
SELECT CustomerID, CampaignID, Sum(Clicks), Sum(Cost) FROM
(SELECT
  cs.customer_id AS CustomerID,
  cs.campaign_id AS CampaignID,
  cs.metrics_clicks AS Clicks,
  cs.metrics_cost_micros / 1000000 AS Cost
FROM
  `
DATASET.sa_CampaignStats_
CUSTOMER_ID` cs
WHERE cs._DATA_DATE = '
NEW_DATA_DATE'
UNION ALL
SELECT
  customer_id_mapping.new_id AS CustomerID,
  campaign_id_mapping.new_id AS CampaignID,
  cs.clicks AS Clicks,
  cs.cost AS Cost
FROM
  `
DATASET.CampaignStats_
ADVERTISER_ID` cs
LEFT JOIN
  `
DATASET.IdMapping_CUSTOMER_
ADVERTISER_ID` customer_id_mapping
ON cs.accountId = customer_id_mapping.legacy_id
LEFT JOIN
  `
DATASET.IdMapping_CAMPAIGN_
ADVERTISER_ID` campaign_id_mapping
ON cs.campaignId = campaign_id_mapping.legacy_id
WHERE cs._DATA_DATE = '
OLD_DATA_DATE')
GROUP BY
1, 2
ORDER BY
1, 2
다음을 바꿉니다.
DATASET: 데이터 세트의 이름
CUSTOMER_ID: Search Ads 360 고객 ID
ADVERTISER_ID: Search Ads 360 광고주 ID
NEW_DATA_DATE: 새 Search Ads 360 테이블의 데이터 날짜
OLD_DATA_DATE: 이전 Search Ads 360 테이블의 데이터 날짜
다음 쿼리는 ID 매핑 테이블을 사용하여 이전 ID 공간에서 이전 Search Ads 360 전송과 새 Search Ads 360 데이터 전송의 테이블 간에 캠페인별 측정항목을 집계합니다.
SELECT CustomerID, CampaignID, Sum(Clicks), Sum(Cost) FROM
(SELECT
  customer_id_mapping.legacy_id AS CustomerID,
  campaign_id_mapping.legacy_id AS CampaignID,
  cs.metrics_clicks AS Clicks,
  cs.metrics_cost_micros / 1000000 AS Cost
FROM
  `
DATASET.sa_CampaignStats_
CUSTOMER_ID` cs
LEFT JOIN
  `
DATASET.IdMapping_CUSTOMER_
ADVERTISER_ID` customer_id_mapping
ON cs.customer_id = customer_id_mapping.new_id
LEFT JOIN
  `
DATASET.IdMapping_CAMPAIGN_
ADVERTISER_ID` campaign_id_mapping
ON cs.campaign_id = campaign_id_mapping.new_id
WHERE cs._DATA_DATE = '
NEW_DATA_DATE'
UNION ALL
SELECT
  CAST(accountId AS INT) AS CustomerID,
  CAST(campaignId AS INT) AS CampaignID,
  cs.clicks AS Clicks,
  cs.cost AS Cost
FROM
  `
DATASET.CampaignStats_
ADVERTISER_ID` cs
WHERE cs._DATA_DATE = '
OLD_DATA_DATE')
GROUP BY
1, 2
ORDER BY
1, 2
다음을 바꿉니다.
DATASET: 데이터 세트의 이름
CUSTOMER_ID: Search Ads 360 고객 ID
ADVERTISER_ID: Search Ads 360 광고주 ID
NEW_DATA_DATE: 새 Search Ads 360 테이블의 데이터 날짜
OLD_DATA_DATE: 이전 Search Ads 360 테이블의 데이터 날짜
잠재적 할당량 문제
Search Ads 360 Reporting API는 Google 프로젝트가 전송할 수 있는 요청 수에 대해 할당량 [https://developers.google.com/search-ads/reporting/concepts/quotas?hl=ko#query_limits]을 지정합니다. BigQuery Data Transfer Service 및 기타 서비스에 대해 하나의 프로젝트를 사용하면, 모든 서비스가 동일한 할당량을 공유하며, 모든 서비스에서 할당량 한도에 도달할 가능성이 있습니다.
기존 워크플로에 영향을 주지 않고 이러한 잠재적인 문제를 방지하려면 다음 옵션을 고려하세요.
table_filter 파라미터를 사용하여 필요한 테이블만 로드합니다.
BigQuery Data Transfer Service에 프로젝트를 별도로 설정합니다. 교차 프로젝트 테이블 조인은 다음과 같을 수 있습니다.
  #standardSQL
  select count(a.item1)
  from (select item1, item2 from project-A.data_set_a.table_name_a) a
  inner join
  (select item3, item4 from project-B.data_set_b.table_name_b) b
  on a.item1 = b.item3
Search Ads 360 지원 [https://support.google.com/searchads/answer/9026876?hl=ko]에 연락하여 추가 할당량을 요청합니다.
도움이 되었나요?
의견 보내기