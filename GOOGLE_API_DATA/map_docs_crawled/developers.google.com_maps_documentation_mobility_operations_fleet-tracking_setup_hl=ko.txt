Source URL: https://developers.google.com/maps/documentation/mobility/operations/fleet-tracking/setup?hl=ko
Title: JavaScript Fleet 추적 라이브러리 설정

JavaScript Fleet 추적 라이브러리 설정

컬렉션을 사용해 정리하기

내 환경설정을 기준으로 콘텐츠를 저장하고 분류하세요.

JavaScript Fleet Tracking Library를 사용하기 전에 Fleet Engine을 숙지하고 설정했는지 확인하세요. 자세한 내용은 Fleet Engine [https://developers.google.com/maps/documentation/mobility/fleet-engine?hl=ko]을 참고하세요.

이 문서에서는 웹페이지 앱과 Fleet Engine 간의 승인을 사용 설정하는 방법을 보여줍니다. Fleet Engine에 대한 요청이 올바른 승인 토큰으로 설정되면 지도에서 차량을 추적할 수 있습니다.

승인 설정하기

Fleet Engine에서는 신뢰도가 낮은 환경(스마트폰 및 브라우저)에서 API 메서드를 호출할 때 JSON 웹 토큰(JWT)을 사용해야 합니다.

JWT는 서버에서 생성되고 서명, 암호화되어 만료되거나 더 이상 유효하지 않을 때까지 후속 서버 상호작용을 위해 클라이언트에 전달됩니다.

주요 세부정보

애플리케이션 기본 사용자 인증 정보 [https://google.aip.dev/auth/4110]를 사용하여 Fleet Engine에 대해 인증하고 승인합니다.
적절한 서비스 계정을 사용하여 JWT에 서명합니다. Fleet Engine 기본사항의 Fleet Engine 서비스 계정 [https://developers.google.com/maps/documentation/mobility/fleet-engine/essentials/set-up-fleet/service-accounts?hl=ko#fleet_engine_service_account_roles] 역할을 참고하세요.

승인은 어떻게 작동하나요?

Fleet Engine 데이터를 사용한 승인에는 서버 측 및 클라이언트 측 구현이 모두 포함됩니다.

서버 측 승인

차량 추적 애플리케이션에서 인증 및 승인을 설정하기 전에 백엔드 서버가 Fleet Engine에 액세스할 수 있도록 차량 추적 애플리케이션에 JSON 웹 토큰을 발급할 수 있어야 합니다. 차량 추적 애플리케이션은 요청과 함께 이러한 JWT를 전송하므로 Fleet Engine은 요청을 인증되고 요청의 데이터에 액세스할 권한이 있는 것으로 인식합니다. 서버 측 JWT 구현에 관한 안내는 Fleet Engine 기본사항의 JSON 웹 토큰 발급 [https://developers.google.com/maps/documentation/mobility/fleet-engine/essentials/set-up-fleet/issue-jwt?hl=ko]을 참고하세요.

Fleet 추적을 구현할 때 서버에서 토큰을 생성하려면 다음을 참고하세요.

온디맨드 이동과 예약된 작업 모두에 관한 섹션을 포함하여 JSON 웹 토큰 발급에 관한 일반 가이드라인 [https://developers.google.com/maps/documentation/mobility/fleet-engine/essentials/set-up-fleet/issue-jwt?hl=ko#general_guidelines]
주문형 이동: 백엔드 서버 작업의 토큰 예시 [https://developers.google.com/maps/documentation/mobility/fleet-engine/essentials/set-up-fleet/issue-jwt?hl=ko#example_token_for_a_backend_server_operation]
예약된 작업: 전체 차량의 모든 작업과 차량을 추적하는 예시 토큰 [https://developers.google.com/maps/documentation/mobility/fleet-engine/essentials/set-up-fleet/issue-jwt?hl=ko#example_token_to_track_all_tasks_and_vehicles]

클라이언트 측 승인

JavaScript Fleet tracking library를 사용하면 승인 토큰 가져오기를 사용하여 서버에서 토큰을 요청합니다. 다음 중 하나가 참인 경우 이 작업을 실행합니다.

SDK가 새로고침된 페이지에서 가져오기를 호출하지 않았거나 가져오기가 토큰을 반환하지 않은 경우와 같이 유효한 토큰이 없습니다.
토큰이 만료되었습니다.
토큰이 만료되기 1분 전입니다.

그렇지 않으면 JavaScript 차량 추적 라이브러리가 이전에 발급된 유효한 토큰을 사용하고 패처를 호출하지 않습니다.

승인 토큰 가져오기 도구 만들기

다음 가이드라인에 따라 승인 토큰 가져오기를 만듭니다.

데이터 가져오기는 다음과 같이 Promise로 래핑된 두 필드가 있는 데이터 구조를 반환해야 합니다.

문자열 token입니다.
expiresInSeconds 숫자입니다. 토큰은 가져온 후 이 시간 후에 만료됩니다. 인증 토큰 가져오기는 가져온 시간부터 라이브러리까지의 만료 시간을 초 단위로 전달해야 합니다(예 참고).

Fetcher는 서버의 URL을 호출하여 토큰을 가져와야 합니다. 이 URL(SERVER_TOKEN_URL)은 백엔드 구현에 따라 다릅니다. 다음 예시 URL은 GitHub의 샘플 앱 백엔드 [https://github.com/googlemaps/last-mile-fleet-solution-samples/tree/main/backend]용입니다.

https://SERVER_URL/token/fleet_reader

예시 - 승인 토큰 가져오기 프로그램 만들기

다음 예에서는 승인 토큰 가져오기를 만드는 방법을 보여줍니다.

자바스크립트async function authTokenFetcher(options) {