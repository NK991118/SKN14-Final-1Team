Source URL: https://cloud.google.com/firestore/docs/regional-endpoints?hl=ko
Title: 위치 엔드포인트로 데이터 지역 구성

의견 보내기

컬렉션을 사용해 정리하기

내 환경설정을 기준으로 콘텐츠를 저장하고 분류하세요.

위치 엔드포인트로 데이터 지역 구성

이 페이지에서는 위치 엔드포인트를 사용하도록 Firestore 클라이언트 라이브러리를 구성하는 방법을 설명합니다.

Firestore 클라이언트 라이브러리를 사용할 때는 다음 엔드포인트 중 하나를 사용할 수 있습니다.

전역 엔드포인트: 기본적으로 Firestore 클라이언트 라이브러리는 firestore.googleapis.com이라는 전역 서비스 엔드포인트에 API 요청을 전송합니다. 전역 서비스 엔드포인트는 요청을 데이터베이스로 라우팅합니다. 라우팅 중에는 요청이 데이터베이스 위치와 다른 위치의 위치별 서비스 엔드포인트를 통과할 수 있습니다.
위치 엔드포인트: 위치 엔드포인트는 데이터가 특정 리전에 저장 및 처리되도록 리전 제한을 적용합니다.
서비스 엔드포인트가 데이터베이스와 동일한 리전에서 앱의 Firestore 요청을 처리하도록 보장하려면 클라이언트 라이브러리에서 위치 엔드포인트를 지정합니다.

위치 엔드포인트 설정

다음 예시에서는 Firestore 클라이언트를 초기화할 때 위치 엔드포인트를 설정하는 방법을 보여줍니다. 데이터가 있는 위치가 아닌 다른 위치 엔드포인트를 설정하면 PermissionDeniedError 오류가 발생할 수 있습니다.
참고: 서버 클라이언트 라이브러리, 즉 C#, Go, Java, Node.js, PHP, Python, Ruby에서 위치 엔드포인트를 설정할 수 있습니다.
모바일 및 웹 SDK, 즉 Android, iOS, 웹은 지원되지 않습니다.

Java

Firestore에 인증하려면 애플리케이션 기본 사용자 인증 정보를 설정합니다.
자세한 내용은 로컬 개발 환경의 인증 설정 [https://cloud.google.com/docs/authentication/set-up-adc-local-dev-environment?hl=ko]을 참조하세요.

import com.google.auth.oauth2.GoogleCredentials [https://cloud.google.com/java/docs/reference/google-auth-library/latest/com.google.auth.oauth2.GoogleCredentials.html?hl=ko];
import com.google.cloud.firestore.Firestore [https://cloud.google.com/java/docs/reference/google-cloud-firestore/latest/com.google.cloud.firestore.Firestore.html?hl=ko];
import com.google.cloud.firestore.FirestoreOptions [https://cloud.google.com/java/docs/reference/google-cloud-firestore/latest/com.google.cloud.firestore.FirestoreOptions.html?hl=ko];

/**
* Demonstrate how to set a regional endpoint.
*/
public class RegionalEndpointSnippets {

/**
* Create a client with a regional endpoint.
**/
public Firestore [https://cloud.google.com/java/docs/reference/google-cloud-firestore/latest/com.google.cloud.firestore.Firestore.html?hl=ko] regionalEndpoint(String projectId, String endpoint) throws Exception {
FirestoreOptions [https://cloud.google.com/java/docs/reference/google-cloud-firestore/latest/com.google.cloud.firestore.FirestoreOptions.html?hl=ko] firestoreOptions =
FirestoreOptions [https://cloud.google.com/java/docs/reference/google-cloud-firestore/latest/com.google.cloud.firestore.FirestoreOptions.html?hl=ko].newBuilder()
.setProjectId(projectId)
.setCredentials(GoogleCredentials [https://cloud.google.com/java/docs/reference/google-auth-library/latest/com.google.auth.oauth2.GoogleCredentials.html?hl=ko].getApplicationDefault [https://cloud.google.com/java/docs/reference/google-auth-library/latest/com.google.auth.oauth2.GoogleCredentials.html?hl=ko#com_google_auth_oauth2_GoogleCredentials_getApplicationDefault__]())
Firestore [https://cloud.google.com/java/docs/reference/google-cloud-firestore/latest/com.google.cloud.firestore.Firestore.html?hl=ko] dbWithEndpoint = firestoreOptions.getService();

return dbWithEndpoint;

Firestore에 인증하려면 애플리케이션 기본 사용자 인증 정보를 설정합니다.
자세한 내용은 로컬 개발 환경의 인증 설정 [https://cloud.google.com/docs/authentication/set-up-adc-local-dev-environment?hl=ko]을 참조하세요.

ENDPOINT = "nam5-firestore.googleapis.com"
client_options = ClientOptions(api_endpoint=ENDPOINT)
db = firestore.Client(client_options=client_options)

cities_query = db.collection("cities").limit(2).get()
for r in cities_query:
print(r)

위치 엔드포인트의 시맨틱스

Firestore는 리전 및 멀티 리전 위치 모두에 대한 위치 엔드포인트를 지원합니다.

위치 엔드포인트를 정의하려면 다음 형식을 사용합니다.

자바  REGION_NAME-firestore.googleapis.com:443

포트 번호가 엔드포인트와 함께 정의되었는지 확인합니다.
Python  REGION_NAME-firestore.googleapis.com

Go  REGION_NAME-firestore.googleapis.com:443

포트 번호가 엔드포인트와 함께 정의되었는지 확인합니다.

REGION_NAME을 리전 이름 또는 멀티 리전 호스트 이름으로 바꿉니다.

일부 호스트 이름 예시는 다음과 같습니다.

eur3-firestore.googleapis.com
nam5-firestore.googleapis.com
europe-west6-firestore.googleapis.com
asia-northeast2-firestore.googleapis.com

멀티 리전 및 리전 호스트 이름의 전체 목록은 Firestore 위치 [https://cloud.google.com/firestore/docs/locations?hl=ko]를 참조하세요.

전역 API 엔드포인트 사용 제한

리전 엔드포인트 사용을 강제하려면 constraints/gcp.restrictEndpointUsage 조직 정책 제약조건을 사용하여 전역 API 엔드포인트에 대한 요청을 차단하세요. 자세한 내용은 엔드포인트 사용 제한 [https://cloud.google.com/assured-workloads/docs/restrict-endpoint-usage?hl=ko]을 참고하세요.

다음 단계

Firestore 데이터 모델 [https://cloud.google.com/firestore/docs/data-model?hl=ko] 알아보기
Firestore 사용에 대한 권장사항 [https://cloud.google.com/firestore/docs/best-practices?hl=ko]

의견 보내기